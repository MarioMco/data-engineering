[0m20:59:19.419972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da5840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733ecb0>]}


============================== 20:59:19.424940 | 9c4faa31-88b8-47cb-8a6f-7f9308fb2789 ==============================
[0m20:59:19.424940 [info ] [MainThread]: Running with dbt=1.7.6
[0m20:59:19.426151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:59:19.427331 [info ] [MainThread]: dbt version: 1.7.6
[0m20:59:19.428168 [info ] [MainThread]: python version: 3.10.0
[0m20:59:19.428995 [info ] [MainThread]: python path: /Users/mariocukovic/.pyenv/versions/3.10.0/bin/python
[0m20:59:19.429809 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m20:59:19.551487 [info ] [MainThread]: Using profiles dir at /Users/mariocukovic/.dbt
[0m20:59:19.552463 [info ] [MainThread]: Using profiles.yml file at /Users/mariocukovic/.dbt/profiles.yml
[0m20:59:19.553310 [info ] [MainThread]: Using dbt_project.yml file at /Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/dbt_project.yml
[0m20:59:19.554418 [info ] [MainThread]: adapter type: postgres
[0m20:59:19.555260 [info ] [MainThread]: adapter version: 1.7.6
[0m20:59:19.662447 [info ] [MainThread]: Configuration:
[0m20:59:19.663465 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:59:19.664387 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:59:19.665298 [info ] [MainThread]: Required dependencies:
[0m20:59:19.666341 [debug] [MainThread]: Executing "git --help"
[0m20:59:19.673987 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:59:19.675369 [debug] [MainThread]: STDERR: "b''"
[0m20:59:19.676245 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:59:19.677195 [info ] [MainThread]: Connection:
[0m20:59:19.678145 [info ] [MainThread]:   host: localhost
[0m20:59:19.678983 [info ] [MainThread]:   port: 5432
[0m20:59:19.679806 [info ] [MainThread]:   user: postgres
[0m20:59:19.680637 [info ] [MainThread]:   database: psql_contosodb
[0m20:59:19.681463 [info ] [MainThread]:   schema: dbt_schema
[0m20:59:19.682280 [info ] [MainThread]:   connect_timeout: 10
[0m20:59:19.683106 [info ] [MainThread]:   role: None
[0m20:59:19.683957 [info ] [MainThread]:   search_path: None
[0m20:59:19.684778 [info ] [MainThread]:   keepalives_idle: 0
[0m20:59:19.685604 [info ] [MainThread]:   sslmode: None
[0m20:59:19.686430 [info ] [MainThread]:   sslcert: None
[0m20:59:19.687264 [info ] [MainThread]:   sslkey: None
[0m20:59:19.688091 [info ] [MainThread]:   sslrootcert: None
[0m20:59:19.688921 [info ] [MainThread]:   application_name: dbt
[0m20:59:19.689785 [info ] [MainThread]:   retries: 1
[0m20:59:19.691591 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m20:59:19.701929 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:59:19.704036 [debug] [MainThread]: Using postgres connection "debug"
[0m20:59:19.704966 [debug] [MainThread]: On debug: select 1 as id
[0m20:59:19.705822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:19.746284 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:59:19.749672 [debug] [MainThread]: On debug: Close
[0m20:59:19.751288 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:59:19.752851 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:59:19.756619 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4107358, "process_user_time": 2.959659, "process_kernel_time": 0.220442, "process_mem_max_rss": "100364288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:59:19.758548 [debug] [MainThread]: Command `dbt debug` succeeded at 20:59:19.758058 after 0.41 seconds
[0m20:59:19.759981 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:59:19.761473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da5840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776a9e0>]}
[0m20:59:19.762990 [debug] [MainThread]: Flushing usage events
[0m21:00:45.218949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054428f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105442590>]}


============================== 21:00:45.224239 | ff0551a9-d326-45cd-896a-200dee9f269c ==============================
[0m21:00:45.224239 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:00:45.225460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:45.486894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105442800>]}
[0m21:00:45.609364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592ccd0>]}
[0m21:00:45.610866 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:00:45.630967 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:00:45.632463 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:00:45.633447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058aace0>]}
[0m21:00:46.930755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:00:46.938000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a40d0>]}
[0m21:00:46.952806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a4250>]}
[0m21:00:46.954043 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:00:46.955264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a40d0>]}
[0m21:00:46.958341 [info ] [MainThread]: 
[0m21:00:46.960766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:46.962874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:00:46.980507 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:00:46.982887 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:00:46.984293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:47.017325 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:00:47.019543 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:00:47.023921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:00:47.032645 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:00:47.033607 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:00:47.034477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:47.040952 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:00:47.041928 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:00:47.042818 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:00:47.049088 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:00:47.051639 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:00:47.052673 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:00:47.058620 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:47.059531 [debug] [MainThread]: On master: BEGIN
[0m21:00:47.060351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:47.066657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:47.067559 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:47.068478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:47.108229 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:00:47.110080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0a0b0>]}
[0m21:00:47.111084 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:47.112140 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:47.112993 [debug] [MainThread]: On master: BEGIN
[0m21:00:47.114075 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:47.114927 [debug] [MainThread]: On master: COMMIT
[0m21:00:47.115995 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:47.117241 [debug] [MainThread]: On master: COMMIT
[0m21:00:47.118247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:00:47.119096 [debug] [MainThread]: On master: Close
[0m21:00:47.120471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:47.121532 [info ] [MainThread]: 
[0m21:00:47.124294 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:00:47.125387 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:00:47.127038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_factsales)
[0m21:00:47.128391 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:00:47.138803 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:00:47.140523 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:00:47.129073 => 21:00:47.140047
[0m21:00:47.141462 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:00:47.202824 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:00:47.204605 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:00:47.205858 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:00:47.207146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:47.214705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:00:47.215776 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:00:47.216747 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:00:47.227736 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:00:47.237992 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:00:47.238975 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:00:47.240440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:00:47.265824 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:00:47.267095 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:00:47.268013 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:00:47.270269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:00:47.284048 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:00:47.291192 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:00:47.292377 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:00:47.293625 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:00:47.296063 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:00:47.142215 => 21:00:47.295614
[0m21:00:47.296980 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:00:47.298594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0551a9-d326-45cd-896a-200dee9f269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f7fd0>]}
[0m21:00:47.299931 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.17s]
[0m21:00:47.301333 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:00:47.303345 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:47.304217 [debug] [MainThread]: On master: BEGIN
[0m21:00:47.305039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:47.315398 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:47.317140 [debug] [MainThread]: On master: COMMIT
[0m21:00:47.318601 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:47.324990 [debug] [MainThread]: On master: COMMIT
[0m21:00:47.330410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:00:47.332291 [debug] [MainThread]: On master: Close
[0m21:00:47.334016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:47.335148 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_factsales' was properly closed.
[0m21:00:47.336043 [info ] [MainThread]: 
[0m21:00:47.337300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:00:47.338833 [debug] [MainThread]: Command end result
[0m21:00:47.352018 [info ] [MainThread]: 
[0m21:00:47.353029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:47.353921 [info ] [MainThread]: 
[0m21:00:47.354865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:00:47.358567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.21395, "process_user_time": 4.645122, "process_kernel_time": 0.314762, "process_mem_max_rss": "110419968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:00:47.361143 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:47.360023 after 2.22 seconds
[0m21:00:47.362426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fefb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106199d50>]}
[0m21:00:47.364115 [debug] [MainThread]: Flushing usage events
[0m21:19:25.500650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140667d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114066470>]}


============================== 21:19:25.506269 | c5d75029-daad-435d-94d2-31cf03a7c556 ==============================
[0m21:19:25.506269 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:19:25.507562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:19:25.774472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140666e0>]}
[0m21:19:25.898251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143bf4c0>]}
[0m21:19:25.899744 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:19:25.920079 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:19:25.981901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:19:25.983066 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/dbt_product_stg.sql
[0m21:19:26.170703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:19:26.179166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d6ded0>]}
[0m21:19:26.192504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bc3e80>]}
[0m21:19:26.194733 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:19:26.195753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144c8d00>]}
[0m21:19:26.198092 [info ] [MainThread]: 
[0m21:19:26.199656 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:26.201497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:19:26.219658 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:19:26.220634 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:19:26.221531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:26.258474 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:19:26.260881 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:19:26.265566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:19:26.274588 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:19:26.275541 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:19:26.276428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:26.282921 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:19:26.283879 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:19:26.284743 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:19:26.290977 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:19:26.293110 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:19:26.294098 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:19:26.301395 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:26.302328 [debug] [MainThread]: On master: BEGIN
[0m21:19:26.303132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:26.309498 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:26.310413 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:26.311323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:26.352688 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:19:26.354732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d8d600>]}
[0m21:19:26.355784 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:26.356796 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:26.357638 [debug] [MainThread]: On master: BEGIN
[0m21:19:26.358734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:26.359594 [debug] [MainThread]: On master: COMMIT
[0m21:19:26.360435 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:26.361268 [debug] [MainThread]: On master: COMMIT
[0m21:19:26.362203 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:19:26.363036 [debug] [MainThread]: On master: Close
[0m21:19:26.364385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:26.365522 [info ] [MainThread]: 
[0m21:19:26.424859 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:19:26.426090 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:19:26.427546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_factsales)
[0m21:19:26.428590 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:19:26.440697 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:19:26.442936 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:19:26.429241 => 21:19:26.442420
[0m21:19:26.443940 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:19:26.498396 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:19:26.499826 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:19:26.500856 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:19:26.501746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:26.508470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:26.509433 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:19:26.510915 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:19:26.523864 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:19:26.533666 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:19:26.534633 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:19:26.535975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:26.541331 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:19:26.542309 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:19:26.543846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:26.570694 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:19:26.571684 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:19:26.572627 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:19:26.574871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:26.585826 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:19:26.592892 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:19:26.593876 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:19:26.598223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:19:26.601074 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:19:26.444531 => 21:19:26.600562
[0m21:19:26.602139 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:19:26.603888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a2f310>]}
[0m21:19:26.605316 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.18s]
[0m21:19:26.606611 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:19:26.607610 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:19:26.608751 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:19:26.610452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:19:26.611601 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:19:26.614753 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.616204 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:19:26.612377 => 21:19:26.615742
[0m21:19:26.617103 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:19:26.645867 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.647318 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.648238 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:19:26.649119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:26.656646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:26.657664 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.658715 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:19:26.666798 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:19:26.673188 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.674219 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:19:26.675869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:26.679132 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:19:26.680076 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.680946 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:19:26.682544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:26.687196 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:19:26.691949 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:19:26.692924 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:19:26.694082 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:19:26.696467 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:19:26.617723 => 21:19:26.696029
[0m21:19:26.697679 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:19:26.699097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d75029-daad-435d-94d2-31cf03a7c556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dc3ca0>]}
[0m21:19:26.700339 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:19:26.701610 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:19:26.703570 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:26.704465 [debug] [MainThread]: On master: BEGIN
[0m21:19:26.705296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:26.711702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:26.712624 [debug] [MainThread]: On master: COMMIT
[0m21:19:26.713542 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:26.714434 [debug] [MainThread]: On master: COMMIT
[0m21:19:26.715435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:19:26.716295 [debug] [MainThread]: On master: Close
[0m21:19:26.717576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:26.718512 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_product_stg' was properly closed.
[0m21:19:26.719377 [info ] [MainThread]: 
[0m21:19:26.720430 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m21:19:26.722167 [debug] [MainThread]: Command end result
[0m21:19:26.734763 [info ] [MainThread]: 
[0m21:19:26.735802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:26.736733 [info ] [MainThread]: 
[0m21:19:26.737711 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:19:26.740899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.315759, "process_user_time": 3.744807, "process_kernel_time": 0.2971, "process_mem_max_rss": "110596096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:19:26.743075 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:26.742300 after 1.32 seconds
[0m21:19:26.744551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114423970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d1f880>]}
[0m21:19:26.746250 [debug] [MainThread]: Flushing usage events
[0m21:22:30.342658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d19660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b2530>]}


============================== 21:22:30.348195 | e722cd89-432d-4f79-8710-a58215c3914d ==============================
[0m21:22:30.348195 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:22:30.349515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:22:30.621771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b27a0>]}
[0m21:22:30.747905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2273d0>]}
[0m21:22:30.749380 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:22:30.770600 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:22:30.828875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:22:30.830005 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/dbt_channel_stg.sql
[0m21:22:31.020588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:22:31.028284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfba410>]}
[0m21:22:31.040422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce16f20>]}
[0m21:22:31.041462 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:22:31.042422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce170a0>]}
[0m21:22:31.044775 [info ] [MainThread]: 
[0m21:22:31.046211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:22:31.049004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:22:31.065998 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:22:31.067291 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:22:31.068625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:31.109142 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:22:31.113529 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:22:31.117011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:22:31.125790 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:22:31.126690 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:22:31.127492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:31.134448 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.135342 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:22:31.136345 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:22:31.142398 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:22:31.145045 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:22:31.146053 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:22:31.202031 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:31.203034 [debug] [MainThread]: On master: BEGIN
[0m21:22:31.203915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:31.210678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.211580 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:31.212477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:22:31.255763 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:22:31.257706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfc1db0>]}
[0m21:22:31.258730 [debug] [MainThread]: On master: ROLLBACK
[0m21:22:31.259732 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:31.260557 [debug] [MainThread]: On master: BEGIN
[0m21:22:31.261624 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.262474 [debug] [MainThread]: On master: COMMIT
[0m21:22:31.263352 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:31.264186 [debug] [MainThread]: On master: COMMIT
[0m21:22:31.265130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:22:31.265980 [debug] [MainThread]: On master: Close
[0m21:22:31.267408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:31.268463 [info ] [MainThread]: 
[0m21:22:31.271155 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:22:31.272222 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:22:31.273517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:22:31.274706 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:22:31.284427 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:22:31.286512 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:22:31.275459 => 21:22:31.285649
[0m21:22:31.287860 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:22:31.338790 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:22:31.340419 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:31.341359 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:22:31.342257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:31.348960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.349917 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:31.350828 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel;
  );
[0m21:22:31.352529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 7:     select * from public.dim_channel;
                                            ^

[0m21:22:31.353561 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m21:22:31.354986 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:22:31.288466 => 21:22:31.354522
[0m21:22:31.355949 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:22:31.359432 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  syntax error at or near ";"
  LINE 7:     select * from public.dim_channel;
                                              ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m21:22:31.360480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfc8a30>]}
[0m21:22:31.361648 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m21:22:31.362951 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:22:31.364112 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:22:31.365496 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:22:31.366822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factsales)
[0m21:22:31.367864 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:22:31.372418 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:22:31.374006 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:22:31.368556 => 21:22:31.373500
[0m21:22:31.375350 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:22:31.410938 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:22:31.412355 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:31.413595 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:22:31.415146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:31.422555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.423568 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:31.424510 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:22:31.436013 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:22:31.446418 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:31.447414 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:22:31.448915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:31.454256 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:31.455217 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:22:31.456704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:31.484410 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:22:31.485399 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:31.486348 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:22:31.488566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:22:31.498945 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:22:31.506118 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:31.507097 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:22:31.511653 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:22:31.514398 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:22:31.375979 => 21:22:31.513954
[0m21:22:31.515337 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:22:31.516761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d087be0>]}
[0m21:22:31.518014 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.15s]
[0m21:22:31.519499 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:22:31.520506 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:22:31.521617 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:22:31.522950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:22:31.523998 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:22:31.527114 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.528551 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:22:31.524747 => 21:22:31.528082
[0m21:22:31.529470 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:22:31.538539 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.540030 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.540970 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:22:31.541846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:31.548546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.549622 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.551404 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:22:31.558406 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:22:31.563775 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.565143 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:22:31.567493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:31.573713 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.574740 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:22:31.576463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:31.580094 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:22:31.581014 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.581964 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:22:31.584373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:22:31.591096 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:22:31.595696 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:31.596673 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:22:31.599415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:22:31.601879 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:22:31.530095 => 21:22:31.601441
[0m21:22:31.602795 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:22:31.604212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e722cd89-432d-4f79-8710-a58215c3914d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d117b50>]}
[0m21:22:31.605537 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:22:31.606825 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:22:31.608950 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:31.609821 [debug] [MainThread]: On master: BEGIN
[0m21:22:31.610650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:31.617635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:22:31.618834 [debug] [MainThread]: On master: COMMIT
[0m21:22:31.620261 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:31.621317 [debug] [MainThread]: On master: COMMIT
[0m21:22:31.622350 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:22:31.623250 [debug] [MainThread]: On master: Close
[0m21:22:31.624688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:31.625661 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_product_stg' was properly closed.
[0m21:22:31.626580 [info ] [MainThread]: 
[0m21:22:31.627676 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m21:22:31.629488 [debug] [MainThread]: Command end result
[0m21:22:31.642475 [info ] [MainThread]: 
[0m21:22:31.643515 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:22:31.644514 [info ] [MainThread]: 
[0m21:22:31.645438 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  syntax error at or near ";"
  LINE 7:     select * from public.dim_channel;
                                              ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m21:22:31.646410 [info ] [MainThread]: 
[0m21:22:31.647396 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:22:31.650529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3839757, "process_user_time": 3.796499, "process_kernel_time": 0.306508, "process_mem_max_rss": "111476736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:22:31.652887 [debug] [MainThread]: Command `dbt run` failed at 21:22:31.652118 after 1.39 seconds
[0m21:22:31.655108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d19660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d117760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0c6a70>]}
[0m21:22:31.656757 [debug] [MainThread]: Flushing usage events
[0m21:22:55.406417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108429660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c6530>]}


============================== 21:22:55.411781 | 4361a0fb-464f-4628-b9dd-474b4d3786db ==============================
[0m21:22:55.411781 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:22:55.412970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:22:55.682808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c67a0>]}
[0m21:22:55.804307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93b3d0>]}
[0m21:22:55.805825 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:22:55.826105 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:22:55.885032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:22:55.886259 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_channel_stg.sql
[0m21:22:56.074708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:22:56.082104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b2410>]}
[0m21:22:56.095392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b52b1f0>]}
[0m21:22:56.096692 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:22:56.099700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b52b430>]}
[0m21:22:56.103760 [info ] [MainThread]: 
[0m21:22:56.105478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:22:56.107806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:22:56.134494 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:22:56.135973 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:22:56.138364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:56.181877 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:22:56.184254 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:22:56.186951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:22:56.197949 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:22:56.198889 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:22:56.199732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:22:56.206620 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.207535 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:22:56.208548 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:22:56.215701 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m21:22:56.217837 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:22:56.218847 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:22:56.227069 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:56.228113 [debug] [MainThread]: On master: BEGIN
[0m21:22:56.229210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:56.235504 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.236441 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:56.237887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:22:56.285355 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m21:22:56.287765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d4d30>]}
[0m21:22:56.288790 [debug] [MainThread]: On master: ROLLBACK
[0m21:22:56.289799 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:56.290633 [debug] [MainThread]: On master: BEGIN
[0m21:22:56.291707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.292549 [debug] [MainThread]: On master: COMMIT
[0m21:22:56.293953 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:56.295333 [debug] [MainThread]: On master: COMMIT
[0m21:22:56.296363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:22:56.297227 [debug] [MainThread]: On master: Close
[0m21:22:56.298562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:56.299619 [info ] [MainThread]: 
[0m21:22:56.367646 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:22:56.369119 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:22:56.370589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:22:56.371624 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:22:56.385750 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.387269 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:22:56.372268 => 21:22:56.386800
[0m21:22:56.388186 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:22:56.448217 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.449676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.450607 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:22:56.451499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:56.458406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.459461 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.460693 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:22:56.466138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:22:56.475809 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.476808 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:22:56.478441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:56.499217 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:22:56.500279 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.501175 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:22:56.503477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:22:56.514504 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:22:56.521583 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:22:56.522849 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:22:56.524059 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:22:56.526723 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:22:56.388769 => 21:22:56.526163
[0m21:22:56.527761 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:22:56.529828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeaec50>]}
[0m21:22:56.531537 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:22:56.532901 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:22:56.533916 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:22:56.534951 [info ] [Thread-1 (]: 2 of 3 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:22:56.536264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factsales)
[0m21:22:56.537708 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:22:56.542267 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:22:56.543931 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:22:56.538825 => 21:22:56.543258
[0m21:22:56.545310 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:22:56.587986 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:22:56.589605 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:56.590673 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:22:56.591571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:56.599596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.600824 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:56.601908 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:22:56.623161 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:22:56.629411 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:56.630553 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:22:56.631914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:56.637555 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:56.638562 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:22:56.640014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:56.652757 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:22:56.653799 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:56.654706 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:22:56.656447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:22:56.662495 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:22:56.667222 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:22:56.668461 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:22:56.672301 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:22:56.674722 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:22:56.546715 => 21:22:56.674279
[0m21:22:56.677143 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:22:56.678781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b733ee0>]}
[0m21:22:56.680094 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.14s]
[0m21:22:56.681509 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:22:56.682614 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:22:56.684007 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:22:56.685601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:22:56.687080 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:22:56.689952 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.691514 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:22:56.687720 => 21:22:56.690880
[0m21:22:56.692797 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:22:56.703550 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.705394 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.706579 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:22:56.707868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:56.718801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.719959 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.720939 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:22:56.725951 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:22:56.734795 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.735985 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:22:56.737659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:56.742856 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.743877 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:22:56.745569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:22:56.750514 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:22:56.752280 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.753213 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:22:56.755208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:22:56.760705 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:22:56.762845 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:22:56.763763 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:22:56.767097 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:22:56.769764 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:22:56.693416 => 21:22:56.769330
[0m21:22:56.770678 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:22:56.772431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4361a0fb-464f-4628-b9dd-474b4d3786db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b777b20>]}
[0m21:22:56.774101 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:22:56.775495 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:22:56.777653 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:56.778553 [debug] [MainThread]: On master: BEGIN
[0m21:22:56.779385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:56.786805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:22:56.787763 [debug] [MainThread]: On master: COMMIT
[0m21:22:56.789190 [debug] [MainThread]: Using postgres connection "master"
[0m21:22:56.790721 [debug] [MainThread]: On master: COMMIT
[0m21:22:56.791914 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:22:56.792846 [debug] [MainThread]: On master: Close
[0m21:22:56.794629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:56.796360 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_product_stg' was properly closed.
[0m21:22:56.797659 [info ] [MainThread]: 
[0m21:22:56.798935 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m21:22:56.803571 [debug] [MainThread]: Command end result
[0m21:22:56.817949 [info ] [MainThread]: 
[0m21:22:56.819332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:22:56.820608 [info ] [MainThread]: 
[0m21:22:56.822016 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:22:56.825126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4927424, "process_user_time": 3.791725, "process_kernel_time": 0.295766, "process_mem_max_rss": "110964736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:22:56.826361 [debug] [MainThread]: Command `dbt run` succeeded at 21:22:56.826041 after 1.49 seconds
[0m21:22:56.827304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108429660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5653f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b77ce80>]}
[0m21:22:56.828475 [debug] [MainThread]: Flushing usage events
[0m21:27:41.372291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfa66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105428c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110542560>]}


============================== 21:27:41.377843 | 98a8b8d9-3627-4a14-a201-de3daddaa943 ==============================
[0m21:27:41.377843 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:27:41.379056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:41.645038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105427d0>]}
[0m21:27:41.766265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5eb60>]}
[0m21:27:41.767765 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:27:41.788936 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:27:41.843668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:27:41.845339 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/dbt_factonlinesales_stg.sql
[0m21:27:42.030863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:27:42.038188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112428c0>]}
[0m21:27:42.050468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a3dc0>]}
[0m21:27:42.051517 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:27:42.052466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a3df0>]}
[0m21:27:42.054872 [info ] [MainThread]: 
[0m21:27:42.056478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:42.059820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:27:42.080410 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:27:42.082261 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:27:42.083267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:42.121457 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:27:42.125003 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:27:42.127725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:27:42.136300 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:27:42.137216 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:27:42.138193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:42.144681 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.145688 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:27:42.146592 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:27:42.152632 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m21:27:42.155185 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:27:42.156247 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:27:42.211411 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:42.212413 [debug] [MainThread]: On master: BEGIN
[0m21:27:42.213300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:42.219983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.220934 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:42.221864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:42.267248 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m21:27:42.269220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120f730>]}
[0m21:27:42.270204 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:42.271181 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:42.272026 [debug] [MainThread]: On master: BEGIN
[0m21:27:42.273249 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.274167 [debug] [MainThread]: On master: COMMIT
[0m21:27:42.275009 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:42.275855 [debug] [MainThread]: On master: COMMIT
[0m21:27:42.276842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:27:42.277705 [debug] [MainThread]: On master: Close
[0m21:27:42.279037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:42.280069 [info ] [MainThread]: 
[0m21:27:42.282860 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:27:42.283951 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:27:42.285431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:27:42.286434 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:27:42.296249 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.298150 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:27:42.287026 => 21:27:42.297643
[0m21:27:42.299084 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:27:42.354268 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.355780 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.356706 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:27:42.357589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:42.364860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.365833 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.367394 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:27:42.373026 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:27:42.384400 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.385544 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:27:42.387177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.393391 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.394417 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:27:42.395983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.418722 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:27:42.419786 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.421094 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:27:42.423027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:27:42.433565 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:27:42.440261 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:27:42.441205 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:27:42.443940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:27:42.446553 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:27:42.299673 => 21:27:42.446111
[0m21:27:42.447534 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:27:42.448937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a3280>]}
[0m21:27:42.450228 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:27:42.451512 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:27:42.452508 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:27:42.453524 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:27:42.454820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:27:42.455865 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:27:42.458853 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.460553 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:27:42.456575 => 21:27:42.459981
[0m21:27:42.461533 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:27:42.468759 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.470128 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.471070 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:27:42.471975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:42.480555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.481910 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.482832 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:27:42.486391 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:27:42.492574 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.493614 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:27:42.495311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.498483 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:27:42.499445 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.500448 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:27:42.502625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:27:42.507822 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:27:42.510595 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:27:42.511593 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:27:42.512875 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:27:42.515271 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:27:42.462145 => 21:27:42.514832
[0m21:27:42.516203 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:27:42.517603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111257a90>]}
[0m21:27:42.518876 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.06s]
[0m21:27:42.520230 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:27:42.521228 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:27:42.522239 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:27:42.523756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:27:42.524690 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:27:42.530456 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:27:42.532304 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:27:42.525286 => 21:27:42.531582
[0m21:27:42.534504 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:27:42.572469 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:27:42.574005 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:27:42.574935 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:27:42.575813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:42.582323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.583294 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:27:42.584205 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:27:42.594609 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:27:42.600045 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:27:42.601010 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:27:42.602324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.607546 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:27:42.608606 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:27:42.610116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.618373 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:27:42.619350 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:27:42.620365 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:27:42.622009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:27:42.626704 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:27:42.631654 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:27:42.632615 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:27:42.636456 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:27:42.639284 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:27:42.535839 => 21:27:42.638787
[0m21:27:42.640438 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:27:42.642068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120f760>]}
[0m21:27:42.643458 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.12s]
[0m21:27:42.644729 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:27:42.645717 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:27:42.646765 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:27:42.648200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:27:42.649329 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:27:42.652276 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.653691 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:27:42.650040 => 21:27:42.653236
[0m21:27:42.654586 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:27:42.663089 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.664911 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.665853 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:27:42.666718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:42.673114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.674683 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.676629 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:27:42.682964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:27:42.688823 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.690054 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:27:42.692238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.697353 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.698786 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:27:42.700500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:42.704404 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:27:42.705357 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.706327 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:27:42.708575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:27:42.715075 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:27:42.717292 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:27:42.718410 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:27:42.721306 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:27:42.723933 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:27:42.655198 => 21:27:42.723500
[0m21:27:42.724858 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:27:42.726273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a8b8d9-3627-4a14-a201-de3daddaa943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136dd20>]}
[0m21:27:42.727630 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:27:42.728887 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:27:42.730886 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:42.731750 [debug] [MainThread]: On master: BEGIN
[0m21:27:42.732573 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:42.739359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:42.740416 [debug] [MainThread]: On master: COMMIT
[0m21:27:42.742089 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:42.743286 [debug] [MainThread]: On master: COMMIT
[0m21:27:42.744843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:27:42.745735 [debug] [MainThread]: On master: Close
[0m21:27:42.747013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:42.747937 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_product_stg' was properly closed.
[0m21:27:42.748825 [info ] [MainThread]: 
[0m21:27:42.749766 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m21:27:42.751698 [debug] [MainThread]: Command end result
[0m21:27:42.763286 [info ] [MainThread]: 
[0m21:27:42.764337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:42.765258 [info ] [MainThread]: 
[0m21:27:42.766302 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:27:42.768550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4703162, "process_user_time": 3.816954, "process_kernel_time": 0.285924, "process_mem_max_rss": "111374336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:42.770525 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:42.770134 after 1.47 seconds
[0m21:27:42.772068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfa66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111361e40>]}
[0m21:27:42.773290 [debug] [MainThread]: Flushing usage events
[0m21:48:57.388706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109941b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be82860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be82500>]}


============================== 21:48:57.395805 | 5409577d-5478-45d8-8a01-354ef4854388 ==============================
[0m21:48:57.395805 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:48:57.397211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:57.811288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be82770>]}
[0m21:48:57.936161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf71060>]}
[0m21:48:57.937644 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:48:57.959533 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:48:58.036348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:48:58.037475 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/dbt_sales.sql
[0m21:48:58.227812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:48:58.236715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb740d0>]}
[0m21:48:58.252215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9efeb0>]}
[0m21:48:58.253393 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:48:58.254681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9efe80>]}
[0m21:48:58.257951 [info ] [MainThread]: 
[0m21:48:58.260511 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:48:58.263041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:48:58.282631 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:48:58.283602 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:48:58.284456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:58.331857 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:48:58.334276 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:48:58.337454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:48:58.346292 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:48:58.347362 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:48:58.348185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:58.354622 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.355514 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:48:58.356445 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:48:58.362576 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:48:58.365211 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:48:58.366240 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:48:58.422752 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:58.423768 [debug] [MainThread]: On master: BEGIN
[0m21:48:58.424717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:58.431204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.432125 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:58.433191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:48:58.483438 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:48:58.485437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb76f80>]}
[0m21:48:58.486447 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:58.487444 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:58.488291 [debug] [MainThread]: On master: BEGIN
[0m21:48:58.489546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.490435 [debug] [MainThread]: On master: COMMIT
[0m21:48:58.491283 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:58.492198 [debug] [MainThread]: On master: COMMIT
[0m21:48:58.493198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:58.494057 [debug] [MainThread]: On master: Close
[0m21:48:58.495331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:58.496361 [info ] [MainThread]: 
[0m21:48:58.499150 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:48:58.500222 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:48:58.501811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:48:58.502858 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:48:58.513643 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.515196 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:48:58.503453 => 21:48:58.514711
[0m21:48:58.516115 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:48:58.572081 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.574614 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.575595 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:48:58.576486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:58.583438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.584614 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.586197 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:48:58.591991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:58.601644 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.602629 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:48:58.604080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.609116 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.610054 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:48:58.611803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.634722 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:48:58.635810 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.636733 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:48:58.638689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:58.649777 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:48:58.656898 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:48:58.657995 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:48:58.660715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:58.663195 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:48:58.516690 => 21:48:58.662750
[0m21:48:58.664205 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:48:58.665683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ee320>]}
[0m21:48:58.666982 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:48:58.668359 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:48:58.669683 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:48:58.670741 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:48:58.672172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:48:58.673101 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:48:58.676199 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.677834 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:48:58.673679 => 21:48:58.677342
[0m21:48:58.678756 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:48:58.685977 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.687333 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.688269 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:48:58.689343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:58.698830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.699803 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.700852 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:48:58.704755 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:58.711524 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.712516 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:48:58.713970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.718920 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.719862 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:48:58.721158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.725681 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:48:58.727344 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.728369 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:48:58.730369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:58.735269 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:48:58.737424 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:48:58.738322 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:48:58.741104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:58.744547 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:48:58.679358 => 21:48:58.743862
[0m21:48:58.745844 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:48:58.747579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb79ae0>]}
[0m21:48:58.748831 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.08s]
[0m21:48:58.750379 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:48:58.751386 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:48:58.752388 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:48:58.753708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:48:58.754639 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:48:58.759282 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:48:58.760869 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:48:58.755620 => 21:48:58.760339
[0m21:48:58.761802 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:48:58.800251 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:48:58.801836 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:48:58.802814 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:48:58.803700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:58.814503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.815561 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:48:58.816851 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:48:58.832960 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:48:58.841783 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:48:58.843459 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:48:58.845830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.852162 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:48:58.853327 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:48:58.855688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.866100 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:48:58.867144 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:48:58.868082 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:48:58.869678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:58.874371 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:48:58.879304 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:48:58.880371 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:48:58.884168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:48:58.886970 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:48:58.762387 => 21:48:58.886469
[0m21:48:58.888249 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:48:58.889908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc67df0>]}
[0m21:48:58.891278 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.14s]
[0m21:48:58.892541 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:48:58.893549 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:48:58.895306 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:48:58.897469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:48:58.898813 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:48:58.901646 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.903978 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:48:58.899428 => 21:48:58.903105
[0m21:48:58.904961 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:48:58.915670 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.917092 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.918005 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:48:58.918905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:58.926071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:58.927047 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.928002 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:48:58.933471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:58.938781 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.939733 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:48:58.941466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.951070 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.952063 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:48:58.954060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:58.957882 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:48:58.958836 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.959724 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:48:58.961726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:58.966909 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:48:58.969218 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:48:58.970161 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:48:58.972840 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:58.975537 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:48:58.905685 => 21:48:58.975103
[0m21:48:58.976610 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:48:58.978355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc3c430>]}
[0m21:48:58.979597 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:48:58.981095 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:48:58.982468 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:48:58.983491 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:48:58.985032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:48:58.986974 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:48:58.995672 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:48:58.997959 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:48:58.987660 => 21:48:58.997312
[0m21:48:58.998949 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:48:59.011303 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:48:59.012711 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:48:59.013608 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:48:59.014463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:59.023360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:59.024923 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:48:59.025990 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productsubcategorykey,
p.productcategoryname
COUNT(f.productkey) AS ProductSalesNo
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productsubcategorykey,
p.productcategoryname
  );
[0m21:48:59.027355 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 11: COUNT(f.productkey) AS ProductSalesNo
              ^

[0m21:48:59.028285 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: ROLLBACK
[0m21:48:59.029868 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:48:58.999840 => 21:48:59.029224
[0m21:48:59.030822 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:48:59.045542 [debug] [Thread-1 (]: Database Error in model dbt_sales (models/dbt_sales.sql)
  syntax error at or near "("
  LINE 11: COUNT(f.productkey) AS ProductSalesNo
                ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:48:59.047027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5409577d-5478-45d8-8a01-354ef4854388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbb42e0>]}
[0m21:48:59.048626 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_schema.dbt_sales ...................... [[31mERROR[0m in 0.06s]
[0m21:48:59.050372 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:48:59.052651 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:59.053650 [debug] [MainThread]: On master: BEGIN
[0m21:48:59.054593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:59.067119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:59.068180 [debug] [MainThread]: On master: COMMIT
[0m21:48:59.069213 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:59.070106 [debug] [MainThread]: On master: COMMIT
[0m21:48:59.071149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:59.072007 [debug] [MainThread]: On master: Close
[0m21:48:59.073724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:59.075257 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:48:59.076560 [info ] [MainThread]: 
[0m21:48:59.077502 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m21:48:59.079684 [debug] [MainThread]: Command end result
[0m21:48:59.092446 [info ] [MainThread]: 
[0m21:48:59.094202 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:48:59.095647 [info ] [MainThread]: 
[0m21:48:59.097181 [error] [MainThread]:   Database Error in model dbt_sales (models/dbt_sales.sql)
  syntax error at or near "("
  LINE 11: COUNT(f.productkey) AS ProductSalesNo
                ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:48:59.098206 [info ] [MainThread]: 
[0m21:48:59.099751 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:48:59.103165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.803051, "process_user_time": 4.082398, "process_kernel_time": 0.456627, "process_mem_max_rss": "111955968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:48:59.105145 [debug] [MainThread]: Command `dbt run` failed at 21:48:59.104766 after 1.81 seconds
[0m21:48:59.106270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109941b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c23c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbb0f70>]}
[0m21:48:59.107755 [debug] [MainThread]: Flushing usage events
[0m21:49:38.352189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e082800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0824a0>]}


============================== 21:49:38.358224 | 44c24745-d9d2-4900-8b02-b2b3921a7efe ==============================
[0m21:49:38.358224 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:49:38.360175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:49:38.653081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e082710>]}
[0m21:49:38.801811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0418a0>]}
[0m21:49:38.803368 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:49:38.831776 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:49:38.889248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:49:38.890458 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:49:39.123336 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:49:39.133656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed940d0>]}
[0m21:49:39.157589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebffbe0>]}
[0m21:49:39.159282 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:49:39.160363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebfc790>]}
[0m21:49:39.162821 [info ] [MainThread]: 
[0m21:49:39.164819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:39.170250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:49:39.197791 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:49:39.201292 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:49:39.202847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:39.254059 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:49:39.256459 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:49:39.260853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:49:39.275513 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:49:39.276461 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:49:39.277419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:39.287055 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.288169 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:49:39.289076 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:49:39.297558 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:49:39.302835 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:49:39.304383 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:49:39.313929 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:39.314882 [debug] [MainThread]: On master: BEGIN
[0m21:49:39.316748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:39.325244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.326235 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:39.327166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:49:39.383021 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:49:39.385302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda2200>]}
[0m21:49:39.386359 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:39.387459 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:39.388323 [debug] [MainThread]: On master: BEGIN
[0m21:49:39.390274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.391226 [debug] [MainThread]: On master: COMMIT
[0m21:49:39.392060 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:39.392880 [debug] [MainThread]: On master: COMMIT
[0m21:49:39.393851 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:49:39.394709 [debug] [MainThread]: On master: Close
[0m21:49:39.396044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:39.397272 [info ] [MainThread]: 
[0m21:49:39.462991 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:49:39.464436 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:49:39.467647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:49:39.469298 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:49:39.480300 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.482092 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:49:39.470051 => 21:49:39.481488
[0m21:49:39.484293 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:49:39.542387 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.543835 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.544800 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:49:39.545892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:39.554793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.556590 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.557934 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:49:39.561879 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:39.573774 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.574788 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:49:39.576280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:39.581625 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.582784 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:49:39.585590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:39.614018 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:49:39.615175 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.616302 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:49:39.620236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:39.635100 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:49:39.643326 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:39.644339 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:49:39.647147 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:39.649994 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:49:39.485044 => 21:49:39.649446
[0m21:49:39.652498 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:49:39.654128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee06020>]}
[0m21:49:39.656157 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.19s]
[0m21:49:39.657697 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:49:39.659380 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:39.660475 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:49:39.662497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:49:39.663654 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:39.668958 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.671387 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:49:39.664316 => 21:49:39.670324
[0m21:49:39.672904 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:39.682867 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.685272 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.686297 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:49:39.687211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:39.694902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.696009 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.697087 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:49:39.702118 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:39.708708 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.709721 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:49:39.711219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:39.718846 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.719872 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:49:39.721347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:39.726068 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:49:39.727144 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.728066 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:49:39.730329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:39.737574 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:49:39.740634 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:39.741670 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:49:39.744271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:39.747453 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:49:39.673944 => 21:49:39.746794
[0m21:49:39.750539 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:49:39.753162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf1a80>]}
[0m21:49:39.754503 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.09s]
[0m21:49:39.757195 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:39.758285 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:49:39.759324 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:49:39.760664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:49:39.761592 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:49:39.766695 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:49:39.769171 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:49:39.762196 => 21:49:39.768613
[0m21:49:39.770252 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:49:39.814659 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:49:39.817974 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:39.819530 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:49:39.820553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:39.830355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.832074 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:39.834149 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:49:39.848314 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:49:39.860666 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:39.862444 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:49:39.864781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:39.874899 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:39.876773 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:49:39.879952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:39.893677 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:49:39.894911 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:39.896177 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:49:39.904629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:39.918594 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:49:39.924239 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:39.925243 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:49:39.929632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:49:39.933465 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:49:39.770964 => 21:49:39.933002
[0m21:49:39.934512 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:49:39.936052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec0a5f0>]}
[0m21:49:39.937386 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.18s]
[0m21:49:39.938912 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:49:39.939993 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:49:39.941151 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:49:39.942692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:49:39.943633 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:49:39.947111 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:49:39.948795 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:49:39.944225 => 21:49:39.948216
[0m21:49:39.949900 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:49:39.959963 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:49:39.961692 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:39.962632 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:49:39.963515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:39.972996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:39.974115 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:39.975476 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:49:39.981040 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:40.005859 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:40.007854 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:49:40.011658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:40.024178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:40.026390 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:49:40.033046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:40.043752 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:49:40.045022 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:40.045995 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:49:40.048866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:40.057159 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:49:40.059563 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:40.060520 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:49:40.063357 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:40.066403 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:49:39.950530 => 21:49:40.065950
[0m21:49:40.067432 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:49:40.069169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf1210>]}
[0m21:49:40.071029 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.13s]
[0m21:49:40.072340 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:49:40.073737 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:49:40.074778 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:49:40.076201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:49:40.077373 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:49:40.082267 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:49:40.083868 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:49:40.078068 => 21:49:40.083302
[0m21:49:40.085066 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:49:40.098390 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:49:40.100044 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:49:40.101957 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:49:40.103626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:40.114151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:40.116166 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:49:40.118425 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productsubcategorykey,
p.productcategoryname
COUNT(distinct f.productkey) AS ProductSalesNo
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productsubcategorykey,
p.productcategoryname
  );
[0m21:49:40.120848 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 11: COUNT(distinct f.productkey) AS ProductSalesNo
              ^

[0m21:49:40.122383 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: ROLLBACK
[0m21:49:40.124502 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:49:40.086403 => 21:49:40.123977
[0m21:49:40.125530 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:49:40.129397 [debug] [Thread-1 (]: Database Error in model dbt_sales (models/dbt_sales.sql)
  syntax error at or near "("
  LINE 11: COUNT(distinct f.productkey) AS ProductSalesNo
                ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:49:40.130645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c24745-d9d2-4900-8b02-b2b3921a7efe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee55a50>]}
[0m21:49:40.132367 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_schema.dbt_sales ...................... [[31mERROR[0m in 0.05s]
[0m21:49:40.134577 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:49:40.136775 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:40.137707 [debug] [MainThread]: On master: BEGIN
[0m21:49:40.138577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:40.154958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:40.155997 [debug] [MainThread]: On master: COMMIT
[0m21:49:40.156996 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:40.157913 [debug] [MainThread]: On master: COMMIT
[0m21:49:40.159137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:49:40.160108 [debug] [MainThread]: On master: Close
[0m21:49:40.161869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:40.162946 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:49:40.164005 [info ] [MainThread]: 
[0m21:49:40.165147 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m21:49:40.168125 [debug] [MainThread]: Command end result
[0m21:49:40.180293 [info ] [MainThread]: 
[0m21:49:40.181632 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:49:40.183313 [info ] [MainThread]: 
[0m21:49:40.184894 [error] [MainThread]:   Database Error in model dbt_sales (models/dbt_sales.sql)
  syntax error at or near "("
  LINE 11: COUNT(distinct f.productkey) AS ProductSalesNo
                ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:49:40.186434 [info ] [MainThread]: 
[0m21:49:40.187554 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:49:40.191372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9173877, "process_user_time": 4.182, "process_kernel_time": 0.337777, "process_mem_max_rss": "111718400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:40.193409 [debug] [MainThread]: Command `dbt run` failed at 21:49:40.193033 after 1.92 seconds
[0m21:49:40.195051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebffd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eda30d0>]}
[0m21:49:40.196691 [debug] [MainThread]: Flushing usage events
[0m21:49:50.375434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702500>]}


============================== 21:49:50.381321 | a3ff3e7f-7a05-4031-b41d-6dff2646bba9 ==============================
[0m21:49:50.381321 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:49:50.382537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:50.696198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702770>]}
[0m21:49:50.911398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a59060>]}
[0m21:49:50.914085 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:49:50.952796 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:49:51.008731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:49:51.009922 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:49:51.211845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:49:51.220656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4140d0>]}
[0m21:49:51.235614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27fca0>]}
[0m21:49:51.236673 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:49:51.237648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27fd60>]}
[0m21:49:51.242473 [info ] [MainThread]: 
[0m21:49:51.244871 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:51.249012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:49:51.270681 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:49:51.273678 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:49:51.274876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:51.302183 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:49:51.304883 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:49:51.309893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:49:51.320307 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:49:51.321236 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:49:51.322654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:51.331563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:49:51.332489 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:49:51.333348 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:49:51.340072 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:49:51.342279 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:49:51.343273 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:49:51.352760 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:51.354505 [debug] [MainThread]: On master: BEGIN
[0m21:49:51.355374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:51.363356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:51.364290 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:51.365317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:49:51.414978 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:49:51.417080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a423cd0>]}
[0m21:49:51.418071 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:51.419103 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:51.419930 [debug] [MainThread]: On master: BEGIN
[0m21:49:51.420962 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:51.421795 [debug] [MainThread]: On master: COMMIT
[0m21:49:51.422624 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:51.423436 [debug] [MainThread]: On master: COMMIT
[0m21:49:51.424646 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:49:51.425603 [debug] [MainThread]: On master: Close
[0m21:49:51.427655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:51.429086 [info ] [MainThread]: 
[0m21:49:51.492222 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:49:51.494052 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:49:51.496009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:49:51.497088 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:49:51.506691 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.509185 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:49:51.497697 => 21:49:51.508197
[0m21:49:51.510940 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:49:51.571722 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.573359 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.575306 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:49:51.576313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:51.587732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:51.589018 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.591480 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:49:51.596572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:51.608948 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.609968 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:49:51.611596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:51.617728 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.618704 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:49:51.620086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:51.647246 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:49:51.648527 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.649496 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:49:51.652593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:51.666676 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:49:51.675261 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:51.676251 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:49:51.679346 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:51.682437 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:49:51.512021 => 21:49:51.681994
[0m21:49:51.683374 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:49:51.684854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb2590>]}
[0m21:49:51.686175 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.19s]
[0m21:49:51.687560 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:49:51.689383 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:51.690758 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:49:51.692259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:49:51.693252 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:51.696942 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.701950 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:49:51.694001 => 21:49:51.698133
[0m21:49:51.702936 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:51.717353 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.719649 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.731866 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:49:51.732884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:51.783801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:51.785223 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.786766 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:49:51.791172 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:51.798680 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.799683 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:49:51.806681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:51.813890 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.814900 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:49:51.817688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:51.822891 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:49:51.823912 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.824835 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:49:51.829055 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:51.834943 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:49:51.838358 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:51.840718 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:49:51.850644 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:51.854634 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:49:51.710261 => 21:49:51.853936
[0m21:49:51.855812 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:49:51.859958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b7af0>]}
[0m21:49:51.863171 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.17s]
[0m21:49:51.865507 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:51.867437 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:49:51.868617 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:49:51.870418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:49:51.872639 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:49:51.883106 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:49:51.885978 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:49:51.873359 => 21:49:51.885482
[0m21:49:51.886922 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:49:51.947592 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:49:51.949203 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:51.950194 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:49:51.951086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:51.958963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:51.960112 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:51.961114 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:49:51.972661 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:49:51.978930 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:51.980305 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:49:51.982314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:51.988782 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:51.990150 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:49:51.991642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:52.001237 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:49:52.002446 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:52.003471 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:49:52.005693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:52.010590 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:49:52.015788 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:52.016841 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:49:52.020449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:49:52.023742 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:49:51.887509 => 21:49:52.023302
[0m21:49:52.024694 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:49:52.026084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b6290>]}
[0m21:49:52.027389 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.16s]
[0m21:49:52.028947 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:49:52.030127 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:49:52.031646 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:49:52.033269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:49:52.034353 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:49:52.037390 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.038935 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:49:52.035000 => 21:49:52.038357
[0m21:49:52.040176 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:49:52.053602 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.055783 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.056799 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:49:52.057691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:52.065099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:52.066187 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.067315 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:49:52.073715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:52.079331 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.080572 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:49:52.082728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:52.089219 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.090269 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:49:52.092560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:52.097073 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:49:52.098275 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.099220 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:49:52.101053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:52.107526 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:49:52.109633 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:52.110610 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:49:52.113409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:52.116232 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:49:52.040927 => 21:49:52.115739
[0m21:49:52.117246 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:49:52.118879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a52ebf0>]}
[0m21:49:52.120218 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:49:52.121486 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:49:52.122869 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:49:52.123903 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:49:52.125300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:49:52.126233 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:49:52.131121 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:49:52.132995 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:49:52.126900 => 21:49:52.132170
[0m21:49:52.136065 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:49:52.150175 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:49:52.151991 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:49:52.152932 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:49:52.153818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:52.162252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:52.163922 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:49:52.165472 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productsubcategorykey,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productsubcategorykey,
p.productcategoryname
  );
[0m21:49:52.166901 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SUM"
LINE 12: SUM(f.salesamount * f.salesquantity) AS Total
         ^

[0m21:49:52.168191 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: ROLLBACK
[0m21:49:52.169704 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:49:52.137169 => 21:49:52.169222
[0m21:49:52.170820 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:49:52.174979 [debug] [Thread-1 (]: Database Error in model dbt_sales (models/dbt_sales.sql)
  syntax error at or near "SUM"
  LINE 12: SUM(f.salesamount * f.salesquantity) AS Total
           ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:49:52.176146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3ff3e7f-7a05-4031-b41d-6dff2646bba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d86a0>]}
[0m21:49:52.177312 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_schema.dbt_sales ...................... [[31mERROR[0m in 0.05s]
[0m21:49:52.178730 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:49:52.180827 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:52.181710 [debug] [MainThread]: On master: BEGIN
[0m21:49:52.182615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:52.190415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:52.193210 [debug] [MainThread]: On master: COMMIT
[0m21:49:52.194466 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:52.195506 [debug] [MainThread]: On master: COMMIT
[0m21:49:52.196911 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:49:52.198491 [debug] [MainThread]: On master: Close
[0m21:49:52.201148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:52.202581 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:49:52.203827 [info ] [MainThread]: 
[0m21:49:52.204811 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m21:49:52.207789 [debug] [MainThread]: Command end result
[0m21:49:52.225217 [info ] [MainThread]: 
[0m21:49:52.227579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:49:52.229001 [info ] [MainThread]: 
[0m21:49:52.230203 [error] [MainThread]:   Database Error in model dbt_sales (models/dbt_sales.sql)
  syntax error at or near "SUM"
  LINE 12: SUM(f.salesamount * f.salesquantity) AS Total
           ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:49:52.232885 [info ] [MainThread]: 
[0m21:49:52.235145 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:49:52.240532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9589884, "process_user_time": 4.158492, "process_kernel_time": 0.325735, "process_mem_max_rss": "111521792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:52.242642 [debug] [MainThread]: Command `dbt run` failed at 21:49:52.242115 after 1.96 seconds
[0m21:49:52.245237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a423d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a421990>]}
[0m21:49:52.246885 [debug] [MainThread]: Flushing usage events
[0m21:49:57.973200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a530>]}


============================== 21:49:57.978678 | c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c ==============================
[0m21:49:57.978678 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:49:57.979902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:49:58.247388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a7a0>]}
[0m21:49:58.369249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088df3d0>]}
[0m21:49:58.370742 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:49:58.390842 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:49:58.448366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:49:58.449584 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:49:58.634096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:49:58.641596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967c0d0>]}
[0m21:49:58.654636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e7c70>]}
[0m21:49:58.655815 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:49:58.657872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e4820>]}
[0m21:49:58.661848 [info ] [MainThread]: 
[0m21:49:58.663633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:58.665870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:49:58.685127 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:49:58.686163 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:49:58.687321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:58.712787 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:49:58.715192 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:49:58.719077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:49:58.728301 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:49:58.729240 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:49:58.730072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:58.737062 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:49:58.738136 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:49:58.739014 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:49:58.745063 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:49:58.747236 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:49:58.748397 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:49:58.757097 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:58.758018 [debug] [MainThread]: On master: BEGIN
[0m21:49:58.758835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:58.765105 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:58.766018 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:58.766949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:49:58.814275 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:49:58.816267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109689d80>]}
[0m21:49:58.817263 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:58.818254 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:58.819094 [debug] [MainThread]: On master: BEGIN
[0m21:49:58.820121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:58.820970 [debug] [MainThread]: On master: COMMIT
[0m21:49:58.821810 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:58.822642 [debug] [MainThread]: On master: COMMIT
[0m21:49:58.823584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:49:58.824435 [debug] [MainThread]: On master: Close
[0m21:49:58.825736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:58.826820 [info ] [MainThread]: 
[0m21:49:58.882541 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:49:58.884305 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:49:58.886376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:49:58.887942 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:49:58.898759 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:49:58.900314 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:49:58.889271 => 21:49:58.899782
[0m21:49:58.901316 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:49:58.955605 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:49:58.957099 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:58.958122 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:49:58.959031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:58.965631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:58.966625 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:58.967550 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:49:58.971636 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:58.980599 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:58.981632 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:49:58.983037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:58.988107 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:58.989066 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:49:58.990393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.012719 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:49:59.013725 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:59.014650 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:49:59.016872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:59.028578 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:49:59.035617 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:49:59.036647 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:49:59.039803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:59.042700 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:49:58.902258 => 21:49:59.042188
[0m21:49:59.043814 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:49:59.045643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109332560>]}
[0m21:49:59.046927 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:49:59.048217 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:49:59.049217 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:59.050227 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:49:59.051551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:49:59.052484 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:59.055549 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.057160 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:49:59.053077 => 21:49:59.056659
[0m21:49:59.058117 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:59.065267 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.066607 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.067589 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:49:59.069309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:59.079328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:59.080350 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.081283 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:49:59.085144 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:59.091604 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.092963 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:49:59.094962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.100331 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.101325 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:49:59.103048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.108113 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:49:59.109440 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.110416 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:49:59.112109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:59.116903 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:49:59.119122 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:49:59.120094 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:49:59.122748 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:59.125786 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:49:59.058718 => 21:49:59.125270
[0m21:49:59.126874 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:49:59.128294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c80a0>]}
[0m21:49:59.129662 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.08s]
[0m21:49:59.130973 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:49:59.131979 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:49:59.133204 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:49:59.134557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:49:59.135750 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:49:59.140134 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:49:59.141579 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:49:59.136587 => 21:49:59.141117
[0m21:49:59.142544 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:49:59.178168 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:49:59.179743 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:59.180703 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:49:59.181595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:59.189439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:59.190597 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:59.192067 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:49:59.203038 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:49:59.208674 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:59.209669 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:49:59.211011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.215986 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:59.217074 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:49:59.218648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.227101 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:49:59.228092 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:59.229094 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:49:59.230695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:59.235439 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:49:59.240043 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:49:59.241024 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:49:59.244784 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:49:59.247612 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:49:59.143187 => 21:49:59.247107
[0m21:49:59.248708 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:49:59.250347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951c2e0>]}
[0m21:49:59.251752 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.12s]
[0m21:49:59.253054 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:49:59.254118 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:49:59.255350 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:49:59.256845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:49:59.258155 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:49:59.261242 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.262692 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:49:59.258916 => 21:49:59.262226
[0m21:49:59.263612 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:49:59.271120 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.272882 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.275430 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:49:59.277110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:59.283970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:59.285142 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.286647 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:49:59.292130 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:49:59.297757 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.298742 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:49:59.300401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.306131 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.307115 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:49:59.308950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:49:59.313088 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:49:59.314194 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.315114 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:49:59.317414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:49:59.324115 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:49:59.326251 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:49:59.327187 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:49:59.330188 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:49:59.332621 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:49:59.264260 => 21:49:59.332187
[0m21:49:59.333546 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:49:59.335098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109792c20>]}
[0m21:49:59.336636 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:49:59.337915 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:49:59.339402 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:49:59.340557 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:49:59.341877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:49:59.342823 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:49:59.347424 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:49:59.348975 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:49:59.343420 => 21:49:59.348502
[0m21:49:59.349909 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:49:59.359130 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:49:59.360916 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:49:59.362328 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:49:59.363920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:59.371545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:49:59.372815 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:49:59.373807 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productsubcategorykey,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo,
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productsubcategorykey,
p.productcategoryname
  );
[0m21:49:59.376690 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column p.productsubcategorykey does not exist
LINE 9: p.productsubcategorykey,
        ^

[0m21:49:59.377802 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: ROLLBACK
[0m21:49:59.379553 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:49:59.350515 => 21:49:59.378852
[0m21:49:59.380920 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:49:59.386445 [debug] [Thread-1 (]: Database Error in model dbt_sales (models/dbt_sales.sql)
  column p.productsubcategorykey does not exist
  LINE 9: p.productsubcategorykey,
          ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:49:59.387559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e0e81e-4df0-4250-a7e4-5bdb6f3d952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109743dc0>]}
[0m21:49:59.388733 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dbt_schema.dbt_sales ...................... [[31mERROR[0m in 0.05s]
[0m21:49:59.390074 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:49:59.392086 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:59.392983 [debug] [MainThread]: On master: BEGIN
[0m21:49:59.393825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:59.401344 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:49:59.402384 [debug] [MainThread]: On master: COMMIT
[0m21:49:59.403267 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:59.404553 [debug] [MainThread]: On master: COMMIT
[0m21:49:59.406955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:49:59.408571 [debug] [MainThread]: On master: Close
[0m21:49:59.409952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:59.410951 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:49:59.411884 [info ] [MainThread]: 
[0m21:49:59.412971 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m21:49:59.415639 [debug] [MainThread]: Command end result
[0m21:49:59.426945 [info ] [MainThread]: 
[0m21:49:59.428108 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:49:59.429115 [info ] [MainThread]: 
[0m21:49:59.430059 [error] [MainThread]:   Database Error in model dbt_sales (models/dbt_sales.sql)
  column p.productsubcategorykey does not exist
  LINE 9: p.productsubcategorykey,
          ^
  compiled Code at target/run/postgres_dbt/models/dbt_sales.sql
[0m21:49:59.431380 [info ] [MainThread]: 
[0m21:49:59.432557 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:49:59.435148 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.534924, "process_user_time": 3.888712, "process_kernel_time": 0.278564, "process_mem_max_rss": "111697920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:59.437239 [debug] [MainThread]: Command `dbt run` failed at 21:49:59.436800 after 1.54 seconds
[0m21:49:59.438692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10968bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109688df0>]}
[0m21:49:59.440255 [debug] [MainThread]: Flushing usage events
[0m21:51:24.656459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11030db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ae860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ae500>]}


============================== 21:51:24.661862 | 34dc1e76-87af-4d5a-81ce-8631d5b5f739 ==============================
[0m21:51:24.661862 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:51:24.663065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:51:24.941915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ae770>]}
[0m21:51:25.065620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c05060>]}
[0m21:51:25.067080 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:51:25.090081 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:51:25.147212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:51:25.148445 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:51:25.335384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:51:25.343495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135c00d0>]}
[0m21:51:25.358152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11342bca0>]}
[0m21:51:25.359862 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:51:25.360939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11342bd60>]}
[0m21:51:25.363606 [info ] [MainThread]: 
[0m21:51:25.365614 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:25.369467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:51:25.385865 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:51:25.387207 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:51:25.388296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:25.426918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:51:25.429602 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:51:25.432740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:51:25.443795 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:51:25.444776 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:51:25.445829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:25.452377 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:51:25.453322 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:51:25.454393 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:51:25.460453 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:51:25.462676 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:51:25.463700 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:51:25.472066 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:25.472998 [debug] [MainThread]: On master: BEGIN
[0m21:51:25.473827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:25.479955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:51:25.480864 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:25.481815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:51:25.529117 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:51:25.531096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cd780>]}
[0m21:51:25.532080 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:25.533164 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:25.534136 [debug] [MainThread]: On master: BEGIN
[0m21:51:25.535385 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:51:25.536279 [debug] [MainThread]: On master: COMMIT
[0m21:51:25.537125 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:25.537956 [debug] [MainThread]: On master: COMMIT
[0m21:51:25.538991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:51:25.539854 [debug] [MainThread]: On master: Close
[0m21:51:25.541155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:25.542263 [info ] [MainThread]: 
[0m21:51:25.662029 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:51:25.663186 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:51:25.664582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:51:25.665854 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:51:25.675581 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.677296 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:51:25.666517 => 21:51:25.676646
[0m21:51:25.679379 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:51:25.735773 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.737240 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.738353 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:51:25.739276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:25.746144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:51:25.747189 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.748243 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:51:25.752178 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:51:25.761342 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.762433 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:51:25.763868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:25.768926 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.770101 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:51:25.771740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:25.795278 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:51:25.796275 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.797180 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:51:25.798873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:51:25.809348 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:51:25.816593 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:51:25.817628 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:51:25.820480 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:51:25.823081 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:51:25.680138 => 21:51:25.822633
[0m21:51:25.824047 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:51:25.825445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d5f280>]}
[0m21:51:25.826743 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:51:25.828187 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:51:25.829223 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:51:25.830241 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:51:25.831567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:51:25.832508 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:51:25.835988 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.837605 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:51:25.833414 => 21:51:25.837108
[0m21:51:25.838554 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:51:25.845950 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.847460 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.848458 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:51:25.849371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:25.857469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:51:25.859160 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.860272 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:51:25.864457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:51:25.871088 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.872106 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:51:25.873509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:25.879213 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.880353 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:51:25.881812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:25.886660 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:51:25.887672 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.888710 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:51:25.890963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:51:25.896178 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:51:25.898764 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:51:25.900048 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:51:25.902573 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:51:25.905158 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:51:25.839146 => 21:51:25.904705
[0m21:51:25.906112 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:51:25.907518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11360c220>]}
[0m21:51:25.908834 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.08s]
[0m21:51:25.910129 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:51:25.911141 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:51:25.912165 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:51:25.913615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:51:25.914677 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:51:25.919449 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:51:25.921930 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:51:25.915286 => 21:51:25.920737
[0m21:51:25.924197 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:51:25.960865 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:51:25.962370 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:51:25.963430 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:51:25.964360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:25.971515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:51:25.972513 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:51:25.973515 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:51:25.984833 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:51:25.990242 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:51:25.991214 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:51:25.992533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:25.997558 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:51:25.998607 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:51:26.000965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:26.010178 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:51:26.011287 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:51:26.012313 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:51:26.013818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:51:26.018870 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:51:26.023919 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:51:26.024924 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:51:26.028728 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:51:26.031712 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:51:25.924925 => 21:51:26.031191
[0m21:51:26.032842 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:51:26.034492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134674c0>]}
[0m21:51:26.035817 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.12s]
[0m21:51:26.037114 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:51:26.038206 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:51:26.039467 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:51:26.040808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:51:26.041959 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:51:26.044938 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.046431 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:51:26.042661 => 21:51:26.045924
[0m21:51:26.047735 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:51:26.056302 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.058822 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.060499 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:51:26.061572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:26.069472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:51:26.070858 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.072170 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:51:26.077184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:51:26.082718 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.083766 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:51:26.085917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:26.091599 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.092561 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:51:26.094124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:26.097883 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:51:26.098845 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.099746 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:51:26.101542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:51:26.110103 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:51:26.112611 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:51:26.113572 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:51:26.116334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:51:26.119110 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:51:26.048376 => 21:51:26.118660
[0m21:51:26.120299 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:51:26.121772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136dabf0>]}
[0m21:51:26.123057 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:51:26.124427 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:51:26.125873 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:51:26.127222 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:51:26.129453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:51:26.130529 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:51:26.135062 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:51:26.136929 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:51:26.131137 => 21:51:26.136374
[0m21:51:26.138308 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:51:26.147223 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:51:26.149573 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:51:26.150636 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:51:26.151670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:26.163982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:51:26.165504 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:51:26.167150 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo,
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productcategoryname
  );
[0m21:51:26.176076 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:51:26.183301 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:51:26.184836 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp" rename to "dbt_sales"
[0m21:51:26.188254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:51:26.192022 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:51:26.193384 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:51:26.194355 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:51:26.195843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:51:26.201400 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup"
[0m21:51:26.203943 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:51:26.205558 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup" cascade
[0m21:51:26.207671 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:51:26.210637 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:51:26.139379 => 21:51:26.210190
[0m21:51:26.211726 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:51:26.213695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dc1e76-87af-4d5a-81ce-8631d5b5f739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113423be0>]}
[0m21:51:26.214976 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_schema.dbt_sales .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:51:26.216376 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:51:26.218797 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:26.220605 [debug] [MainThread]: On master: BEGIN
[0m21:51:26.221620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:26.228580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:51:26.229535 [debug] [MainThread]: On master: COMMIT
[0m21:51:26.230399 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:26.231257 [debug] [MainThread]: On master: COMMIT
[0m21:51:26.232345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:51:26.233523 [debug] [MainThread]: On master: Close
[0m21:51:26.235423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:26.236913 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:51:26.239108 [info ] [MainThread]: 
[0m21:51:26.240298 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m21:51:26.242806 [debug] [MainThread]: Command end result
[0m21:51:26.254469 [info ] [MainThread]: 
[0m21:51:26.256180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:26.257321 [info ] [MainThread]: 
[0m21:51:26.258406 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:51:26.260962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.680908, "process_user_time": 4.02853, "process_kernel_time": 0.322761, "process_mem_max_rss": "111443968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:51:26.263848 [debug] [MainThread]: Command `dbt run` succeeded at 21:51:26.263239 after 1.68 seconds
[0m21:51:26.265287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11030db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11342bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135ce020>]}
[0m21:51:26.267149 [debug] [MainThread]: Flushing usage events
[0m21:52:16.498112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed75b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b6500>]}


============================== 21:52:16.503741 | 31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe ==============================
[0m21:52:16.503741 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:52:16.504955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:16.781830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b6770>]}
[0m21:52:16.905947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a5060>]}
[0m21:52:16.907454 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:52:16.928975 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:52:16.988169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:52:16.989435 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:52:17.175412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:52:17.183411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb40d0>]}
[0m21:52:17.200026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e33ca0>]}
[0m21:52:17.201179 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:52:17.202215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e33d60>]}
[0m21:52:17.204798 [info ] [MainThread]: 
[0m21:52:17.206358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:17.210053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:52:17.226225 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:52:17.227692 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:52:17.230619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:17.276598 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:52:17.278957 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:52:17.282146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:52:17.291021 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:52:17.291982 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:52:17.292808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:52:17.299592 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.300493 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:52:17.301350 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:52:17.307461 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:52:17.309641 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:52:17.310608 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:52:17.319498 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:17.320424 [debug] [MainThread]: On master: BEGIN
[0m21:52:17.321237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:17.327427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.328332 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:17.329317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:52:17.379127 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:52:17.382027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fba8f0>]}
[0m21:52:17.382996 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:17.383981 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:17.384812 [debug] [MainThread]: On master: BEGIN
[0m21:52:17.385845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.386674 [debug] [MainThread]: On master: COMMIT
[0m21:52:17.387564 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:17.388402 [debug] [MainThread]: On master: COMMIT
[0m21:52:17.389354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:52:17.390209 [debug] [MainThread]: On master: Close
[0m21:52:17.391523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:52:17.392619 [info ] [MainThread]: 
[0m21:52:17.451524 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:52:17.452836 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:52:17.454367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:52:17.455582 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:52:17.466996 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.469226 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:52:17.456322 => 21:52:17.468702
[0m21:52:17.470175 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:52:17.526388 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.527833 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.528771 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:52:17.529779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:17.536724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.537710 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.538808 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:52:17.542921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:52:17.551928 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.552947 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:52:17.554430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.559509 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.560465 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:52:17.562039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.586307 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:52:17.587301 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.588214 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:52:17.590806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:52:17.602024 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:52:17.609293 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:52:17.610287 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:52:17.613430 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:52:17.616490 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:52:17.470765 => 21:52:17.615972
[0m21:52:17.617562 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:52:17.618950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111766590>]}
[0m21:52:17.620216 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:52:17.621581 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:52:17.622640 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:52:17.623748 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:52:17.625146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:52:17.626261 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:52:17.629226 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.630941 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:52:17.626960 => 21:52:17.630260
[0m21:52:17.632215 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:52:17.639962 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.641501 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.642597 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:52:17.643917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:17.651505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.652505 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.653417 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:52:17.658299 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:52:17.664436 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.665447 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:52:17.666878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.671745 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.672879 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:52:17.675333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.679801 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:52:17.680874 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.681771 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:52:17.684020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:52:17.690486 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:52:17.692909 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:52:17.693881 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:52:17.697568 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:52:17.700250 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:52:17.633199 => 21:52:17.699801
[0m21:52:17.701226 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:52:17.702609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e33820>]}
[0m21:52:17.703852 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.08s]
[0m21:52:17.705432 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:52:17.706520 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:52:17.707556 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:52:17.708949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:52:17.710222 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:52:17.715448 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:52:17.718302 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:52:17.710914 => 21:52:17.717722
[0m21:52:17.719283 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:52:17.754639 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:52:17.756080 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:52:17.757002 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:52:17.757885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:17.764538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.765540 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:52:17.766576 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:52:17.777494 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:52:17.782747 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:52:17.783897 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:52:17.786064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.791377 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:52:17.792382 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:52:17.796028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.806691 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:52:17.808015 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:52:17.809057 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:52:17.814601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:52:17.820873 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:52:17.826030 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:52:17.827027 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:52:17.830747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:52:17.833217 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:52:17.719887 => 21:52:17.832779
[0m21:52:17.834449 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:52:17.835940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e30fa0>]}
[0m21:52:17.837268 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.13s]
[0m21:52:17.838667 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:52:17.839756 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:52:17.840941 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:52:17.844241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:52:17.845998 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:52:17.849502 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.851542 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:52:17.847104 => 21:52:17.851011
[0m21:52:17.852505 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:52:17.860701 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.863054 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.865239 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:52:17.866790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:17.874476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.875855 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.877017 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:52:17.882399 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:52:17.887717 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.889438 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:52:17.891953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.899478 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.900472 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:52:17.902100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.906009 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:52:17.907580 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.908812 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:52:17.910550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:52:17.917138 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:52:17.919337 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:52:17.920293 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:52:17.922944 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:52:17.925429 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:52:17.853119 => 21:52:17.924990
[0m21:52:17.926585 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:52:17.928054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120debf0>]}
[0m21:52:17.929342 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:52:17.930734 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:52:17.932203 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:52:17.933244 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:52:17.934641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:52:17.936144 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:52:17.943628 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:52:17.946328 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:52:17.936810 => 21:52:17.945724
[0m21:52:17.947307 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:52:17.955246 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:52:17.958721 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:52:17.959954 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:52:17.960930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:17.970830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:52:17.972572 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:52:17.975031 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo,
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productcategoryname
ORDER BY Total DESC
  );
[0m21:52:17.980846 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:52:17.986881 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:52:17.987848 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp" rename to "dbt_sales"
[0m21:52:17.989625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:52:17.992826 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:52:17.993806 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:52:17.994702 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:52:17.997023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:52:18.004225 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup"
[0m21:52:18.006752 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:52:18.007710 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup" cascade
[0m21:52:18.008888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:52:18.011343 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:52:17.948203 => 21:52:18.010897
[0m21:52:18.012280 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:52:18.014147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f995b8-f70b-4870-a7ed-eb0dd2cb2dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e690c0>]}
[0m21:52:18.015731 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_schema.dbt_sales .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:52:18.017424 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:52:18.019416 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:18.020287 [debug] [MainThread]: On master: BEGIN
[0m21:52:18.021223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:52:18.028488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:52:18.029630 [debug] [MainThread]: On master: COMMIT
[0m21:52:18.030635 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:18.032137 [debug] [MainThread]: On master: COMMIT
[0m21:52:18.033543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:52:18.034513 [debug] [MainThread]: On master: Close
[0m21:52:18.035799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:18.036723 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:52:18.037725 [info ] [MainThread]: 
[0m21:52:18.038673 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m21:52:18.041004 [debug] [MainThread]: Command end result
[0m21:52:18.054269 [info ] [MainThread]: 
[0m21:52:18.055912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:52:18.057131 [info ] [MainThread]: 
[0m21:52:18.058438 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:52:18.064289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6410838, "process_user_time": 4.010397, "process_kernel_time": 0.309307, "process_mem_max_rss": "111661056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:52:18.066470 [debug] [MainThread]: Command `dbt run` succeeded at 21:52:18.065876 after 1.64 seconds
[0m21:52:18.069477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed75b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e33cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb9ba0>]}
[0m21:52:18.071155 [debug] [MainThread]: Flushing usage events
[0m21:53:28.671455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d62890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d62530>]}


============================== 21:53:28.677239 | 4b16b9af-0d8c-4b7c-a96e-b789dc72abe6 ==============================
[0m21:53:28.677239 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:53:28.678463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:53:28.948383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d627a0>]}
[0m21:53:29.078494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd73d0>]}
[0m21:53:29.079909 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:53:29.100307 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:53:29.159209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:29.160490 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:53:29.352782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:53:29.360544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6c0d0>]}
[0m21:53:29.376231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cfc70>]}
[0m21:53:29.377331 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:53:29.378294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cc820>]}
[0m21:53:29.380962 [info ] [MainThread]: 
[0m21:53:29.382741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:53:29.387571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:53:29.403148 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:53:29.404284 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:53:29.405860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:29.442804 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:53:29.445154 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:53:29.448254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:53:29.457665 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:53:29.458577 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:53:29.459533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:29.466089 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:53:29.467098 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:53:29.467959 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:53:29.473954 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:53:29.476077 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:53:29.477101 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:53:29.486042 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:29.486946 [debug] [MainThread]: On master: BEGIN
[0m21:53:29.487758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:29.494029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:53:29.494914 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:29.495826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:53:29.546080 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:53:29.548962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa76860>]}
[0m21:53:29.549938 [debug] [MainThread]: On master: ROLLBACK
[0m21:53:29.550922 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:29.551748 [debug] [MainThread]: On master: BEGIN
[0m21:53:29.552804 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:53:29.553644 [debug] [MainThread]: On master: COMMIT
[0m21:53:29.554487 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:29.555310 [debug] [MainThread]: On master: COMMIT
[0m21:53:29.556235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:53:29.557455 [debug] [MainThread]: On master: Close
[0m21:53:29.558887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:53:29.559945 [info ] [MainThread]: 
[0m21:53:29.615876 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:53:29.617702 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:53:29.619523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:53:29.620583 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:53:29.630316 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.631796 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:53:29.621224 => 21:53:29.631331
[0m21:53:29.632813 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:53:29.683921 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.685388 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.686315 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:53:29.687227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:29.694057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:53:29.695040 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.696083 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:53:29.700651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:53:29.709529 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.710540 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:53:29.711928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:29.717317 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.718254 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:53:29.719570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:29.743180 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:53:29.744194 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.745111 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:53:29.746765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:53:29.757705 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:53:29.765030 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:53:29.766000 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:53:29.768781 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:53:29.772170 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:53:29.633481 => 21:53:29.771607
[0m21:53:29.773350 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:53:29.774997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aadc7f0>]}
[0m21:53:29.776496 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:53:29.778114 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:53:29.779405 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:53:29.780726 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:53:29.782131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:53:29.783101 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:53:29.786576 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.788644 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:53:29.783805 => 21:53:29.788082
[0m21:53:29.789967 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:53:29.797989 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.799453 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.800629 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:53:29.801688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:29.810765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:53:29.812248 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.813325 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:53:29.817042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:53:29.823688 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.824820 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:53:29.826230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:29.831670 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.832640 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:53:29.833999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:29.839319 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:53:29.840375 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.841304 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:53:29.843571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:53:29.849601 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:53:29.851734 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:53:29.853152 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:53:29.856409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:53:29.858939 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:53:29.790689 => 21:53:29.858498
[0m21:53:29.860253 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:53:29.862132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ce860>]}
[0m21:53:29.863507 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.08s]
[0m21:53:29.864886 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:53:29.866203 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:53:29.867230 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:53:29.869184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:53:29.870903 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:53:29.875115 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:53:29.877323 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:53:29.871543 => 21:53:29.876102
[0m21:53:29.878525 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:53:29.920641 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:53:29.922242 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:53:29.923307 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:53:29.924453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:29.931563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:53:29.933268 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:53:29.934909 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:53:29.946568 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:53:29.951974 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:53:29.952967 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:53:29.954284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:29.959414 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:53:29.960376 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:53:29.961799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:29.970075 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:53:29.971047 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:53:29.972057 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:53:29.973561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:53:29.978035 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:53:29.982676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:53:29.983690 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:53:29.987066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:29.989510 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:53:29.879137 => 21:53:29.989078
[0m21:53:29.990437 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:53:29.991844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ccf10>]}
[0m21:53:29.993112 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.12s]
[0m21:53:29.994362 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:53:29.995414 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:53:29.996448 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:53:29.998082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:53:29.999666 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:53:30.003032 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.004559 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:53:30.000496 => 21:53:30.004082
[0m21:53:30.005486 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:53:30.012636 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.013979 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.014878 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:53:30.016339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:30.026482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:53:30.027517 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.028659 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:53:30.034390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:53:30.040664 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.042210 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:53:30.043928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:30.050477 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.051458 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:53:30.053046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:30.057015 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:53:30.057972 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.058855 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:53:30.060940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:53:30.067853 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:53:30.069974 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:53:30.071395 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:53:30.074220 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:53:30.077051 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:53:30.006064 => 21:53:30.076612
[0m21:53:30.077985 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:53:30.079570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab72c20>]}
[0m21:53:30.081440 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:53:30.082857 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:53:30.084438 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:53:30.085465 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:53:30.086909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:53:30.089271 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:53:30.093679 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:53:30.095414 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:53:30.089907 => 21:53:30.094667
[0m21:53:30.097002 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:53:30.107610 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:53:30.109057 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:53:30.110674 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:53:30.112114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:30.121008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:53:30.122361 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:53:30.123331 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo,
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productcategoryname
ORDER BY ProductSalesNo DESC
  );
[0m21:53:30.130529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:53:30.137786 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:53:30.138835 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp" rename to "dbt_sales"
[0m21:53:30.140330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:30.145181 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:53:30.146461 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:53:30.147405 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:53:30.149115 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:53:30.154385 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup"
[0m21:53:30.156766 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:53:30.157709 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup" cascade
[0m21:53:30.158994 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:53:30.161627 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:53:30.097732 => 21:53:30.160974
[0m21:53:30.162869 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:53:30.164352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b16b9af-0d8c-4b7c-a96e-b789dc72abe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90ba90>]}
[0m21:53:30.165662 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_schema.dbt_sales .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:53:30.166964 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:53:30.169223 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:30.170447 [debug] [MainThread]: On master: BEGIN
[0m21:53:30.171412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:53:30.178676 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:53:30.179760 [debug] [MainThread]: On master: COMMIT
[0m21:53:30.180619 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:30.181457 [debug] [MainThread]: On master: COMMIT
[0m21:53:30.182444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:53:30.183298 [debug] [MainThread]: On master: Close
[0m21:53:30.184783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:30.186821 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:53:30.187966 [info ] [MainThread]: 
[0m21:53:30.189071 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m21:53:30.192919 [debug] [MainThread]: Command end result
[0m21:53:30.206588 [info ] [MainThread]: 
[0m21:53:30.208238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:53:30.209286 [info ] [MainThread]: 
[0m21:53:30.210718 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:53:30.214063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6205786, "process_user_time": 4.227665, "process_kernel_time": 0.334724, "process_mem_max_rss": "111570944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:53:30.215863 [debug] [MainThread]: Command `dbt run` succeeded at 21:53:30.215514 after 1.62 seconds
[0m21:53:30.216877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ceb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6cf70>]}
[0m21:53:30.218030 [debug] [MainThread]: Flushing usage events
[0m21:54:05.985203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be05b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e39e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e39e500>]}


============================== 21:54:05.990583 | e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d ==============================
[0m21:54:05.990583 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:54:05.991768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:06.275165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e39e770>]}
[0m21:54:06.405440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6f5060>]}
[0m21:54:06.406902 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:54:06.431654 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:54:06.485986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:06.487190 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:54:06.690098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:54:06.698498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b00d0>]}
[0m21:54:06.716259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1bca0>]}
[0m21:54:06.717353 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:54:06.719326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1bd60>]}
[0m21:54:06.721988 [info ] [MainThread]: 
[0m21:54:06.724976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:06.730072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:54:06.749819 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:54:06.751031 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:54:06.752240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:06.789406 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:54:06.792403 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:54:06.794995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:54:06.804220 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:54:06.805130 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:54:06.806086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:06.812661 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:54:06.813563 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:54:06.814418 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:54:06.820914 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:54:06.823163 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:54:06.824270 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:54:06.832952 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:06.833851 [debug] [MainThread]: On master: BEGIN
[0m21:54:06.834653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:06.840672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:06.841574 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:06.842491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:06.892568 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:54:06.895470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b68f0>]}
[0m21:54:06.896422 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:06.897425 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:06.898274 [debug] [MainThread]: On master: BEGIN
[0m21:54:06.899331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:06.900185 [debug] [MainThread]: On master: COMMIT
[0m21:54:06.901009 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:06.901819 [debug] [MainThread]: On master: COMMIT
[0m21:54:06.902743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:06.903572 [debug] [MainThread]: On master: Close
[0m21:54:06.904841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:54:06.905862 [info ] [MainThread]: 
[0m21:54:06.961985 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:54:06.963356 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:54:06.964794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:54:06.965825 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:54:06.975282 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:54:06.979576 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:54:06.966459 => 21:54:06.978853
[0m21:54:06.980575 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:54:07.031045 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.032463 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.033368 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:54:07.034230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:07.041140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:07.042104 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.043069 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:54:07.047659 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:07.056573 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.057557 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:54:07.058948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.063935 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.064875 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:54:07.066199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.088588 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:54:07.089622 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.090513 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:54:07.092735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:07.103514 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:54:07.110345 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:07.111322 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:54:07.113882 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:07.116429 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:54:06.981167 => 21:54:07.115989
[0m21:54:07.117351 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:54:07.118720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e84fcd0>]}
[0m21:54:07.120035 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.15s]
[0m21:54:07.121336 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:54:07.122488 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:07.123673 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:54:07.124990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:54:07.125919 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:07.129299 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.130869 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:54:07.126603 => 21:54:07.130389
[0m21:54:07.131829 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:07.139196 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.140838 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.142050 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:54:07.143170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:07.150694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:07.151670 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.152571 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:54:07.156370 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:07.162133 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.163080 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:54:07.164802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.170002 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.170976 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:54:07.172745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.176796 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:54:07.177755 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.178688 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:54:07.180439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:07.185843 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:54:07.187973 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:07.188893 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:54:07.192119 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:07.194972 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:54:07.132431 => 21:54:07.194466
[0m21:54:07.196029 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:54:07.197806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1a0e0>]}
[0m21:54:07.199306 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.07s]
[0m21:54:07.200893 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:07.201924 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:54:07.202938 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:54:07.204403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:54:07.205672 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:54:07.209746 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:54:07.211205 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:54:07.206361 => 21:54:07.210727
[0m21:54:07.212176 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:54:07.247267 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:54:07.248698 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:07.249753 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:54:07.250698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:07.258666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:07.259694 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:07.260648 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:54:07.271556 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:54:07.277025 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:07.278379 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:54:07.280174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.285443 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:07.286414 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:54:07.288358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.297046 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:54:07.298046 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:07.299059 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:54:07.300579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:07.305612 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:54:07.310199 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:07.311233 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:54:07.315177 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:54:07.317616 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:54:07.212777 => 21:54:07.317180
[0m21:54:07.318542 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:54:07.320177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef19c30>]}
[0m21:54:07.321486 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.12s]
[0m21:54:07.322857 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:54:07.323842 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:54:07.324912 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:54:07.326532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:54:07.328226 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:54:07.331353 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.332793 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:54:07.328995 => 21:54:07.332331
[0m21:54:07.333703 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:54:07.341149 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.343441 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.345556 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:54:07.347543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:07.355025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:07.356337 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.357783 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:54:07.363478 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:07.369080 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.370649 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:54:07.372400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.378717 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.379689 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:54:07.381355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.385410 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:54:07.386380 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.387262 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:54:07.389268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:07.396818 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:54:07.398940 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:07.399855 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:54:07.402821 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:07.405977 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:54:07.334273 => 21:54:07.405465
[0m21:54:07.407057 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:54:07.408840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f00c3d0>]}
[0m21:54:07.410687 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:54:07.411959 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:54:07.413286 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:54:07.414281 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:54:07.415576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:54:07.416794 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:54:07.421803 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:54:07.423871 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:54:07.417924 => 21:54:07.422859
[0m21:54:07.425923 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:54:07.435624 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:54:07.437192 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:07.438148 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:54:07.439299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:07.450420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:07.452183 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:07.453750 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo,
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productcategoryname
ORDER BY Total DESC
  );
[0m21:54:07.462888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:07.469885 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:07.470861 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp" rename to "dbt_sales"
[0m21:54:07.473046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:07.477383 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:54:07.478424 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:07.479312 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:54:07.480897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:07.486683 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup"
[0m21:54:07.489351 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:07.491311 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup" cascade
[0m21:54:07.492802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:07.495554 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:54:07.426887 => 21:54:07.495115
[0m21:54:07.496490 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:54:07.498011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c6ac2d-25f2-48fc-9bcd-0efbc28f9d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef50160>]}
[0m21:54:07.499770 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_schema.dbt_sales .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:54:07.501052 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:54:07.502991 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:07.503893 [debug] [MainThread]: On master: BEGIN
[0m21:54:07.504721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:07.512782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:07.513714 [debug] [MainThread]: On master: COMMIT
[0m21:54:07.514990 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:07.516186 [debug] [MainThread]: On master: COMMIT
[0m21:54:07.517253 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:07.518118 [debug] [MainThread]: On master: Close
[0m21:54:07.519396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:07.520328 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:54:07.521228 [info ] [MainThread]: 
[0m21:54:07.522459 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m21:54:07.525264 [debug] [MainThread]: Command end result
[0m21:54:07.538092 [info ] [MainThread]: 
[0m21:54:07.539509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:54:07.540845 [info ] [MainThread]: 
[0m21:54:07.542877 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:54:07.545908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6352072, "process_user_time": 4.091701, "process_kernel_time": 0.321484, "process_mem_max_rss": "111480832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:54:07.548543 [debug] [MainThread]: Command `dbt run` succeeded at 21:54:07.547824 after 1.64 seconds
[0m21:54:07.550256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be05b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b3c70>]}
[0m21:54:07.552288 [debug] [MainThread]: Flushing usage events
[0m21:54:52.276779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3173d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b6470>]}


============================== 21:54:52.282119 | 882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc ==============================
[0m21:54:52.282119 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:54:52.283349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:54:52.561424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b66e0>]}
[0m21:54:52.683196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec0f4c0>]}
[0m21:54:52.684704 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:54:52.705072 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:54:52.766788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:52.768115 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/dbt_sales.sql
[0m21:54:52.956030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:54:52.965338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c80d0>]}
[0m21:54:52.978563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f433c10>]}
[0m21:54:52.979696 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:54:52.982487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f433cd0>]}
[0m21:54:52.985872 [info ] [MainThread]: 
[0m21:54:52.989226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:52.992399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m21:54:53.013312 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m21:54:53.014742 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:54:53.015629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:53.058471 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:54:53.060980 [debug] [ThreadPool]: On list_psql_contosodb: Close
[0m21:54:53.064195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_psql_contosodb, now list_psql_contosodb_dbt_schema)
[0m21:54:53.073594 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:54:53.074528 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: BEGIN
[0m21:54:53.075453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:53.082021 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.082924 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb_dbt_schema"
[0m21:54:53.083780 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb_dbt_schema"} */
select
      'psql_contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'psql_contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:54:53.090079 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:54:53.092568 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: ROLLBACK
[0m21:54:53.094109 [debug] [ThreadPool]: On list_psql_contosodb_dbt_schema: Close
[0m21:54:53.104471 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:53.105807 [debug] [MainThread]: On master: BEGIN
[0m21:54:53.107120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:53.113851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.114898 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:53.115904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:53.186465 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m21:54:53.191176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5d6950>]}
[0m21:54:53.192464 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:53.193521 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:53.194377 [debug] [MainThread]: On master: BEGIN
[0m21:54:53.195422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.196264 [debug] [MainThread]: On master: COMMIT
[0m21:54:53.197096 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:53.197921 [debug] [MainThread]: On master: COMMIT
[0m21:54:53.198978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.199929 [debug] [MainThread]: On master: Close
[0m21:54:53.201245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:54:53.202330 [info ] [MainThread]: 
[0m21:54:53.260531 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m21:54:53.261854 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m21:54:53.263671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_psql_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m21:54:53.264921 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m21:54:53.274745 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.276525 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 21:54:53.265848 => 21:54:53.275982
[0m21:54:53.278076 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m21:54:53.334423 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.335985 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.336936 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m21:54:53.338017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:53.344750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.345857 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.346924 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m21:54:53.350837 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:53.359698 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.360701 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg" rename to "dbt_channel_stg__dbt_backup"
[0m21:54:53.362094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.367067 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.367993 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp" rename to "dbt_channel_stg"
[0m21:54:53.369347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.392171 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:54:53.393226 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.394147 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: COMMIT
[0m21:54:53.395923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.406287 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup"
[0m21:54:53.413083 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m21:54:53.414054 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_channel_stg__dbt_backup" cascade
[0m21:54:53.416458 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:53.419024 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 21:54:53.279318 => 21:54:53.418582
[0m21:54:53.419964 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m21:54:53.421343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f642890>]}
[0m21:54:53.422670 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.dbt_channel_stg .................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:54:53.424050 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m21:54:53.425069 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:53.426080 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m21:54:53.427412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m21:54:53.428511 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:53.431526 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.433106 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 21:54:53.429276 => 21:54:53.432474
[0m21:54:53.434350 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:53.442263 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.443842 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.444839 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m21:54:53.446427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:53.453227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.454207 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.455216 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m21:54:53.459900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:53.465604 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.466588 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" rename to "dbt_factonlinesales_stg__dbt_backup"
[0m21:54:53.468432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.473391 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.474348 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp" rename to "dbt_factonlinesales_stg"
[0m21:54:53.475970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.480639 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:54:53.481616 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.482508 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: COMMIT
[0m21:54:53.484537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.489198 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup"
[0m21:54:53.491352 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m21:54:53.492539 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_backup" cascade
[0m21:54:53.495658 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:53.498248 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 21:54:53.435158 => 21:54:53.497803
[0m21:54:53.499193 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m21:54:53.501016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f614040>]}
[0m21:54:53.502402 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.dbt_factonlinesales_stg ............ [[32mCREATE VIEW[0m in 0.07s]
[0m21:54:53.503707 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m21:54:53.504711 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m21:54:53.505773 [info ] [Thread-1 (]: 3 of 5 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m21:54:53.507210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m21:54:53.508660 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m21:54:53.513061 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m21:54:53.514647 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 21:54:53.509665 => 21:54:53.514150
[0m21:54:53.515638 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m21:54:53.553527 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m21:54:53.555182 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:53.556164 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m21:54:53.557670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:53.565276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.567098 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:53.568167 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m21:54:53.579547 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.0 seconds
[0m21:54:53.585194 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:53.586184 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales" rename to "dbt_factsales__dbt_backup"
[0m21:54:53.587874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.593464 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:53.594420 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_tmp" rename to "dbt_factsales"
[0m21:54:53.595881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.604744 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:54:53.605907 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:53.607171 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: COMMIT
[0m21:54:53.608728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.613431 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup"
[0m21:54:53.618872 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m21:54:53.619872 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */
drop table if exists "psql_contosodb"."dbt_schema"."dbt_factsales__dbt_backup" cascade
[0m21:54:53.623515 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:54:53.625970 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 21:54:53.516279 => 21:54:53.625535
[0m21:54:53.626911 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m21:54:53.628295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec2c1c0>]}
[0m21:54:53.629591 [info ] [Thread-1 (]: 3 of 5 OK created sql table model dbt_schema.dbt_factsales ..................... [[32mSELECT 103[0m in 0.12s]
[0m21:54:53.631283 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m21:54:53.632353 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m21:54:53.633510 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m21:54:53.635027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m21:54:53.635978 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m21:54:53.639318 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.641846 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 21:54:53.636721 => 21:54:53.641190
[0m21:54:53.642853 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m21:54:53.652873 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.654883 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.656480 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m21:54:53.657676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:53.665980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.667142 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.668230 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m21:54:53.673683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:53.681910 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.683165 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg" rename to "dbt_product_stg__dbt_backup"
[0m21:54:53.684853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.690689 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.691941 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
alter table "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp" rename to "dbt_product_stg"
[0m21:54:53.693776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.698816 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:54:53.699822 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.700725 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: COMMIT
[0m21:54:53.703087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.710617 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup"
[0m21:54:53.713380 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m21:54:53.714554 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_product_stg__dbt_backup" cascade
[0m21:54:53.717275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:53.720134 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 21:54:53.643524 => 21:54:53.719443
[0m21:54:53.721398 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m21:54:53.722868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6deb60>]}
[0m21:54:53.724304 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.dbt_product_stg .................... [[32mCREATE VIEW[0m in 0.09s]
[0m21:54:53.725634 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m21:54:53.726994 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m21:54:53.728304 [info ] [Thread-1 (]: 5 of 5 START sql view model dbt_schema.dbt_sales ............................... [RUN]
[0m21:54:53.729980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.dbt_sales)
[0m21:54:53.731105 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_sales
[0m21:54:53.736843 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_sales"
[0m21:54:53.739067 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (compile): 21:54:53.731793 => 21:54:53.738250
[0m21:54:53.740148 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_sales
[0m21:54:53.751939 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_sales"
[0m21:54:53.754030 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:53.755082 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: BEGIN
[0m21:54:53.756011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:53.765734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.766811 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:53.767756 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */

  create view "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp"
    
    
  as (
    SELECT
p.productname,
p.productcategoryname,
COUNT(f.productkey) AS ProductSalesNo,
SUM(f.salesamount * f.salesquantity) AS Total
FROM "psql_contosodb"."dbt_schema"."dbt_factonlinesales_stg" f
JOIN
"psql_contosodb"."dbt_schema"."dbt_product_stg" p
ON f.productkey = p.productkey
GROUP BY
p.productname,
p.productcategoryname
ORDER BY ProductSalesNo DESC
  );
[0m21:54:53.773938 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:54:53.782126 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:53.783171 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
alter table "psql_contosodb"."dbt_schema"."dbt_sales__dbt_tmp" rename to "dbt_sales"
[0m21:54:53.784908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:54:53.788580 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:54:53.789539 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:53.790476 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: COMMIT
[0m21:54:53.792515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.798379 [debug] [Thread-1 (]: Applying DROP to: "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup"
[0m21:54:53.800552 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_sales"
[0m21:54:53.802231 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_sales"} */
drop view if exists "psql_contosodb"."dbt_schema"."dbt_sales__dbt_backup" cascade
[0m21:54:53.803539 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:54:53.806005 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_sales (execute): 21:54:53.740779 => 21:54:53.805530
[0m21:54:53.807096 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_sales: Close
[0m21:54:53.808660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882c9fc3-5ac8-4ac3-a6fe-ee14934c17bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f46fcd0>]}
[0m21:54:53.810404 [info ] [Thread-1 (]: 5 of 5 OK created sql view model dbt_schema.dbt_sales .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:54:53.811845 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m21:54:53.813864 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:53.814750 [debug] [MainThread]: On master: BEGIN
[0m21:54:53.815590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:53.822949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:53.823957 [debug] [MainThread]: On master: COMMIT
[0m21:54:53.824891 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:53.826756 [debug] [MainThread]: On master: COMMIT
[0m21:54:53.828512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:53.830286 [debug] [MainThread]: On master: Close
[0m21:54:53.832444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:53.833562 [debug] [MainThread]: Connection 'model.postgres_dbt.dbt_sales' was properly closed.
[0m21:54:53.834928 [info ] [MainThread]: 
[0m21:54:53.835969 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m21:54:53.838112 [debug] [MainThread]: Command end result
[0m21:54:53.852580 [info ] [MainThread]: 
[0m21:54:53.853638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:54:53.854565 [info ] [MainThread]: 
[0m21:54:53.855602 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:54:53.870376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6682081, "process_user_time": 3.986847, "process_kernel_time": 0.306209, "process_mem_max_rss": "111607808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:54:53.872062 [debug] [MainThread]: Command `dbt run` succeeded at 21:54:53.871714 after 1.67 seconds
[0m21:54:53.873044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3173d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4329e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5d58a0>]}
[0m21:54:53.878849 [debug] [MainThread]: Flushing usage events
[0m16:33:28.123003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3a4a0>]}


============================== 16:33:28.137130 | 4f9ec8d0-35c3-41d2-b0d0-ca656720309f ==============================
[0m16:33:28.137130 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:33:28.140032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:33:29.655144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f9ec8d0-35c3-41d2-b0d0-ca656720309f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3a710>]}
[0m16:33:29.786877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f9ec8d0-35c3-41d2-b0d0-ca656720309f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dfe470>]}
[0m16:33:29.788668 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:33:29.856678 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:33:29.997525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:29.998490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:29.999946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m16:33:30.011062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f9ec8d0-35c3-41d2-b0d0-ca656720309f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f0f10>]}
[0m16:33:30.040268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f9ec8d0-35c3-41d2-b0d0-ca656720309f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b7be0>]}
[0m16:33:30.041700 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:33:30.043169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f9ec8d0-35c3-41d2-b0d0-ca656720309f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b4790>]}
[0m16:33:30.045830 [info ] [MainThread]: 
[0m16:33:30.047596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:33:30.055446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_psql_contosodb'
[0m16:33:30.073009 [debug] [ThreadPool]: Using postgres connection "list_psql_contosodb"
[0m16:33:30.074001 [debug] [ThreadPool]: On list_psql_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m16:33:30.074857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:30.085753 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:33:30.087776 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_psql_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m16:33:30.088789 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:33:30.089799 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:33:30.090789 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:33:30.092082 [debug] [ThreadPool]: On list_psql_contosodb: No close available on handle
[0m16:33:30.094599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:30.096069 [debug] [MainThread]: Connection 'list_psql_contosodb' was properly closed.
[0m16:33:30.097699 [info ] [MainThread]: 
[0m16:33:30.099526 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m16:33:30.101744 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m16:33:30.154071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1319265, "process_user_time": 3.857973, "process_kernel_time": 0.61422, "process_mem_max_rss": "102952960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:33:30.155795 [debug] [MainThread]: Command `dbt run` failed at 16:33:30.155197 after 2.13 seconds
[0m16:33:30.157261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a3a110>]}
[0m16:33:30.158430 [debug] [MainThread]: Flushing usage events
[0m16:21:21.533120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127626b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112762350>]}


============================== 16:21:21.542229 | 5f41dbfc-a35a-4331-8bd6-83bf88a39df9 ==============================
[0m16:21:21.542229 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:21:21.543664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:21.545101 [info ] [MainThread]: dbt version: 1.7.6
[0m16:21:21.546164 [info ] [MainThread]: python version: 3.10.0
[0m16:21:21.547205 [info ] [MainThread]: python path: /Users/mariocukovic/.pyenv/versions/3.10.0/bin/python
[0m16:21:21.548486 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m16:21:22.139703 [info ] [MainThread]: Using profiles dir at /Users/mariocukovic/.dbt
[0m16:21:22.140703 [info ] [MainThread]: Using profiles.yml file at /Users/mariocukovic/.dbt/profiles.yml
[0m16:21:22.142038 [info ] [MainThread]: Using dbt_project.yml file at /Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/dbt_project.yml
[0m16:21:22.143910 [info ] [MainThread]: adapter type: postgres
[0m16:21:22.145023 [info ] [MainThread]: adapter version: 1.7.6
[0m16:21:22.269706 [info ] [MainThread]: Configuration:
[0m16:21:22.270755 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:21:22.272442 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:21:22.273530 [info ] [MainThread]: Required dependencies:
[0m16:21:22.274597 [debug] [MainThread]: Executing "git --help"
[0m16:21:22.292037 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:21:22.293779 [debug] [MainThread]: STDERR: "b''"
[0m16:21:22.294745 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:21:22.296052 [info ] [MainThread]: Connection:
[0m16:21:22.297526 [info ] [MainThread]:   host: localhost
[0m16:21:22.299198 [info ] [MainThread]:   port: 5432
[0m16:21:22.300138 [info ] [MainThread]:   user: postgres
[0m16:21:22.301104 [info ] [MainThread]:   database: contosodb
[0m16:21:22.302810 [info ] [MainThread]:   schema: dbt_schema
[0m16:21:22.303986 [info ] [MainThread]:   connect_timeout: 10
[0m16:21:22.305795 [info ] [MainThread]:   role: None
[0m16:21:22.306784 [info ] [MainThread]:   search_path: None
[0m16:21:22.307649 [info ] [MainThread]:   keepalives_idle: 0
[0m16:21:22.309332 [info ] [MainThread]:   sslmode: None
[0m16:21:22.310577 [info ] [MainThread]:   sslcert: None
[0m16:21:22.312447 [info ] [MainThread]:   sslkey: None
[0m16:21:22.315255 [info ] [MainThread]:   sslrootcert: None
[0m16:21:22.316406 [info ] [MainThread]:   application_name: dbt
[0m16:21:22.317341 [info ] [MainThread]:   retries: 1
[0m16:21:22.318559 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:21:22.363671 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:21:22.365434 [debug] [MainThread]: Using postgres connection "debug"
[0m16:21:22.366379 [debug] [MainThread]: On debug: select 1 as id
[0m16:21:22.367255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:22.491066 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:21:22.494001 [debug] [MainThread]: On debug: Close
[0m16:21:22.495358 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:21:22.496723 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:21:22.536185 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1130543, "process_user_time": 3.610886, "process_kernel_time": 0.801213, "process_mem_max_rss": "99500032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:21:22.537685 [debug] [MainThread]: Command `dbt debug` succeeded at 16:21:22.537341 after 1.11 seconds
[0m16:21:22.538599 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:21:22.539658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b1b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112761960>]}
[0m16:21:22.541792 [debug] [MainThread]: Flushing usage events
[0m16:49:16.220135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b633d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a24d0>]}


============================== 16:49:16.225511 | 7cec900c-30b0-490e-a42f-13ed20e75029 ==============================
[0m16:49:16.225511 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:49:16.226708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:16.637001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a2740>]}
[0m16:49:16.760252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b065ff0>]}
[0m16:49:16.761653 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:49:16.784487 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:49:16.810065 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:49:16.811156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b45eef0>]}
[0m16:49:18.135924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m16:49:18.144753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd82380>]}
[0m16:49:18.162488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd82a40>]}
[0m16:49:18.163868 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:49:18.164840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd83fa0>]}
[0m16:49:18.167487 [info ] [MainThread]: 
[0m16:49:18.169339 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:18.173078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m16:49:18.195301 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m16:49:18.196288 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m16:49:18.197357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:18.245415 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:49:18.248022 [debug] [ThreadPool]: On list_contosodb: Close
[0m16:49:18.250880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now create_contosodb_dbt_schema)
[0m16:49:18.252555 [debug] [ThreadPool]: Creating schema "database: "contosodb"
schema: "dbt_schema"
"
[0m16:49:18.261262 [debug] [ThreadPool]: Using postgres connection "create_contosodb_dbt_schema"
[0m16:49:18.262179 [debug] [ThreadPool]: On create_contosodb_dbt_schema: BEGIN
[0m16:49:18.262990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:18.270442 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.271541 [debug] [ThreadPool]: Using postgres connection "create_contosodb_dbt_schema"
[0m16:49:18.272488 [debug] [ThreadPool]: On create_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "create_contosodb_dbt_schema"} */
create schema if not exists "dbt_schema"
[0m16:49:18.280277 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:49:18.282136 [debug] [ThreadPool]: On create_contosodb_dbt_schema: COMMIT
[0m16:49:18.283126 [debug] [ThreadPool]: Using postgres connection "create_contosodb_dbt_schema"
[0m16:49:18.284072 [debug] [ThreadPool]: On create_contosodb_dbt_schema: COMMIT
[0m16:49:18.285606 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:49:18.286606 [debug] [ThreadPool]: On create_contosodb_dbt_schema: Close
[0m16:49:18.289550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_contosodb_dbt_schema, now list_contosodb_dbt_schema)
[0m16:49:18.297647 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:49:18.298544 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m16:49:18.299441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:18.305760 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.306651 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:49:18.307494 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m16:49:18.324769 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:18.327165 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m16:49:18.328284 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m16:49:18.335355 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.336246 [debug] [MainThread]: On master: BEGIN
[0m16:49:18.337053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:18.343092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.343980 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.344889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:18.378711 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:49:18.380656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbbd30>]}
[0m16:49:18.381672 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:18.382705 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.383543 [debug] [MainThread]: On master: BEGIN
[0m16:49:18.384586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.385421 [debug] [MainThread]: On master: COMMIT
[0m16:49:18.386259 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.387076 [debug] [MainThread]: On master: COMMIT
[0m16:49:18.388005 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:18.388840 [debug] [MainThread]: On master: Close
[0m16:49:18.390205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:18.391423 [info ] [MainThread]: 
[0m16:49:18.395670 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m16:49:18.396949 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m16:49:18.398853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m16:49:18.400106 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m16:49:18.412347 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m16:49:18.414732 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 16:49:18.400883 => 16:49:18.414084
[0m16:49:18.415773 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m16:49:18.468373 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m16:49:18.469918 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:49:18.470857 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m16:49:18.471742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:18.478086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.479049 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:49:18.479947 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m16:49:18.482369 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m16:49:18.483436 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m16:49:18.484917 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 16:49:18.416384 => 16:49:18.484453
[0m16:49:18.485839 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m16:49:18.532251 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:49:18.534157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd62f0>]}
[0m16:49:18.535937 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.14s]
[0m16:49:18.537794 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m16:49:18.539202 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:49:18.540855 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m16:49:18.542510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m16:49:18.543876 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:49:18.547814 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:49:18.549626 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 16:49:18.544688 => 16:49:18.549022
[0m16:49:18.550861 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:49:18.563609 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:49:18.566452 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:49:18.567973 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m16:49:18.568923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:18.576329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.577368 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:49:18.578295 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m16:49:18.579753 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m16:49:18.580689 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m16:49:18.582901 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 16:49:18.551831 => 16:49:18.581836
[0m16:49:18.584873 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m16:49:18.587407 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:49:18.588581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be422c0>]}
[0m16:49:18.589751 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.05s]
[0m16:49:18.591058 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:49:18.592055 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m16:49:18.593064 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m16:49:18.594405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m16:49:18.595335 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m16:49:18.599938 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m16:49:18.603771 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 16:49:18.595923 => 16:49:18.601891
[0m16:49:18.605766 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m16:49:18.641091 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m16:49:18.643201 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:49:18.644391 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m16:49:18.645271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:18.651826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.652788 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:49:18.653819 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m16:49:18.655375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m16:49:18.656320 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m16:49:18.657677 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 16:49:18.606390 => 16:49:18.657230
[0m16:49:18.658580 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m16:49:18.660611 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:49:18.661794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be417e0>]}
[0m16:49:18.662971 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.07s]
[0m16:49:18.664591 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m16:49:18.665600 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m16:49:18.666604 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m16:49:18.668072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m16:49:18.670464 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m16:49:18.673398 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m16:49:18.674855 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 16:49:18.671127 => 16:49:18.674311
[0m16:49:18.675978 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m16:49:18.682993 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m16:49:18.684352 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:49:18.686608 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m16:49:18.688307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:18.694709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.695663 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:49:18.696554 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m16:49:18.697925 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m16:49:18.699373 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m16:49:18.701508 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 16:49:18.676575 => 16:49:18.700997
[0m16:49:18.702589 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m16:49:18.705147 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:49:18.706205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be41c90>]}
[0m16:49:18.707355 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m16:49:18.708812 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m16:49:18.709799 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m16:49:18.710792 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m16:49:18.712361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__products)
[0m16:49:18.713434 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m16:49:18.718211 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m16:49:18.720290 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 16:49:18.715748 => 16:49:18.719361
[0m16:49:18.721315 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m16:49:18.728575 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m16:49:18.730111 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:49:18.731208 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m16:49:18.732185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:18.741727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.743305 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:49:18.745006 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.products
  );
[0m16:49:18.747035 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.products" does not exist
LINE 7:     select * from public.products
                          ^

[0m16:49:18.749054 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: ROLLBACK
[0m16:49:18.751714 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 16:49:18.721905 => 16:49:18.751054
[0m16:49:18.752928 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m16:49:18.755435 [debug] [Thread-1 (]: Database Error in model stg_contoso__products (models/staging/stg_contoso__products.sql)
  relation "public.products" does not exist
  LINE 7:     select * from public.products
                            ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__products.sql
[0m16:49:18.756812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf16410>]}
[0m16:49:18.758988 [error] [Thread-1 (]: 5 of 7 ERROR creating sql view model dbt_schema.stg_contoso__products .......... [[31mERROR[0m in 0.04s]
[0m16:49:18.760683 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m16:49:18.761863 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m16:49:18.763509 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m16:49:18.764878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m16:49:18.765818 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m16:49:18.770173 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m16:49:18.772589 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 16:49:18.766434 => 16:49:18.771914
[0m16:49:18.774530 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m16:49:18.781965 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m16:49:18.783869 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:49:18.786026 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m16:49:18.787558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:18.800956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.802865 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:49:18.804985 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT * FROM public.factsales
  );
[0m16:49:18.807422 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factsales" does not exist
LINE 7:     SELECT * FROM public.factsales
                          ^

[0m16:49:18.809205 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: ROLLBACK
[0m16:49:18.811586 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 16:49:18.775291 => 16:49:18.810815
[0m16:49:18.812879 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m16:49:18.816283 [debug] [Thread-1 (]: Database Error in model stg_contoso__sales (models/staging/stg_contoso__sales.sql)
  relation "public.factsales" does not exist
  LINE 7:     SELECT * FROM public.factsales
                            ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__sales.sql
[0m16:49:18.817564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cec900c-30b0-490e-a42f-13ed20e75029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd83010>]}
[0m16:49:18.819676 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model dbt_schema.stg_contoso__sales ............. [[31mERROR[0m in 0.05s]
[0m16:49:18.821847 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m16:49:18.823250 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m16:49:18.825725 [info ] [Thread-1 (]: 7 of 7 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m16:49:18.827496 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m16:49:18.833066 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.834679 [debug] [MainThread]: On master: BEGIN
[0m16:49:18.835634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:18.847693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:49:18.849414 [debug] [MainThread]: On master: COMMIT
[0m16:49:18.850997 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.852425 [debug] [MainThread]: On master: COMMIT
[0m16:49:18.853815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:18.856037 [debug] [MainThread]: On master: Close
[0m16:49:18.858592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:18.860159 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m16:49:18.861911 [info ] [MainThread]: 
[0m16:49:18.863211 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m16:49:18.865984 [debug] [MainThread]: Command end result
[0m16:49:18.881763 [info ] [MainThread]: 
[0m16:49:18.883352 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m16:49:18.886472 [info ] [MainThread]: 
[0m16:49:18.889958 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:49:18.891869 [info ] [MainThread]: 
[0m16:49:18.894120 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:49:18.896240 [info ] [MainThread]: 
[0m16:49:18.898972 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:49:18.902889 [info ] [MainThread]: 
[0m16:49:18.904610 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:49:18.907140 [info ] [MainThread]: 
[0m16:49:18.913446 [error] [MainThread]:   Database Error in model stg_contoso__products (models/staging/stg_contoso__products.sql)
  relation "public.products" does not exist
  LINE 7:     select * from public.products
                            ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__products.sql
[0m16:49:18.915820 [info ] [MainThread]: 
[0m16:49:18.917682 [error] [MainThread]:   Database Error in model stg_contoso__sales (models/staging/stg_contoso__sales.sql)
  relation "public.factsales" does not exist
  LINE 7:     SELECT * FROM public.factsales
                            ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__sales.sql
[0m16:49:18.922142 [info ] [MainThread]: 
[0m16:49:18.924373 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=1 TOTAL=7
[0m16:49:18.943989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7996476, "process_user_time": 4.857999, "process_kernel_time": 0.3652, "process_mem_max_rss": "112627712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:18.951219 [debug] [MainThread]: Command `dbt run` failed at 16:49:18.950362 after 2.81 seconds
[0m16:49:18.954652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b633d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4cce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdbb910>]}
[0m16:49:18.956426 [debug] [MainThread]: Flushing usage events
[0m16:50:16.442224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffb1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11254a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11254a530>]}


============================== 16:50:16.447622 | 3d68c939-51de-4d65-8fb8-e4cd4c260bb6 ==============================
[0m16:50:16.447622 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:50:16.448848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:16.706751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11254a7a0>]}
[0m16:50:16.828643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bf3d0>]}
[0m16:50:16.830117 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:50:16.863206 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:50:16.912901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:50:16.914146 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__products.sql
[0m16:50:16.915118 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m16:50:17.102731 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m16:50:17.110325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132540d0>]}
[0m16:50:17.126565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c05b0>]}
[0m16:50:17.127624 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:50:17.128631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c0520>]}
[0m16:50:17.131724 [info ] [MainThread]: 
[0m16:50:17.133573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:50:17.136905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m16:50:17.151802 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m16:50:17.153014 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m16:50:17.154727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:17.193910 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:50:17.196246 [debug] [ThreadPool]: On list_contosodb: Close
[0m16:50:17.199955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m16:50:17.210239 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:50:17.211196 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m16:50:17.211995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:17.218802 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.219719 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:50:17.220587 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m16:50:17.226568 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:50:17.228450 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m16:50:17.229427 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m16:50:17.283099 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:17.284107 [debug] [MainThread]: On master: BEGIN
[0m16:50:17.284995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:17.291372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.292271 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:17.293185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:17.314368 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:50:17.316208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130b3ac0>]}
[0m16:50:17.317179 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:17.318164 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:17.319006 [debug] [MainThread]: On master: BEGIN
[0m16:50:17.320092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.320973 [debug] [MainThread]: On master: COMMIT
[0m16:50:17.321817 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:17.322627 [debug] [MainThread]: On master: COMMIT
[0m16:50:17.323563 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:17.324400 [debug] [MainThread]: On master: Close
[0m16:50:17.325733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:17.326804 [info ] [MainThread]: 
[0m16:50:17.329528 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m16:50:17.330576 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m16:50:17.332090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m16:50:17.333152 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m16:50:17.344259 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m16:50:17.345733 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 16:50:17.333802 => 16:50:17.345243
[0m16:50:17.346700 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m16:50:17.399120 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m16:50:17.400577 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:50:17.401512 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m16:50:17.402578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:17.409365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.410392 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:50:17.411514 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m16:50:17.413035 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m16:50:17.413999 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m16:50:17.415355 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 16:50:17.347288 => 16:50:17.414903
[0m16:50:17.416268 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m16:50:17.420003 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:50:17.421066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f2e00>]}
[0m16:50:17.422224 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m16:50:17.423502 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m16:50:17.424481 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:50:17.425469 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m16:50:17.427264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m16:50:17.428412 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:50:17.431546 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:50:17.433031 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 16:50:17.429019 => 16:50:17.432519
[0m16:50:17.434071 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:50:17.444225 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:50:17.445772 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:50:17.446791 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m16:50:17.448002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:17.456035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.457025 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:50:17.457933 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m16:50:17.459448 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m16:50:17.460421 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m16:50:17.461796 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 16:50:17.434720 => 16:50:17.461338
[0m16:50:17.462714 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m16:50:17.464720 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:50:17.465745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f2770>]}
[0m16:50:17.466891 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.04s]
[0m16:50:17.468244 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:50:17.469863 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m16:50:17.471327 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m16:50:17.472675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m16:50:17.473729 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m16:50:17.479070 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m16:50:17.480495 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 16:50:17.474402 => 16:50:17.480030
[0m16:50:17.481536 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m16:50:17.515623 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m16:50:17.517023 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:50:17.517944 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m16:50:17.519028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:17.525975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.526949 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:50:17.527960 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m16:50:17.529544 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m16:50:17.530516 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m16:50:17.531889 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 16:50:17.482146 => 16:50:17.531434
[0m16:50:17.532803 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m16:50:17.534795 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:50:17.535828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e9f30>]}
[0m16:50:17.536993 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.06s]
[0m16:50:17.538381 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m16:50:17.539714 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m16:50:17.540729 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m16:50:17.542078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m16:50:17.543123 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m16:50:17.546279 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m16:50:17.547813 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 16:50:17.543732 => 16:50:17.547277
[0m16:50:17.549020 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m16:50:17.557555 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m16:50:17.558974 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:50:17.559981 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m16:50:17.560875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:17.567570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.569294 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:50:17.570287 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m16:50:17.572028 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m16:50:17.573151 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m16:50:17.574563 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 16:50:17.549633 => 16:50:17.574108
[0m16:50:17.575458 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m16:50:17.577530 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:50:17.578553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c2110>]}
[0m16:50:17.579711 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m16:50:17.581045 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m16:50:17.582055 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m16:50:17.583062 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m16:50:17.584617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__products)
[0m16:50:17.586209 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m16:50:17.589885 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.591339 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 16:50:17.587054 => 16:50:17.590874
[0m16:50:17.592256 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m16:50:17.599344 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.600876 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.602010 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m16:50:17.603001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:17.610661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.611641 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.612542 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m16:50:17.632621 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:50:17.643686 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.644679 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m16:50:17.647221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:17.668689 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m16:50:17.669675 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.670576 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m16:50:17.672801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:50:17.682510 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m16:50:17.689177 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:50:17.690126 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m16:50:17.691378 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:17.693731 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 16:50:17.593030 => 16:50:17.693304
[0m16:50:17.694642 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m16:50:17.696163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f429b0>]}
[0m16:50:17.697459 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.11s]
[0m16:50:17.698719 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m16:50:17.699696 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m16:50:17.700680 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m16:50:17.701978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m16:50:17.702888 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m16:50:17.706144 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.708048 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 16:50:17.703467 => 16:50:17.707460
[0m16:50:17.709179 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m16:50:17.720650 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.723020 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.724783 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m16:50:17.726167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:17.733607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.734878 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.736223 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT * FROM public.fctsales
  );
[0m16:50:17.741755 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:50:17.747143 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.748079 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m16:50:17.749924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:17.753936 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m16:50:17.755074 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.756746 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m16:50:17.758278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:50:17.762920 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m16:50:17.765003 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:50:17.765906 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m16:50:17.767105 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:50:17.770099 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 16:50:17.709899 => 16:50:17.769664
[0m16:50:17.771043 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m16:50:17.772438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d68c939-51de-4d65-8fb8-e4cd4c260bb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11336b490>]}
[0m16:50:17.773700 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.07s]
[0m16:50:17.775107 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m16:50:17.776092 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m16:50:17.777043 [info ] [Thread-1 (]: 7 of 7 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m16:50:17.778089 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m16:50:17.780878 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:17.781825 [debug] [MainThread]: On master: BEGIN
[0m16:50:17.782676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:17.792423 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:17.794051 [debug] [MainThread]: On master: COMMIT
[0m16:50:17.795611 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:17.797108 [debug] [MainThread]: On master: COMMIT
[0m16:50:17.799506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:17.801425 [debug] [MainThread]: On master: Close
[0m16:50:17.803615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:17.804631 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m16:50:17.805686 [info ] [MainThread]: 
[0m16:50:17.806674 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:50:17.809262 [debug] [MainThread]: Command end result
[0m16:50:17.826921 [info ] [MainThread]: 
[0m16:50:17.828171 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m16:50:17.829184 [info ] [MainThread]: 
[0m16:50:17.830187 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:50:17.831182 [info ] [MainThread]: 
[0m16:50:17.832580 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:50:17.836286 [info ] [MainThread]: 
[0m16:50:17.838119 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:50:17.839791 [info ] [MainThread]: 
[0m16:50:17.843343 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:50:17.845361 [info ] [MainThread]: 
[0m16:50:17.847036 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 TOTAL=7
[0m16:50:17.855225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.485071, "process_user_time": 3.815555, "process_kernel_time": 0.269131, "process_mem_max_rss": "111439872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:17.857846 [debug] [MainThread]: Command `dbt run` failed at 16:50:17.857279 after 1.49 seconds
[0m16:50:17.859259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffb1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113389810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11338a8c0>]}
[0m16:50:17.860415 [debug] [MainThread]: Flushing usage events
[0m16:58:54.860946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c812b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edaa8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edaa560>]}


============================== 16:58:54.866725 | 7b5383ae-9a64-427b-961d-dacc43045339 ==============================
[0m16:58:54.866725 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:58:54.868490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_conotoso__sales', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:55.151703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b5383ae-9a64-427b-961d-dacc43045339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edaa7d0>]}
[0m16:58:55.281075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b5383ae-9a64-427b-961d-dacc43045339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f772b60>]}
[0m16:58:55.282587 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:58:55.305776 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:58:55.364256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:55.365459 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m16:58:55.551764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m16:58:55.559591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b5383ae-9a64-427b-961d-dacc43045339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac40d0>]}
[0m16:58:55.577387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b5383ae-9a64-427b-961d-dacc43045339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9345e0>]}
[0m16:58:55.578770 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:58:55.579738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b5383ae-9a64-427b-961d-dacc43045339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f934550>]}
[0m16:58:55.581052 [warn ] [MainThread]: The selection criterion 'stg_conotoso__sales' does not match any nodes
[0m16:58:55.582778 [info ] [MainThread]: 
[0m16:58:55.584025 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:58:55.585487 [debug] [MainThread]: Command end result
[0m16:58:55.601213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8228973, "process_user_time": 3.417239, "process_kernel_time": 0.283066, "process_mem_max_rss": "105709568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:58:55.602895 [debug] [MainThread]: Command `dbt run` succeeded at 16:58:55.602498 after 0.82 seconds
[0m16:58:55.603946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c812b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f772b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f934760>]}
[0m16:58:55.604888 [debug] [MainThread]: Flushing usage events
[0m16:59:07.385821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf95b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4d6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4d6500>]}


============================== 16:59:07.391282 | d54863de-b4a1-443e-beb0-e5014b3c8351 ==============================
[0m16:59:07.391282 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:59:07.392454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:07.651051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4d6770>]}
[0m16:59:07.772297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c5060>]}
[0m16:59:07.773748 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:59:07.806512 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:59:07.856680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:07.857644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:07.859108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m16:59:07.867985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110091870>]}
[0m16:59:07.884480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110058580>]}
[0m16:59:07.885528 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:59:07.886464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100584f0>]}
[0m16:59:07.889802 [info ] [MainThread]: 
[0m16:59:07.892042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:07.896087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m16:59:07.912866 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m16:59:07.914433 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m16:59:07.915527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:07.950407 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:59:07.952750 [debug] [ThreadPool]: On list_contosodb: Close
[0m16:59:07.955681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m16:59:07.965347 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:59:07.966257 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m16:59:07.967075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:07.973834 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:59:07.974837 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:59:07.975689 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m16:59:07.981648 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:59:07.983594 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m16:59:07.984624 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m16:59:07.991634 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:07.992573 [debug] [MainThread]: On master: BEGIN
[0m16:59:07.993417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:07.999362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.000259 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:08.001182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:08.025038 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:59:08.026913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d6860>]}
[0m16:59:08.027897 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:08.028874 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:08.029692 [debug] [MainThread]: On master: BEGIN
[0m16:59:08.030723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.031579 [debug] [MainThread]: On master: COMMIT
[0m16:59:08.032415 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:08.033238 [debug] [MainThread]: On master: COMMIT
[0m16:59:08.034167 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:08.035011 [debug] [MainThread]: On master: Close
[0m16:59:08.036283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:08.037488 [info ] [MainThread]: 
[0m16:59:08.040366 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m16:59:08.041436 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m16:59:08.042963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m16:59:08.044014 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m16:59:08.054590 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m16:59:08.056057 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 16:59:08.044683 => 16:59:08.055587
[0m16:59:08.056963 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m16:59:08.112543 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m16:59:08.113970 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:59:08.114867 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m16:59:08.115726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:08.122274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.123228 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:59:08.124120 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m16:59:08.125822 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m16:59:08.126803 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m16:59:08.128179 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 16:59:08.060833 => 16:59:08.127731
[0m16:59:08.129091 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m16:59:08.132952 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:59:08.134010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f2290>]}
[0m16:59:08.135167 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m16:59:08.136480 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m16:59:08.137519 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:08.138541 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m16:59:08.139836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m16:59:08.140761 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:08.143951 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:08.145565 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 16:59:08.141347 => 16:59:08.144949
[0m16:59:08.146614 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:08.154081 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:08.155744 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:08.156818 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m16:59:08.158024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:08.165154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.166123 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:08.167036 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m16:59:08.168440 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m16:59:08.169372 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m16:59:08.170829 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 16:59:08.147193 => 16:59:08.170313
[0m16:59:08.171828 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m16:59:08.174568 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:59:08.176499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f2740>]}
[0m16:59:08.178377 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.04s]
[0m16:59:08.180329 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:08.181401 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m16:59:08.182406 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m16:59:08.183801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m16:59:08.184892 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m16:59:08.188912 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m16:59:08.190314 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 16:59:08.185560 => 16:59:08.189853
[0m16:59:08.191338 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m16:59:08.230611 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m16:59:08.232060 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:59:08.233066 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m16:59:08.233964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:08.240510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.241886 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:59:08.242922 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m16:59:08.244419 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m16:59:08.245367 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m16:59:08.246732 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 16:59:08.191999 => 16:59:08.246277
[0m16:59:08.247637 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m16:59:08.249696 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:59:08.250863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f2620>]}
[0m16:59:08.252204 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.07s]
[0m16:59:08.253514 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m16:59:08.254505 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m16:59:08.255608 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m16:59:08.257056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m16:59:08.258022 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m16:59:08.262393 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m16:59:08.264775 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 16:59:08.258619 => 16:59:08.263502
[0m16:59:08.267749 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m16:59:08.325725 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m16:59:08.327383 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:59:08.328479 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m16:59:08.329400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:08.335817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.336770 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:59:08.337740 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m16:59:08.339305 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m16:59:08.340267 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m16:59:08.341608 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 16:59:08.268590 => 16:59:08.341158
[0m16:59:08.342497 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m16:59:08.344523 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:59:08.345531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f7ac0>]}
[0m16:59:08.346649 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.09s]
[0m16:59:08.347868 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m16:59:08.348831 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m16:59:08.349814 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m16:59:08.351093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__products)
[0m16:59:08.352005 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m16:59:08.355067 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.356676 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 16:59:08.352581 => 16:59:08.356072
[0m16:59:08.358842 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m16:59:08.367714 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.369714 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.370688 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m16:59:08.371601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:08.379186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.380369 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.381474 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m16:59:08.385531 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:08.395622 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.396608 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m16:59:08.398002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:08.402958 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.403986 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m16:59:08.405547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:08.430280 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m16:59:08.431266 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.432154 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m16:59:08.433824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:08.442952 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m16:59:08.449583 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:08.450539 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m16:59:08.458226 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:08.461133 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 16:59:08.360156 => 16:59:08.460627
[0m16:59:08.462180 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m16:59:08.463826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b6860>]}
[0m16:59:08.465327 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.11s]
[0m16:59:08.466612 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m16:59:08.467593 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m16:59:08.468593 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m16:59:08.469902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m16:59:08.470819 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m16:59:08.475401 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m16:59:08.477164 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 16:59:08.471406 => 16:59:08.476419
[0m16:59:08.478200 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m16:59:08.491196 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m16:59:08.492874 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:08.494306 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m16:59:08.495449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:08.503303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.504812 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:08.506610 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIX.FCTSALES
  );
[0m16:59:08.509344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "publix.fctsales" does not exist
LINE 20: FROM PUBLIX.FCTSALES
              ^

[0m16:59:08.510704 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: ROLLBACK
[0m16:59:08.513029 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 16:59:08.479118 => 16:59:08.512504
[0m16:59:08.514033 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m16:59:08.516663 [debug] [Thread-1 (]: Database Error in model stg_contoso__sales (models/staging/stg_contoso__sales.sql)
  relation "publix.fctsales" does not exist
  LINE 20: FROM PUBLIX.FCTSALES
                ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__sales.sql
[0m16:59:08.517720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54863de-b4a1-443e-beb0-e5014b3c8351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f02e0>]}
[0m16:59:08.519201 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model dbt_schema.stg_contoso__sales ............. [[31mERROR[0m in 0.05s]
[0m16:59:08.520693 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m16:59:08.521778 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m16:59:08.522915 [info ] [Thread-1 (]: 7 of 7 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m16:59:08.523953 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m16:59:08.528114 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:08.529024 [debug] [MainThread]: On master: BEGIN
[0m16:59:08.529916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:08.542397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:08.543743 [debug] [MainThread]: On master: COMMIT
[0m16:59:08.545379 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:08.546466 [debug] [MainThread]: On master: COMMIT
[0m16:59:08.547609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:08.548544 [debug] [MainThread]: On master: Close
[0m16:59:08.550366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:08.551304 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m16:59:08.552232 [info ] [MainThread]: 
[0m16:59:08.553300 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m16:59:08.555718 [debug] [MainThread]: Command end result
[0m16:59:08.569768 [info ] [MainThread]: 
[0m16:59:08.570802 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:59:08.571702 [info ] [MainThread]: 
[0m16:59:08.572608 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:59:08.573529 [info ] [MainThread]: 
[0m16:59:08.574452 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:59:08.576368 [info ] [MainThread]: 
[0m16:59:08.578214 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:59:08.579653 [info ] [MainThread]: 
[0m16:59:08.580909 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:59:08.582846 [info ] [MainThread]: 
[0m16:59:08.584685 [error] [MainThread]:   Database Error in model stg_contoso__sales (models/staging/stg_contoso__sales.sql)
  relation "publix.fctsales" does not exist
  LINE 20: FROM PUBLIX.FCTSALES
                ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__sales.sql
[0m16:59:08.585796 [info ] [MainThread]: 
[0m16:59:08.586910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=5 SKIP=1 TOTAL=7
[0m16:59:08.589184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2765926, "process_user_time": 3.650178, "process_kernel_time": 0.269286, "process_mem_max_rss": "109060096", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:08.590584 [debug] [MainThread]: Command `dbt run` failed at 16:59:08.590089 after 1.28 seconds
[0m16:59:08.592075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf95b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f39d0>]}
[0m16:59:08.593764 [debug] [MainThread]: Flushing usage events
[0m16:59:29.642829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e92890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e92530>]}


============================== 16:59:29.648433 | 02599831-1656-4f79-a59e-319b52ae1add ==============================
[0m16:59:29.648433 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:59:29.649640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:29.907807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e927a0>]}
[0m16:59:30.028433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e073d0>]}
[0m16:59:30.029906 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m16:59:30.049457 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:59:30.106687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:30.107893 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m16:59:30.293556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m16:59:30.302193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b900d0>]}
[0m16:59:30.317219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a085b0>]}
[0m16:59:30.318285 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:59:30.319238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a08520>]}
[0m16:59:30.322786 [info ] [MainThread]: 
[0m16:59:30.325684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:30.328501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m16:59:30.346093 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m16:59:30.347088 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m16:59:30.347960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:30.388319 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:59:30.392616 [debug] [ThreadPool]: On list_contosodb: Close
[0m16:59:30.395479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m16:59:30.404512 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:59:30.405420 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m16:59:30.406240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:30.413272 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.414182 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m16:59:30.415031 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m16:59:30.420943 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:59:30.422934 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m16:59:30.424068 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m16:59:30.479778 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.480789 [debug] [MainThread]: On master: BEGIN
[0m16:59:30.481679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:30.488286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.489201 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.490120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:30.514124 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:59:30.516060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bad0c0>]}
[0m16:59:30.517039 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:30.518019 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.518852 [debug] [MainThread]: On master: BEGIN
[0m16:59:30.519888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.520726 [debug] [MainThread]: On master: COMMIT
[0m16:59:30.521560 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.522379 [debug] [MainThread]: On master: COMMIT
[0m16:59:30.523304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:30.524139 [debug] [MainThread]: On master: Close
[0m16:59:30.525404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:30.526449 [info ] [MainThread]: 
[0m16:59:30.529173 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m16:59:30.530236 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m16:59:30.531723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m16:59:30.532790 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m16:59:30.544254 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m16:59:30.545757 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 16:59:30.533444 => 16:59:30.545246
[0m16:59:30.546739 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m16:59:30.600050 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m16:59:30.601601 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:59:30.602525 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m16:59:30.603415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.609825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.611016 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m16:59:30.611984 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m16:59:30.613550 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m16:59:30.614515 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m16:59:30.615919 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 16:59:30.547336 => 16:59:30.615445
[0m16:59:30.616860 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m16:59:30.620274 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:59:30.621312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a384f0>]}
[0m16:59:30.622531 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m16:59:30.623832 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m16:59:30.624836 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:30.625853 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m16:59:30.627242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m16:59:30.628272 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:30.631330 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:30.632814 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 16:59:30.628977 => 16:59:30.632295
[0m16:59:30.633871 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:30.641233 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:30.642828 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:30.643901 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m16:59:30.645512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.652944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.653959 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m16:59:30.655208 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m16:59:30.657180 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m16:59:30.658178 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m16:59:30.659564 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 16:59:30.634484 => 16:59:30.659109
[0m16:59:30.660492 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m16:59:30.662947 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:59:30.664605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c70f40>]}
[0m16:59:30.665819 [error] [Thread-1 (]: 2 of 7 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.04s]
[0m16:59:30.667188 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m16:59:30.668210 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m16:59:30.669265 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m16:59:30.670648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m16:59:30.671590 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m16:59:30.678093 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m16:59:30.679850 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 16:59:30.672395 => 16:59:30.679144
[0m16:59:30.680941 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m16:59:30.714629 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m16:59:30.716141 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:59:30.717263 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m16:59:30.718329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.726062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.727178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m16:59:30.728143 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m16:59:30.729590 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m16:59:30.730511 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m16:59:30.731862 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 16:59:30.681543 => 16:59:30.731411
[0m16:59:30.732907 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m16:59:30.735221 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:59:30.736271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c726b0>]}
[0m16:59:30.737422 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.07s]
[0m16:59:30.738807 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m16:59:30.739842 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m16:59:30.740846 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m16:59:30.742165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m16:59:30.743222 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m16:59:30.746301 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m16:59:30.748666 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 16:59:30.743927 => 16:59:30.747751
[0m16:59:30.750542 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m16:59:30.759623 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m16:59:30.760983 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:59:30.761898 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m16:59:30.762766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.769595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.770555 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m16:59:30.771565 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m16:59:30.773645 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m16:59:30.775052 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m16:59:30.776508 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 16:59:30.751407 => 16:59:30.776046
[0m16:59:30.777423 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m16:59:30.779470 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:59:30.780482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a32a10>]}
[0m16:59:30.781611 [error] [Thread-1 (]: 4 of 7 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m16:59:30.783026 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m16:59:30.784231 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m16:59:30.785555 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m16:59:30.786998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__products)
[0m16:59:30.788083 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m16:59:30.791356 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.793281 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 16:59:30.788938 => 16:59:30.792463
[0m16:59:30.794687 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m16:59:30.802637 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.804370 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.805754 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m16:59:30.807124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.813427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.814386 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.815626 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m16:59:30.819372 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:30.828926 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.830033 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m16:59:30.831481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:30.838296 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.839326 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m16:59:30.840696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:30.863202 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m16:59:30.864186 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.865073 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m16:59:30.867405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:30.877131 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m16:59:30.884019 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m16:59:30.884994 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m16:59:30.887275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:30.889706 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 16:59:30.795544 => 16:59:30.889268
[0m16:59:30.890636 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m16:59:30.892130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca9690>]}
[0m16:59:30.893418 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.11s]
[0m16:59:30.894700 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m16:59:30.895691 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m16:59:30.896698 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m16:59:30.898008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m16:59:30.899048 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m16:59:30.902321 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.904314 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 16:59:30.899745 => 16:59:30.903545
[0m16:59:30.906086 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m16:59:30.914285 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.915803 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.916854 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m16:59:30.918425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:30.925961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.927168 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.928202 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m16:59:30.932355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:30.937972 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.939152 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m16:59:30.941091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:30.946541 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.947588 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m16:59:30.949285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:30.953168 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m16:59:30.954180 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.955360 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m16:59:30.957145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:30.963534 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m16:59:30.965750 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m16:59:30.966684 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m16:59:30.969169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:30.971848 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 16:59:30.907039 => 16:59:30.971408
[0m16:59:30.972773 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m16:59:30.974127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02599831-1656-4f79-a59e-319b52ae1add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c71930>]}
[0m16:59:30.975356 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.08s]
[0m16:59:30.976684 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m16:59:30.977731 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m16:59:30.978779 [info ] [Thread-1 (]: 7 of 7 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m16:59:30.979929 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m16:59:30.982174 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.983090 [debug] [MainThread]: On master: BEGIN
[0m16:59:30.983917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:30.992038 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:30.993773 [debug] [MainThread]: On master: COMMIT
[0m16:59:30.995360 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:30.997009 [debug] [MainThread]: On master: COMMIT
[0m16:59:30.998288 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:30.999409 [debug] [MainThread]: On master: Close
[0m16:59:31.001183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:31.002404 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m16:59:31.003750 [info ] [MainThread]: 
[0m16:59:31.005280 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:59:31.008681 [debug] [MainThread]: Command end result
[0m16:59:31.019134 [info ] [MainThread]: 
[0m16:59:31.020362 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m16:59:31.021558 [info ] [MainThread]: 
[0m16:59:31.022656 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m16:59:31.023580 [info ] [MainThread]: 
[0m16:59:31.024439 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m16:59:31.025834 [info ] [MainThread]: 
[0m16:59:31.027258 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m16:59:31.029436 [info ] [MainThread]: 
[0m16:59:31.030618 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m16:59:31.031700 [info ] [MainThread]: 
[0m16:59:31.033021 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=1 TOTAL=7
[0m16:59:31.035594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4655371, "process_user_time": 3.83172, "process_kernel_time": 0.268841, "process_mem_max_rss": "112148480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:31.037070 [debug] [MainThread]: Command `dbt run` failed at 16:59:31.036499 after 1.47 seconds
[0m16:59:31.038690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c71ab0>]}
[0m16:59:31.040464 [debug] [MainThread]: Flushing usage events
[0m17:03:05.321224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a028c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a02560>]}


============================== 17:03:05.326559 | ee470eb3-18a3-45cf-80bd-0e50f1f48aef ==============================
[0m17:03:05.326559 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:03:05.327909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:03:05.589287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a027d0>]}
[0m17:03:05.710151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f22b60>]}
[0m17:03:05.711678 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:03:05.733135 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:03:05.796843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:03:05.797957 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/staging/stg_contoso__channels.sql
[0m17:03:05.798848 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/staging/stg_contoso__stores.sql
[0m17:03:05.984783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:03:05.992070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126fc0d0>]}
[0m17:03:06.010692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112577df0>]}
[0m17:03:06.011976 [info ] [MainThread]: Found 9 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:03:06.013102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112577e20>]}
[0m17:03:06.015964 [info ] [MainThread]: 
[0m17:03:06.018125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:06.021149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:03:06.039670 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:03:06.040915 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:03:06.041775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:06.080204 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:03:06.083189 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:03:06.086666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:03:06.143348 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:03:06.144409 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:03:06.145225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:06.153218 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.154323 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:03:06.155304 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:03:06.161810 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:03:06.163745 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:03:06.164710 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:03:06.171887 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:06.172790 [debug] [MainThread]: On master: BEGIN
[0m17:03:06.173589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:06.179544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.180430 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:06.181333 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:06.205060 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:03:06.206933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112743400>]}
[0m17:03:06.207912 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:06.208894 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:06.209729 [debug] [MainThread]: On master: BEGIN
[0m17:03:06.210829 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.211673 [debug] [MainThread]: On master: COMMIT
[0m17:03:06.212512 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:06.213325 [debug] [MainThread]: On master: COMMIT
[0m17:03:06.214266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:06.215112 [debug] [MainThread]: On master: Close
[0m17:03:06.216379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:06.217512 [info ] [MainThread]: 
[0m17:03:06.220387 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m17:03:06.221443 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m17:03:06.222888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m17:03:06.224050 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m17:03:06.234841 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m17:03:06.236579 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 17:03:06.224706 => 17:03:06.235987
[0m17:03:06.238139 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m17:03:06.288161 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m17:03:06.289705 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:03:06.290666 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m17:03:06.291556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.297861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.298828 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:03:06.299722 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m17:03:06.301548 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m17:03:06.302538 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m17:03:06.303943 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 17:03:06.239002 => 17:03:06.303469
[0m17:03:06.304871 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m17:03:06.308262 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:03:06.309335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ae230>]}
[0m17:03:06.310487 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m17:03:06.311764 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m17:03:06.312746 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:06.313744 [info ] [Thread-1 (]: 2 of 9 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m17:03:06.315151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m17:03:06.316269 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:06.319425 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:06.320932 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 17:03:06.316965 => 17:03:06.320374
[0m17:03:06.321905 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:06.330328 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:06.331737 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:06.332829 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m17:03:06.334006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.341973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.342959 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:06.343879 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m17:03:06.345256 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m17:03:06.346193 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m17:03:06.347539 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 17:03:06.322490 => 17:03:06.347091
[0m17:03:06.348449 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m17:03:06.350449 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:03:06.351614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281b910>]}
[0m17:03:06.353153 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.04s]
[0m17:03:06.354848 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:06.356212 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m17:03:06.357392 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m17:03:06.359110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m17:03:06.360218 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m17:03:06.364302 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m17:03:06.365737 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 17:03:06.360878 => 17:03:06.365273
[0m17:03:06.366722 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m17:03:06.401469 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m17:03:06.403580 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:03:06.404873 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m17:03:06.405969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.412703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.413737 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:03:06.414691 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m17:03:06.416302 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m17:03:06.417257 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m17:03:06.418621 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 17:03:06.367482 => 17:03:06.418170
[0m17:03:06.419523 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m17:03:06.421720 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:03:06.422886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112804eb0>]}
[0m17:03:06.424038 [error] [Thread-1 (]: 3 of 9 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.06s]
[0m17:03:06.425275 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m17:03:06.426265 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m17:03:06.427255 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m17:03:06.428663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m17:03:06.429604 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m17:03:06.432812 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m17:03:06.434368 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 17:03:06.430196 => 17:03:06.433800
[0m17:03:06.435699 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m17:03:06.444281 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m17:03:06.445696 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:03:06.446629 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m17:03:06.447505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.455042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.456157 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:03:06.457305 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m17:03:06.459001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m17:03:06.459996 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m17:03:06.461417 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 17:03:06.437163 => 17:03:06.460960
[0m17:03:06.462335 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m17:03:06.464417 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:03:06.465454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b8d90>]}
[0m17:03:06.466584 [error] [Thread-1 (]: 4 of 9 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m17:03:06.467986 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m17:03:06.469452 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m17:03:06.470717 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m17:03:06.472389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__channels)
[0m17:03:06.473571 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m17:03:06.476852 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.478709 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 17:03:06.474483 => 17:03:06.478151
[0m17:03:06.479750 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m17:03:06.486690 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.488329 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.490232 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m17:03:06.491546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.498019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.498971 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.499876 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m17:03:06.504357 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:06.514930 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.515931 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m17:03:06.517319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:06.538178 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:03:06.539196 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.540171 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:03:06.541955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:06.550965 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m17:03:06.557841 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:06.558814 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m17:03:06.560014 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:06.562373 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 17:03:06.480350 => 17:03:06.561945
[0m17:03:06.563294 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m17:03:06.564643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270d990>]}
[0m17:03:06.565917 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.09s]
[0m17:03:06.567189 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m17:03:06.568202 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m17:03:06.569192 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m17:03:06.570556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m17:03:06.571480 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m17:03:06.574556 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.576282 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 17:03:06.572064 => 17:03:06.575634
[0m17:03:06.578168 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m17:03:06.588164 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.589592 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.590765 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m17:03:06.592333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.600110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.601821 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.603310 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m17:03:06.606805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:06.613577 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.614553 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m17:03:06.615974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:06.621318 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.622293 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m17:03:06.623592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:06.630488 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:03:06.631588 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.632557 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:03:06.634315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:06.638961 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m17:03:06.641298 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:06.642305 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m17:03:06.644676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:06.647524 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 17:03:06.579869 => 17:03:06.647014
[0m17:03:06.648644 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m17:03:06.650616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286ffd0>]}
[0m17:03:06.651927 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.08s]
[0m17:03:06.653316 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m17:03:06.654843 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m17:03:06.656074 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m17:03:06.657389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m17:03:06.658323 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m17:03:06.662732 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.664489 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 17:03:06.658915 => 17:03:06.663760
[0m17:03:06.665488 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m17:03:06.676899 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.679167 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.681163 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m17:03:06.682392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.696392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.698266 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.699832 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m17:03:06.707228 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:06.715626 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.717143 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m17:03:06.720111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:06.726659 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.727924 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m17:03:06.729426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:06.733150 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:03:06.734826 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.736492 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:03:06.738608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:06.743393 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m17:03:06.745559 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:06.746695 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m17:03:06.749104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:06.751626 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 17:03:06.667104 => 17:03:06.751186
[0m17:03:06.752556 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m17:03:06.753938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ad0c0>]}
[0m17:03:06.755235 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.10s]
[0m17:03:06.756828 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m17:03:06.758604 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__stores
[0m17:03:06.760885 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_schema.stg_contoso__stores ..................... [RUN]
[0m17:03:06.763453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.stg_contoso__stores)
[0m17:03:06.765184 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__stores
[0m17:03:06.768816 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__stores"
[0m17:03:06.771943 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (compile): 17:03:06.766115 => 17:03:06.770865
[0m17:03:06.773786 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__stores
[0m17:03:06.785910 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__stores"
[0m17:03:06.787926 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:06.789630 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: BEGIN
[0m17:03:06.791411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:06.801350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.802387 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:06.803887 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */

  create view "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT * FROM PUBLIC.STORES
  );
[0m17:03:06.806460 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stores" does not exist
LINE 7:     SELECT * FROM PUBLIC.STORES
                          ^

[0m17:03:06.808439 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: ROLLBACK
[0m17:03:06.811111 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (execute): 17:03:06.774844 => 17:03:06.810270
[0m17:03:06.813000 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: Close
[0m17:03:06.816538 [debug] [Thread-1 (]: Database Error in model stg_contoso__stores (models/staging/stg_contoso__stores.sql)
  relation "public.stores" does not exist
  LINE 7:     SELECT * FROM PUBLIC.STORES
                            ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__stores.sql
[0m17:03:06.818320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee470eb3-18a3-45cf-80bd-0e50f1f48aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270fe80>]}
[0m17:03:06.820884 [error] [Thread-1 (]: 8 of 9 ERROR creating sql view model dbt_schema.stg_contoso__stores ............ [[31mERROR[0m in 0.06s]
[0m17:03:06.822228 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__stores
[0m17:03:06.824210 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m17:03:06.826116 [info ] [Thread-1 (]: 9 of 9 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m17:03:06.828386 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m17:03:06.832847 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:06.833760 [debug] [MainThread]: On master: BEGIN
[0m17:03:06.834579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:06.853237 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:06.855250 [debug] [MainThread]: On master: COMMIT
[0m17:03:06.857018 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:06.858515 [debug] [MainThread]: On master: COMMIT
[0m17:03:06.860342 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:06.861882 [debug] [MainThread]: On master: Close
[0m17:03:06.864152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:06.865637 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__stores' was properly closed.
[0m17:03:06.867230 [info ] [MainThread]: 
[0m17:03:06.868591 [info ] [MainThread]: Finished running 8 view models, 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m17:03:06.877071 [debug] [MainThread]: Command end result
[0m17:03:06.903063 [info ] [MainThread]: 
[0m17:03:06.905304 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:03:06.907049 [info ] [MainThread]: 
[0m17:03:06.908841 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:03:06.911463 [info ] [MainThread]: 
[0m17:03:06.913248 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:03:06.914914 [info ] [MainThread]: 
[0m17:03:06.917178 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:03:06.923089 [info ] [MainThread]: 
[0m17:03:06.925070 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:03:06.927033 [info ] [MainThread]: 
[0m17:03:06.928627 [error] [MainThread]:   Database Error in model stg_contoso__stores (models/staging/stg_contoso__stores.sql)
  relation "public.stores" does not exist
  LINE 7:     SELECT * FROM PUBLIC.STORES
                            ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__stores.sql
[0m17:03:06.932007 [info ] [MainThread]: 
[0m17:03:06.934283 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=5 SKIP=1 TOTAL=9
[0m17:03:06.941879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7019457, "process_user_time": 3.981217, "process_kernel_time": 0.307674, "process_mem_max_rss": "112029696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:06.945268 [debug] [MainThread]: Command `dbt run` failed at 17:03:06.944343 after 1.71 seconds
[0m17:03:06.946903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b3eb0>]}
[0m17:03:06.948503 [debug] [MainThread]: Flushing usage events
[0m17:03:29.035080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e19b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535e500>]}


============================== 17:03:29.040965 | 7313de40-7be5-4b33-9fc6-e63fbe33aa63 ==============================
[0m17:03:29.040965 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:03:29.042452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:03:29.323377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10535e770>]}
[0m17:03:29.459005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10544d060>]}
[0m17:03:29.460529 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:03:29.486018 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:03:29.539927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:29.541162 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__stores.sql
[0m17:03:29.739850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:03:29.747136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060580d0>]}
[0m17:03:29.762548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee0e80>]}
[0m17:03:29.763590 [info ] [MainThread]: Found 9 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:03:29.764529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee0df0>]}
[0m17:03:29.767178 [info ] [MainThread]: 
[0m17:03:29.768925 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:29.772189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:03:29.788430 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:03:29.789456 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:03:29.790302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:29.824958 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:03:29.827339 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:03:29.832474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:03:29.841545 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:03:29.842468 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:03:29.843333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:29.849536 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:29.850416 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:03:29.851262 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:03:29.857242 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:03:29.859259 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:03:29.860282 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:03:29.915747 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:29.916735 [debug] [MainThread]: On master: BEGIN
[0m17:03:29.917606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:29.923906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:29.924790 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:29.925689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:29.951372 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:03:29.953290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f129b0>]}
[0m17:03:29.954256 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:29.955239 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:29.956067 [debug] [MainThread]: On master: BEGIN
[0m17:03:29.957106 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:29.957946 [debug] [MainThread]: On master: COMMIT
[0m17:03:29.958764 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:29.959576 [debug] [MainThread]: On master: COMMIT
[0m17:03:29.960533 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:29.961359 [debug] [MainThread]: On master: Close
[0m17:03:29.962637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:29.963654 [info ] [MainThread]: 
[0m17:03:29.966330 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m17:03:29.967375 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m17:03:29.968805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m17:03:29.969890 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m17:03:29.980983 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m17:03:29.982464 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 17:03:29.970537 => 17:03:29.981990
[0m17:03:29.983379 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m17:03:30.034940 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m17:03:30.036359 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:03:30.037258 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m17:03:30.038130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.045407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.046389 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:03:30.047490 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m17:03:30.049066 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m17:03:30.050022 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m17:03:30.051366 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 17:03:29.983954 => 17:03:30.050925
[0m17:03:30.052251 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m17:03:30.055599 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:03:30.056629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587e680>]}
[0m17:03:30.057928 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m17:03:30.059457 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m17:03:30.060465 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:30.061496 [info ] [Thread-1 (]: 2 of 9 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m17:03:30.062956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m17:03:30.064023 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:30.067172 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:30.069497 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 17:03:30.064713 => 17:03:30.068525
[0m17:03:30.071246 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:30.079538 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:30.081473 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:30.082584 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m17:03:30.083855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.090699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.092009 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:03:30.093487 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m17:03:30.094971 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m17:03:30.095899 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m17:03:30.097240 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 17:03:30.071918 => 17:03:30.096794
[0m17:03:30.098180 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m17:03:30.100231 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:03:30.101238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f12200>]}
[0m17:03:30.102361 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.04s]
[0m17:03:30.103610 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:03:30.104593 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m17:03:30.105575 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m17:03:30.107054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m17:03:30.108000 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m17:03:30.114863 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m17:03:30.117071 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 17:03:30.108585 => 17:03:30.116325
[0m17:03:30.118495 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m17:03:30.151835 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m17:03:30.153245 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:03:30.154154 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m17:03:30.155034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.161577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.162543 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:03:30.163457 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m17:03:30.165115 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m17:03:30.166096 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m17:03:30.167472 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 17:03:30.119146 => 17:03:30.167025
[0m17:03:30.168371 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m17:03:30.170373 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:03:30.171377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f14280>]}
[0m17:03:30.172517 [error] [Thread-1 (]: 3 of 9 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.06s]
[0m17:03:30.173872 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m17:03:30.174864 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m17:03:30.175976 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m17:03:30.177418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m17:03:30.178344 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m17:03:30.181515 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m17:03:30.183014 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 17:03:30.178936 => 17:03:30.182492
[0m17:03:30.184271 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m17:03:30.193121 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m17:03:30.194924 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:03:30.195911 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m17:03:30.196804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.203172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.204117 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:03:30.205011 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m17:03:30.206928 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m17:03:30.208307 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m17:03:30.210001 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 17:03:30.185354 => 17:03:30.209504
[0m17:03:30.211189 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m17:03:30.213514 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:03:30.214535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f146a0>]}
[0m17:03:30.215804 [error] [Thread-1 (]: 4 of 9 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m17:03:30.217116 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m17:03:30.218087 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m17:03:30.219085 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m17:03:30.220389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__channels)
[0m17:03:30.221306 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m17:03:30.224516 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.226277 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 17:03:30.221896 => 17:03:30.225533
[0m17:03:30.228098 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m17:03:30.235993 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.237367 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.238273 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m17:03:30.239141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.247240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.248237 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.249177 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m17:03:30.252576 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:30.264063 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.265067 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m17:03:30.266487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.271415 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.272337 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m17:03:30.273655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.296535 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:03:30.297533 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.298424 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:03:30.300640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:30.310310 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m17:03:30.317021 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:03:30.317969 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m17:03:30.320265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:30.322693 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 17:03:30.229026 => 17:03:30.322260
[0m17:03:30.323600 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m17:03:30.325001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a7580>]}
[0m17:03:30.326265 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.10s]
[0m17:03:30.327700 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m17:03:30.328767 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m17:03:30.329773 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m17:03:30.331155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m17:03:30.332123 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m17:03:30.335372 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.336990 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 17:03:30.332715 => 17:03:30.336446
[0m17:03:30.338011 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m17:03:30.346714 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.348358 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.349312 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m17:03:30.350203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.356689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.357810 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.359330 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m17:03:30.363190 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:30.368476 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.369441 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m17:03:30.370810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.375796 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.376808 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m17:03:30.378489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.382679 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:03:30.383626 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.384500 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:03:30.386656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:30.393352 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m17:03:30.395838 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:03:30.396805 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m17:03:30.399245 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:30.401639 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 17:03:30.338624 => 17:03:30.401203
[0m17:03:30.402538 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m17:03:30.403849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106202d70>]}
[0m17:03:30.405260 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.07s]
[0m17:03:30.406501 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m17:03:30.407476 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m17:03:30.408670 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m17:03:30.409965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m17:03:30.410871 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m17:03:30.414075 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.415662 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 17:03:30.411438 => 17:03:30.415163
[0m17:03:30.416626 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m17:03:30.424101 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.425964 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.427532 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m17:03:30.429298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.436213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.437299 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.438245 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m17:03:30.444104 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:30.450206 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.451195 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m17:03:30.452613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.457744 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.459162 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m17:03:30.460798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.464848 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:03:30.465848 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.466725 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:03:30.468439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:30.473186 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m17:03:30.475247 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:03:30.476167 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m17:03:30.478613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:30.481222 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 17:03:30.417216 => 17:03:30.480729
[0m17:03:30.482160 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m17:03:30.483549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee0160>]}
[0m17:03:30.484802 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.07s]
[0m17:03:30.486071 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m17:03:30.487052 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__stores
[0m17:03:30.488069 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_schema.stg_contoso__stores ..................... [RUN]
[0m17:03:30.489844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.stg_contoso__stores)
[0m17:03:30.490939 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__stores
[0m17:03:30.493912 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.495469 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (compile): 17:03:30.491634 => 17:03:30.494911
[0m17:03:30.496810 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__stores
[0m17:03:30.507796 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.509245 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.510252 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: BEGIN
[0m17:03:30.511887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:30.519971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.521043 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.522038 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */

  create view "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT * FROM PUBLIC.DIMSTORES
  );
[0m17:03:30.526420 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:30.531928 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.533096 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
alter table "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp" rename to "stg_contoso__stores"
[0m17:03:30.534523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:30.537807 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: COMMIT
[0m17:03:30.538751 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.539633 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: COMMIT
[0m17:03:30.541303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:30.546630 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__stores__dbt_backup"
[0m17:03:30.549134 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:03:30.550203 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__stores__dbt_backup" cascade
[0m17:03:30.551411 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:30.553917 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (execute): 17:03:30.497457 => 17:03:30.553463
[0m17:03:30.554836 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: Close
[0m17:03:30.556316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313de40-7be5-4b33-9fc6-e63fbe33aa63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623bd60>]}
[0m17:03:30.557596 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_schema.stg_contoso__stores ................ [[32mCREATE VIEW[0m in 0.07s]
[0m17:03:30.558839 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__stores
[0m17:03:30.559829 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m17:03:30.560772 [info ] [Thread-1 (]: 9 of 9 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m17:03:30.561915 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m17:03:30.563834 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:30.564902 [debug] [MainThread]: On master: BEGIN
[0m17:03:30.565986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:30.575225 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:30.576946 [debug] [MainThread]: On master: COMMIT
[0m17:03:30.578492 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:30.579996 [debug] [MainThread]: On master: COMMIT
[0m17:03:30.581658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:30.583187 [debug] [MainThread]: On master: Close
[0m17:03:30.585649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:30.586658 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__stores' was properly closed.
[0m17:03:30.587704 [info ] [MainThread]: 
[0m17:03:30.588671 [info ] [MainThread]: Finished running 8 view models, 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m17:03:30.592411 [debug] [MainThread]: Command end result
[0m17:03:30.603328 [info ] [MainThread]: 
[0m17:03:30.604350 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:03:30.605369 [info ] [MainThread]: 
[0m17:03:30.606300 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:03:30.607257 [info ] [MainThread]: 
[0m17:03:30.608151 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:03:30.609003 [info ] [MainThread]: 
[0m17:03:30.610141 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:03:30.612277 [info ] [MainThread]: 
[0m17:03:30.613848 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:03:30.614866 [info ] [MainThread]: 
[0m17:03:30.616366 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m17:03:30.619967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6679742, "process_user_time": 4.036571, "process_kernel_time": 0.288486, "process_mem_max_rss": "112197632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:30.621153 [debug] [MainThread]: Command `dbt run` failed at 17:03:30.620843 after 1.67 seconds
[0m17:03:30.622072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e19b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0a650>]}
[0m17:03:30.623124 [debug] [MainThread]: Flushing usage events
[0m17:18:47.271458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3e73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110926830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109264d0>]}


============================== 17:18:47.279649 | 3f5dc479-1f06-462c-9db8-3c6355521b02 ==============================
[0m17:18:47.279649 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:18:47.281160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:47.699960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110926740>]}
[0m17:18:47.826869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e61a0>]}
[0m17:18:47.830417 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:18:47.862902 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:18:48.000099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:18:48.001542 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/marts/sales.sql
[0m17:18:48.002802 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__stores.sql
[0m17:18:48.201380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:18:48.209345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111620400>]}
[0m17:18:48.229064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a8e50>]}
[0m17:18:48.230711 [info ] [MainThread]: Found 10 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:18:48.231827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a9180>]}
[0m17:18:48.234733 [info ] [MainThread]: 
[0m17:18:48.236343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:48.238894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:18:48.258705 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:18:48.260568 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:18:48.261621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:48.315321 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:18:48.317662 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:18:48.320904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:18:48.383116 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:18:48.384160 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:18:48.385096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:48.393976 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.395142 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:18:48.396130 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:18:48.402993 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:18:48.405344 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:18:48.406431 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:18:48.414636 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.415753 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.416604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:48.423101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.424022 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.424927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:48.452924 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:18:48.454998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111667580>]}
[0m17:18:48.456003 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:48.457021 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.457850 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.458929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.459781 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.460610 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.461561 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.462611 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:48.463516 [debug] [MainThread]: On master: Close
[0m17:18:48.464909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:48.465993 [info ] [MainThread]: 
[0m17:18:48.471164 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m17:18:48.472651 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m17:18:48.474431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m17:18:48.475610 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m17:18:48.487537 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m17:18:48.488986 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 17:18:48.476318 => 17:18:48.488525
[0m17:18:48.490520 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m17:18:48.548639 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m17:18:48.550041 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:18:48.550962 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m17:18:48.551843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.558546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.559542 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:18:48.560452 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m17:18:48.563260 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m17:18:48.564957 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m17:18:48.569081 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 17:18:48.491276 => 17:18:48.567664
[0m17:18:48.572218 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m17:18:48.589122 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:18:48.591108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d1780>]}
[0m17:18:48.593198 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.12s]
[0m17:18:48.595454 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m17:18:48.598503 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:18:48.609829 [info ] [Thread-1 (]: 2 of 9 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m17:18:48.612603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m17:18:48.614354 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:18:48.620872 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:18:48.635133 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 17:18:48.615426 => 17:18:48.633768
[0m17:18:48.637105 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:18:48.656635 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:18:48.659466 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:18:48.661326 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m17:18:48.662322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.669145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.670247 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:18:48.671634 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m17:18:48.673145 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m17:18:48.674074 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m17:18:48.676154 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 17:18:48.638296 => 17:18:48.674974
[0m17:18:48.677538 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m17:18:48.679686 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:18:48.680713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a3880>]}
[0m17:18:48.681849 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.07s]
[0m17:18:48.683186 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:18:48.684246 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m17:18:48.685258 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m17:18:48.686903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m17:18:48.688598 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m17:18:48.692935 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m17:18:48.694461 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 17:18:48.689237 => 17:18:48.693958
[0m17:18:48.695917 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m17:18:48.730704 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m17:18:48.732127 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:18:48.733039 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m17:18:48.733915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.740785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.742178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:18:48.743367 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m17:18:48.744883 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m17:18:48.745824 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m17:18:48.747184 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 17:18:48.696573 => 17:18:48.746729
[0m17:18:48.748081 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m17:18:48.750082 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:18:48.751112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a3850>]}
[0m17:18:48.752402 [error] [Thread-1 (]: 3 of 9 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.06s]
[0m17:18:48.753692 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m17:18:48.755018 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m17:18:48.756051 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m17:18:48.757627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m17:18:48.758636 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m17:18:48.761776 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m17:18:48.763463 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 17:18:48.759246 => 17:18:48.762869
[0m17:18:48.764948 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m17:18:48.773667 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m17:18:48.775414 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:18:48.776442 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m17:18:48.777569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.784373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.785321 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:18:48.786595 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m17:18:48.788539 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m17:18:48.789508 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m17:18:48.790943 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 17:18:48.766033 => 17:18:48.790465
[0m17:18:48.792420 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m17:18:48.794921 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:18:48.795945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a8ca0>]}
[0m17:18:48.797070 [error] [Thread-1 (]: 4 of 9 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m17:18:48.798394 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m17:18:48.799361 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m17:18:48.800348 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m17:18:48.801838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__channels)
[0m17:18:48.803225 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m17:18:48.806533 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.807968 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 17:18:48.803943 => 17:18:48.807505
[0m17:18:48.809067 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m17:18:48.817753 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.819355 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.820596 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m17:18:48.821581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.830041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.831165 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.832114 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m17:18:48.836457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:18:48.847965 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.848953 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m17:18:48.850376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:48.855660 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.856623 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m17:18:48.858124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:48.880889 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:18:48.881873 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.882765 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:18:48.884501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:48.893721 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m17:18:48.900344 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:18:48.901282 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m17:18:48.903715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:18:48.906147 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 17:18:48.809724 => 17:18:48.905713
[0m17:18:48.907065 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m17:18:48.908679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a9e10>]}
[0m17:18:48.910002 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.11s]
[0m17:18:48.911566 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m17:18:48.912565 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m17:18:48.913550 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m17:18:48.915039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m17:18:48.916420 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m17:18:48.923435 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.926088 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 17:18:48.917307 => 17:18:48.925553
[0m17:18:48.927083 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m17:18:48.934594 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.935995 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.937137 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m17:18:48.938360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.946395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:48.947361 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.948252 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m17:18:48.951590 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:18:48.957055 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.958033 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m17:18:48.959602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:48.965384 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.966344 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m17:18:48.967674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:48.971511 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:18:48.972453 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.973616 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:18:48.975824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:48.981988 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m17:18:48.984060 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:18:48.984961 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m17:18:48.987263 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:18:48.989729 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 17:18:48.927726 => 17:18:48.989229
[0m17:18:48.990666 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m17:18:48.992170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d7fa0>]}
[0m17:18:48.993513 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.08s]
[0m17:18:48.994754 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m17:18:48.995705 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m17:18:48.996679 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m17:18:48.998032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m17:18:48.998948 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m17:18:49.001930 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.003424 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 17:18:48.999540 => 17:18:49.002884
[0m17:18:49.004477 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m17:18:49.012126 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.013521 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.014443 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m17:18:49.015319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.023625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:49.025422 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.028173 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m17:18:49.033664 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:18:49.042207 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.043856 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m17:18:49.046307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:49.055386 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.057355 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m17:18:49.061112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:49.065970 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:18:49.066955 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.067837 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:18:49.069898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:49.074725 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m17:18:49.077489 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:18:49.079118 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m17:18:49.081870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:18:49.084449 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 17:18:49.005081 => 17:18:49.084007
[0m17:18:49.085392 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m17:18:49.086773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111499d50>]}
[0m17:18:49.088025 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.09s]
[0m17:18:49.089397 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m17:18:49.090533 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__stores
[0m17:18:49.091805 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_schema.stg_contoso__stores ..................... [RUN]
[0m17:18:49.093268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.stg_contoso__stores)
[0m17:18:49.094536 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__stores
[0m17:18:49.097622 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__stores"
[0m17:18:49.099590 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (compile): 17:18:49.095276 => 17:18:49.098783
[0m17:18:49.101148 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__stores
[0m17:18:49.113579 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__stores"
[0m17:18:49.115434 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:18:49.117092 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: BEGIN
[0m17:18:49.118736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.130243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:49.132033 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:18:49.133718 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */

  create view "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m17:18:49.136363 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CASE"
LINE 10: CASE
         ^

[0m17:18:49.138020 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: ROLLBACK
[0m17:18:49.141816 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (execute): 17:18:49.101880 => 17:18:49.139738
[0m17:18:49.143715 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: Close
[0m17:18:49.146855 [debug] [Thread-1 (]: Database Error in model stg_contoso__stores (models/staging/stg_contoso__stores.sql)
  syntax error at or near "CASE"
  LINE 10: CASE
           ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__stores.sql
[0m17:18:49.147927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5dc479-1f06-462c-9db8-3c6355521b02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f8760>]}
[0m17:18:49.149098 [error] [Thread-1 (]: 8 of 9 ERROR creating sql view model dbt_schema.stg_contoso__stores ............ [[31mERROR[0m in 0.05s]
[0m17:18:49.150811 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__stores
[0m17:18:49.151885 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m17:18:49.153002 [info ] [Thread-1 (]: 9 of 9 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m17:18:49.154257 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m17:18:49.159126 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.160574 [debug] [MainThread]: On master: BEGIN
[0m17:18:49.162636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:49.169291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:49.170199 [debug] [MainThread]: On master: COMMIT
[0m17:18:49.171786 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.173313 [debug] [MainThread]: On master: COMMIT
[0m17:18:49.175401 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:49.176678 [debug] [MainThread]: On master: Close
[0m17:18:49.178351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:49.179265 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__stores' was properly closed.
[0m17:18:49.180295 [info ] [MainThread]: 
[0m17:18:49.181521 [info ] [MainThread]: Finished running 8 view models, 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m17:18:49.184436 [debug] [MainThread]: Command end result
[0m17:18:49.199548 [info ] [MainThread]: 
[0m17:18:49.200989 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:18:49.202023 [info ] [MainThread]: 
[0m17:18:49.203000 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:18:49.204255 [info ] [MainThread]: 
[0m17:18:49.207370 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:18:49.209300 [info ] [MainThread]: 
[0m17:18:49.211087 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:18:49.212191 [info ] [MainThread]: 
[0m17:18:49.214295 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:18:49.216429 [info ] [MainThread]: 
[0m17:18:49.217532 [error] [MainThread]:   Database Error in model stg_contoso__stores (models/staging/stg_contoso__stores.sql)
  syntax error at or near "CASE"
  LINE 10: CASE
           ^
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__stores.sql
[0m17:18:49.218649 [info ] [MainThread]: 
[0m17:18:49.219849 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=5 SKIP=1 TOTAL=9
[0m17:18:49.224551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0622582, "process_user_time": 4.682083, "process_kernel_time": 0.683725, "process_mem_max_rss": "112922624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:18:49.227696 [debug] [MainThread]: Command `dbt run` failed at 17:18:49.227099 after 2.07 seconds
[0m17:18:49.229207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3e73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f9cf0>]}
[0m17:18:49.230169 [debug] [MainThread]: Flushing usage events
[0m17:20:18.802865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b742860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b742500>]}


============================== 17:20:18.808358 | f8f2eab3-da9c-4a98-b3c1-ce4250a55b80 ==============================
[0m17:20:18.808358 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:20:18.809632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:20:19.095034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b742770>]}
[0m17:20:19.269349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba99060>]}
[0m17:20:19.270791 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:20:19.302348 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:20:19.359625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:19.360966 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__stores.sql
[0m17:20:19.549236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:20:19.557201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c448460>]}
[0m17:20:19.573800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c1210>]}
[0m17:20:19.575892 [info ] [MainThread]: Found 10 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:20:19.577865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c1540>]}
[0m17:20:19.581952 [info ] [MainThread]: 
[0m17:20:19.583822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:19.586806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:20:19.606582 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:20:19.607614 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:20:19.608728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:19.650314 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:20:19.653241 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:20:19.656390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:20:19.665930 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:20:19.666839 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:20:19.667935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:19.674266 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:20:19.675169 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:20:19.676072 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:20:19.682021 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:20:19.684011 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:20:19.684996 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:20:19.741140 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:19.742151 [debug] [MainThread]: On master: BEGIN
[0m17:20:19.743027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:19.749420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:19.750321 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:19.751364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:19.779548 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:20:19.781532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ec340>]}
[0m17:20:19.782516 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:19.783917 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:19.784857 [debug] [MainThread]: On master: BEGIN
[0m17:20:19.785964 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:19.786824 [debug] [MainThread]: On master: COMMIT
[0m17:20:19.787676 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:19.788496 [debug] [MainThread]: On master: COMMIT
[0m17:20:19.789715 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:20:19.790599 [debug] [MainThread]: On master: Close
[0m17:20:19.791913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:19.793025 [info ] [MainThread]: 
[0m17:20:19.795854 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m17:20:19.796918 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_schema.dbt_channel_stg ......................... [RUN]
[0m17:20:19.798430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m17:20:19.799489 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m17:20:19.809709 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m17:20:19.811656 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 17:20:19.800119 => 17:20:19.811120
[0m17:20:19.812832 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m17:20:19.862810 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m17:20:19.864251 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:20:19.865176 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m17:20:19.866060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:19.872613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:19.873597 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:20:19.874509 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m17:20:19.876220 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m17:20:19.877199 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m17:20:19.878586 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 17:20:19.813485 => 17:20:19.878134
[0m17:20:19.879501 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m17:20:19.882872 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:20:19.883922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c44b6d0>]}
[0m17:20:19.885085 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model dbt_schema.dbt_channel_stg ................ [[31mERROR[0m in 0.09s]
[0m17:20:19.886373 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m17:20:19.887376 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:20:19.888647 [info ] [Thread-1 (]: 2 of 9 START sql view model dbt_schema.dbt_factonlinesales_stg ................. [RUN]
[0m17:20:19.890150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m17:20:19.891315 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:20:19.895725 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:20:19.897917 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 17:20:19.891925 => 17:20:19.897218
[0m17:20:19.899373 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:20:19.906451 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:20:19.907740 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:20:19.908733 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m17:20:19.909806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:19.917602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:19.918580 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:20:19.919558 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m17:20:19.921020 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m17:20:19.921955 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m17:20:19.923307 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 17:20:19.899991 => 17:20:19.922854
[0m17:20:19.924216 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m17:20:19.926340 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:20:19.927402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52dea0>]}
[0m17:20:19.928557 [error] [Thread-1 (]: 2 of 9 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ........ [[31mERROR[0m in 0.04s]
[0m17:20:19.929857 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:20:19.930849 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m17:20:19.931856 [info ] [Thread-1 (]: 3 of 9 START sql table model dbt_schema.dbt_factsales .......................... [RUN]
[0m17:20:19.933339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m17:20:19.934299 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m17:20:19.940442 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m17:20:19.943071 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 17:20:19.934893 => 17:20:19.942127
[0m17:20:19.944466 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m17:20:19.976141 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m17:20:19.977560 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:20:19.978472 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m17:20:19.979344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:19.985740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:19.986713 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:20:19.987621 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m17:20:19.989190 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m17:20:19.990303 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m17:20:19.991823 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 17:20:19.945164 => 17:20:19.991270
[0m17:20:19.992771 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m17:20:19.994740 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:20:19.995768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c452d40>]}
[0m17:20:19.997013 [error] [Thread-1 (]: 3 of 9 ERROR creating sql table model dbt_schema.dbt_factsales ................. [[31mERROR[0m in 0.06s]
[0m17:20:19.998302 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m17:20:19.999294 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m17:20:20.000297 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_schema.dbt_product_stg ......................... [RUN]
[0m17:20:20.001611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m17:20:20.002534 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m17:20:20.005656 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m17:20:20.007263 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 17:20:20.003126 => 17:20:20.006657
[0m17:20:20.008784 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m17:20:20.017600 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m17:20:20.019446 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:20:20.020486 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m17:20:20.021376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:20.027837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:20.028811 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:20:20.029724 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m17:20:20.031340 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m17:20:20.032311 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m17:20:20.033682 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 17:20:20.010323 => 17:20:20.033228
[0m17:20:20.034598 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m17:20:20.036535 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:20:20.037545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52f5e0>]}
[0m17:20:20.038785 [error] [Thread-1 (]: 4 of 9 ERROR creating sql view model dbt_schema.dbt_product_stg ................ [[31mERROR[0m in 0.04s]
[0m17:20:20.040076 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m17:20:20.041058 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m17:20:20.042073 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m17:20:20.043786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.stg_contoso__channels)
[0m17:20:20.044753 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m17:20:20.047887 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.049356 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 17:20:20.045345 => 17:20:20.048868
[0m17:20:20.050293 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m17:20:20.057463 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.058769 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.059698 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m17:20:20.061106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:20.068967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:20.069953 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.070864 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m17:20:20.074759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:20:20.084679 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.085676 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m17:20:20.087118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.095003 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.095996 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m17:20:20.097376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.119858 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:20:20.120861 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.121767 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:20:20.124062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:20:20.133583 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m17:20:20.140399 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:20:20.141386 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m17:20:20.143993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:20:20.146728 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 17:20:20.050876 => 17:20:20.146284
[0m17:20:20.147659 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m17:20:20.149014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52f0d0>]}
[0m17:20:20.150266 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.11s]
[0m17:20:20.151613 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m17:20:20.152621 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m17:20:20.153668 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m17:20:20.155063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m17:20:20.156212 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m17:20:20.159704 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.161544 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 17:20:20.156939 => 17:20:20.160803
[0m17:20:20.163146 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m17:20:20.171201 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.172872 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.174247 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m17:20:20.175291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:20.182405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:20.183473 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.184628 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m17:20:20.188886 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:20:20.195527 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.196708 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m17:20:20.198403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.203719 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.204671 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m17:20:20.206015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.209856 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:20:20.210824 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.211713 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:20:20.213758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:20:20.220153 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m17:20:20.222323 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:20:20.223286 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m17:20:20.225815 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:20:20.229075 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 17:20:20.164182 => 17:20:20.228557
[0m17:20:20.230146 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m17:20:20.231574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52f0d0>]}
[0m17:20:20.232827 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.08s]
[0m17:20:20.234187 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m17:20:20.235266 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m17:20:20.236304 [info ] [Thread-1 (]: 7 of 9 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m17:20:20.237745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m17:20:20.238674 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m17:20:20.242092 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.244515 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 17:20:20.239266 => 17:20:20.243301
[0m17:20:20.247425 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m17:20:20.264151 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.266174 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.267613 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m17:20:20.268623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:20.276563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:20.278246 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.279328 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m17:20:20.283815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:20:20.289150 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.290152 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m17:20:20.291604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.297245 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.298238 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m17:20:20.299651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.303225 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:20:20.304149 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.305044 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:20:20.306763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:20:20.312124 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m17:20:20.314476 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:20:20.315442 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m17:20:20.317844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:20:20.320492 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 17:20:20.248898 => 17:20:20.320021
[0m17:20:20.321472 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m17:20:20.323267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52e6b0>]}
[0m17:20:20.324544 [info ] [Thread-1 (]: 7 of 9 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.09s]
[0m17:20:20.325993 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m17:20:20.327069 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__stores
[0m17:20:20.328103 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_schema.stg_contoso__stores ..................... [RUN]
[0m17:20:20.329601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.stg_contoso__stores)
[0m17:20:20.330557 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__stores
[0m17:20:20.333755 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.335598 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (compile): 17:20:20.331155 => 17:20:20.334856
[0m17:20:20.337238 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__stores
[0m17:20:20.349408 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.351672 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.353354 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: BEGIN
[0m17:20:20.354961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:20.362396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:20:20.364156 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.365813 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */

  create view "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME,
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m17:20:20.372351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:20:20.379360 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.380338 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
alter table "contosodb"."dbt_schema"."stg_contoso__stores" rename to "stg_contoso__stores__dbt_backup"
[0m17:20:20.381712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.386639 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.387576 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
alter table "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp" rename to "stg_contoso__stores"
[0m17:20:20.389630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:20:20.393542 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: COMMIT
[0m17:20:20.394450 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.395328 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: COMMIT
[0m17:20:20.396784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:20:20.401385 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__stores__dbt_backup"
[0m17:20:20.403450 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:20:20.404366 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__stores__dbt_backup" cascade
[0m17:20:20.406928 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:20:20.409595 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (execute): 17:20:20.338504 => 17:20:20.409151
[0m17:20:20.410548 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: Close
[0m17:20:20.411913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8f2eab3-da9c-4a98-b3c1-ce4250a55b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c55c190>]}
[0m17:20:20.413189 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_schema.stg_contoso__stores ................ [[32mCREATE VIEW[0m in 0.08s]
[0m17:20:20.414515 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__stores
[0m17:20:20.415511 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m17:20:20.416483 [info ] [Thread-1 (]: 9 of 9 SKIP relation dbt_schema.dbt_sales ...................................... [[33mSKIP[0m]
[0m17:20:20.417543 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m17:20:20.420893 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:20.421977 [debug] [MainThread]: On master: BEGIN
[0m17:20:20.422962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:20.431207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:20:20.432147 [debug] [MainThread]: On master: COMMIT
[0m17:20:20.432993 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:20.433833 [debug] [MainThread]: On master: COMMIT
[0m17:20:20.434782 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:20:20.435642 [debug] [MainThread]: On master: Close
[0m17:20:20.437376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:20.438390 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__stores' was properly closed.
[0m17:20:20.439303 [info ] [MainThread]: 
[0m17:20:20.440229 [info ] [MainThread]: Finished running 8 view models, 1 table model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m17:20:20.443047 [debug] [MainThread]: Command end result
[0m17:20:20.455493 [info ] [MainThread]: 
[0m17:20:20.456543 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:20:20.457524 [info ] [MainThread]: 
[0m17:20:20.458379 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:20:20.459235 [info ] [MainThread]: 
[0m17:20:20.460073 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:20:20.460941 [info ] [MainThread]: 
[0m17:20:20.461775 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:20:20.463800 [info ] [MainThread]: 
[0m17:20:20.464784 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:20:20.465835 [info ] [MainThread]: 
[0m17:20:20.466721 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m17:20:20.468913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7596956, "process_user_time": 4.22515, "process_kernel_time": 0.327292, "process_mem_max_rss": "112701440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:20:20.471154 [debug] [MainThread]: Command `dbt run` failed at 17:20:20.470310 after 1.76 seconds
[0m17:20:20.472434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c55c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c455870>]}
[0m17:20:20.473384 [debug] [MainThread]: Flushing usage events
[0m17:22:05.877034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112455660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ee890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ee530>]}


============================== 17:22:05.883031 | 8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1 ==============================
[0m17:22:05.883031 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:22:05.884853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:22:06.146232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ee7a0>]}
[0m17:22:06.266458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149633d0>]}
[0m17:22:06.267961 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:22:06.290417 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:22:06.349608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:22:06.350775 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/intermediate/int_contoso__stores.sql
[0m17:22:06.351749 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__stores.sql
[0m17:22:06.540368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:22:06.548073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156f3fd0>]}
[0m17:22:06.565310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11556d420>]}
[0m17:22:06.566405 [info ] [MainThread]: Found 11 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:22:06.567359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11556d390>]}
[0m17:22:06.570245 [info ] [MainThread]: 
[0m17:22:06.572804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:06.576116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:22:06.597454 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:22:06.598418 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:22:06.599258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:06.634787 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:22:06.637122 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:22:06.640565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:22:06.698424 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:22:06.699387 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:22:06.700208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:06.706758 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:22:06.707648 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:22:06.708504 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:22:06.714568 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:22:06.716662 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:22:06.717713 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:22:06.725853 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:06.726776 [debug] [MainThread]: On master: BEGIN
[0m17:22:06.727606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:06.733715 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:22:06.734608 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:06.735511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:22:06.763491 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:22:06.765544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156c17b0>]}
[0m17:22:06.766613 [debug] [MainThread]: On master: ROLLBACK
[0m17:22:06.767685 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:06.768547 [debug] [MainThread]: On master: BEGIN
[0m17:22:06.769578 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:22:06.770416 [debug] [MainThread]: On master: COMMIT
[0m17:22:06.771253 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:06.772081 [debug] [MainThread]: On master: COMMIT
[0m17:22:06.773017 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:22:06.773866 [debug] [MainThread]: On master: Close
[0m17:22:06.775138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:06.776169 [info ] [MainThread]: 
[0m17:22:06.778780 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_channel_stg
[0m17:22:06.779831 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_schema.dbt_channel_stg ........................ [RUN]
[0m17:22:06.781478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.dbt_channel_stg)
[0m17:22:06.782794 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_channel_stg
[0m17:22:06.795706 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_channel_stg"
[0m17:22:06.797174 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (compile): 17:22:06.783500 => 17:22:06.796716
[0m17:22:06.798111 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_channel_stg
[0m17:22:06.847453 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_channel_stg"
[0m17:22:06.848857 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:22:06.849765 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: BEGIN
[0m17:22:06.850642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:06.857107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:06.858061 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_channel_stg"
[0m17:22:06.858964 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_channel_stg"} */

  create view "contosodb"."dbt_schema"."dbt_channel_stg__dbt_tmp"
    
    
  as (
    select * from public.dim_channel
  );
[0m17:22:06.860507 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dim_channel" does not exist
LINE 7:     select * from public.dim_channel
                          ^

[0m17:22:06.861821 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: ROLLBACK
[0m17:22:06.863227 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_channel_stg (execute): 17:22:06.798733 => 17:22:06.862771
[0m17:22:06.864151 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_channel_stg: Close
[0m17:22:06.868025 [debug] [Thread-1 (]: Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:22:06.869097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156c17b0>]}
[0m17:22:06.870259 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model dbt_schema.dbt_channel_stg ............... [[31mERROR[0m in 0.09s]
[0m17:22:06.871510 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_channel_stg
[0m17:22:06.872496 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:22:06.873509 [info ] [Thread-1 (]: 2 of 10 START sql view model dbt_schema.dbt_factonlinesales_stg ................ [RUN]
[0m17:22:06.874806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_channel_stg, now model.postgres_dbt.dbt_factonlinesales_stg)
[0m17:22:06.875985 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:22:06.880116 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:22:06.881804 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (compile): 17:22:06.877174 => 17:22:06.881236
[0m17:22:06.883001 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:22:06.894508 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:22:06.896074 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:22:06.897256 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: BEGIN
[0m17:22:06.898157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:06.904613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:06.905584 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factonlinesales_stg"
[0m17:22:06.906508 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factonlinesales_stg"} */

  create view "contosodb"."dbt_schema"."dbt_factonlinesales_stg__dbt_tmp"
    
    
  as (
    select productkey, salesquantity, salesamount, discountamount from public.factonlinesales
  );
[0m17:22:06.908216 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.factonlinesales" does not exist
LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                             ^

[0m17:22:06.909575 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: ROLLBACK
[0m17:22:06.911529 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factonlinesales_stg (execute): 17:22:06.883748 => 17:22:06.911012
[0m17:22:06.912719 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factonlinesales_stg: Close
[0m17:22:06.914903 [debug] [Thread-1 (]: Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:22:06.916002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11573e6e0>]}
[0m17:22:06.917339 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model dbt_schema.dbt_factonlinesales_stg ....... [[31mERROR[0m in 0.04s]
[0m17:22:06.918601 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factonlinesales_stg
[0m17:22:06.919575 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_factsales
[0m17:22:06.920559 [info ] [Thread-1 (]: 3 of 10 START sql table model dbt_schema.dbt_factsales ......................... [RUN]
[0m17:22:06.922092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factonlinesales_stg, now model.postgres_dbt.dbt_factsales)
[0m17:22:06.923048 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_factsales
[0m17:22:06.927276 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_factsales"
[0m17:22:06.929517 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (compile): 17:22:06.923637 => 17:22:06.928383
[0m17:22:06.930995 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_factsales
[0m17:22:06.966364 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_factsales"
[0m17:22:06.968043 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:22:06.969053 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: BEGIN
[0m17:22:06.969934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:06.976390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:06.977355 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_factsales"
[0m17:22:06.978271 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_factsales"} */

  
    

  create  table "contosodb"."dbt_schema"."dbt_factsales__dbt_tmp"
  
  
    as
  
  (
    

WITH DBT_FACTSALES AS (
    SELECT FS.TOTALCOST, D.PRODUCTNAME
    FROM FACTONLINESALES FS
    LEFT JOIN DIMPRODUCT D
    on FS.PRODUCTKEY = D.PRODUCTKEY
    group by FS.TOTALCOST, D.PRODUCTNAME
    order by FS.TOTALCOST desc
)

SELECT * FROM DBT_FACTSALES
  );
  
[0m17:22:06.980013 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "factonlinesales" does not exist
LINE 16:     FROM FACTONLINESALES FS
                  ^

[0m17:22:06.981068 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: ROLLBACK
[0m17:22:06.982511 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_factsales (execute): 17:22:06.931931 => 17:22:06.982043
[0m17:22:06.983426 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_factsales: Close
[0m17:22:06.985475 [debug] [Thread-1 (]: Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:22:06.986490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11573f970>]}
[0m17:22:06.987617 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model dbt_schema.dbt_factsales ................ [[31mERROR[0m in 0.06s]
[0m17:22:06.989196 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_factsales
[0m17:22:06.990187 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_product_stg
[0m17:22:06.991185 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_schema.dbt_product_stg ........................ [RUN]
[0m17:22:06.992694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_factsales, now model.postgres_dbt.dbt_product_stg)
[0m17:22:06.994055 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.dbt_product_stg
[0m17:22:06.997064 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.dbt_product_stg"
[0m17:22:06.998463 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (compile): 17:22:06.994703 => 17:22:06.998004
[0m17:22:06.999367 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.dbt_product_stg
[0m17:22:07.006640 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.dbt_product_stg"
[0m17:22:07.008118 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:22:07.009114 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: BEGIN
[0m17:22:07.011478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:07.018276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.019249 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.dbt_product_stg"
[0m17:22:07.020154 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.dbt_product_stg"} */

  create view "contosodb"."dbt_schema"."dbt_product_stg__dbt_tmp"
    
    
  as (
    select d.productkey , d.productname, pc.productcategoryname  from public.dimproduct d 
join public.dimproductsubcategory ds 
on d.productsubcategorykey  = ds.productsubcategorykey 
join public.dimproductcategory pc 
on pc.productcategorykey = ds.productcategorykey
  );
[0m17:22:07.021826 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.dimproduct" does not exist
LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                             ^

[0m17:22:07.023404 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: ROLLBACK
[0m17:22:07.025267 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.dbt_product_stg (execute): 17:22:06.999940 => 17:22:07.024766
[0m17:22:07.026190 [debug] [Thread-1 (]: On model.postgres_dbt.dbt_product_stg: Close
[0m17:22:07.028282 [debug] [Thread-1 (]: Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:22:07.029312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11573c820>]}
[0m17:22:07.030527 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model dbt_schema.dbt_product_stg ............... [[31mERROR[0m in 0.04s]
[0m17:22:07.032258 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_product_stg
[0m17:22:07.033403 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores
[0m17:22:07.034424 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_schema.int_contoso__stores .................... [RUN]
[0m17:22:07.035853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.dbt_product_stg, now model.postgres_dbt.int_contoso__stores)
[0m17:22:07.037470 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores
[0m17:22:07.040691 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.044232 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (compile): 17:22:07.038241 => 17:22:07.042847
[0m17:22:07.045747 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores
[0m17:22:07.052963 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.055149 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.057441 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: BEGIN
[0m17:22:07.058911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:07.066355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.067533 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.068462 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME,
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m17:22:07.073357 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:07.084729 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.085989 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp" rename to "int_contoso__stores"
[0m17:22:07.087497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.107429 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m17:22:07.108492 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.109420 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m17:22:07.111662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:07.122784 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup"
[0m17:22:07.130633 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m17:22:07.131652 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup" cascade
[0m17:22:07.133018 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:07.136365 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (execute): 17:22:07.046373 => 17:22:07.135921
[0m17:22:07.137330 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: Close
[0m17:22:07.139167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115840190>]}
[0m17:22:07.141482 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_schema.int_contoso__stores ............... [[32mCREATE VIEW[0m in 0.10s]
[0m17:22:07.143020 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores
[0m17:22:07.144102 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m17:22:07.145235 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_schema.stg_contoso__channels .................. [RUN]
[0m17:22:07.146675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores, now model.postgres_dbt.stg_contoso__channels)
[0m17:22:07.147616 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m17:22:07.159190 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.162817 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 17:22:07.151503 => 17:22:07.161941
[0m17:22:07.164453 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m17:22:07.180883 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.182919 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.183890 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m17:22:07.185398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:07.194608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.196408 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.198092 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m17:22:07.202354 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:07.209194 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.210297 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m17:22:07.211843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.216879 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.217980 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m17:22:07.219683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.227617 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:22:07.228605 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.229490 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m17:22:07.231182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:07.237888 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m17:22:07.240036 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m17:22:07.240975 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m17:22:07.243934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:07.246746 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 17:22:07.165490 => 17:22:07.246310
[0m17:22:07.247665 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m17:22:07.249093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156f0cd0>]}
[0m17:22:07.250363 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_schema.stg_contoso__channels ............. [[32mCREATE VIEW[0m in 0.10s]
[0m17:22:07.251718 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m17:22:07.252705 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m17:22:07.253891 [info ] [Thread-1 (]: 7 of 10 START sql view model dbt_schema.stg_contoso__products .................. [RUN]
[0m17:22:07.255556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m17:22:07.257273 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m17:22:07.264152 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.266459 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 17:22:07.258338 => 17:22:07.265932
[0m17:22:07.267476 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m17:22:07.280288 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.281698 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.282603 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m17:22:07.283481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:07.291620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.293121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.294137 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m17:22:07.297878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:07.303403 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.304376 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m17:22:07.305791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.311438 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.312410 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m17:22:07.313727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.317304 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:22:07.318225 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.319116 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m17:22:07.321601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:07.326908 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m17:22:07.329212 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m17:22:07.330127 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m17:22:07.332455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:07.334908 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 17:22:07.268463 => 17:22:07.334443
[0m17:22:07.335836 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m17:22:07.337271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115860040>]}
[0m17:22:07.338506 [info ] [Thread-1 (]: 7 of 10 OK created sql view model dbt_schema.stg_contoso__products ............. [[32mCREATE VIEW[0m in 0.08s]
[0m17:22:07.339841 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m17:22:07.340837 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m17:22:07.341832 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_schema.stg_contoso__sales ..................... [RUN]
[0m17:22:07.343129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m17:22:07.344168 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m17:22:07.347399 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.349203 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 17:22:07.344985 => 17:22:07.348571
[0m17:22:07.351505 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m17:22:07.363112 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.364825 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.365770 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m17:22:07.366642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:07.373539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.374804 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.376563 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m17:22:07.381081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:07.387911 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.388893 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m17:22:07.390352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.395365 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.396316 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m17:22:07.397687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.401213 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:22:07.402130 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.403003 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m17:22:07.404737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:07.409388 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m17:22:07.411469 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m17:22:07.412397 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m17:22:07.414910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:07.417401 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 17:22:07.352827 => 17:22:07.416970
[0m17:22:07.418305 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m17:22:07.419668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115863d30>]}
[0m17:22:07.420919 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_schema.stg_contoso__sales ................ [[32mCREATE VIEW[0m in 0.08s]
[0m17:22:07.422350 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m17:22:07.423389 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__stores
[0m17:22:07.424465 [info ] [Thread-1 (]: 9 of 10 START sql view model dbt_schema.stg_contoso__stores .................... [RUN]
[0m17:22:07.425751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.stg_contoso__stores)
[0m17:22:07.427002 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__stores
[0m17:22:07.430081 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.431863 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (compile): 17:22:07.427731 => 17:22:07.431242
[0m17:22:07.433909 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__stores
[0m17:22:07.442552 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.443949 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.444979 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: BEGIN
[0m17:22:07.446224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:07.452947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.453913 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.454878 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */

  create view "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT * FROM PUBLIC.DIMSTORES
  );
[0m17:22:07.459298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:07.464757 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.465803 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
alter table "contosodb"."dbt_schema"."stg_contoso__stores" rename to "stg_contoso__stores__dbt_backup"
[0m17:22:07.467387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.472464 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.473500 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
alter table "contosodb"."dbt_schema"."stg_contoso__stores__dbt_tmp" rename to "stg_contoso__stores"
[0m17:22:07.474850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:07.478452 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: COMMIT
[0m17:22:07.479374 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.480240 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: COMMIT
[0m17:22:07.482512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:07.487453 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__stores__dbt_backup"
[0m17:22:07.490959 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__stores"
[0m17:22:07.491944 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__stores__dbt_backup" cascade
[0m17:22:07.494463 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:07.497287 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__stores (execute): 17:22:07.434693 => 17:22:07.496786
[0m17:22:07.498327 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__stores: Close
[0m17:22:07.499885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5212bd-fa8e-4ad5-b5e0-13f6d416f9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158dce50>]}
[0m17:22:07.501325 [info ] [Thread-1 (]: 9 of 10 OK created sql view model dbt_schema.stg_contoso__stores ............... [[32mCREATE VIEW[0m in 0.07s]
[0m17:22:07.502675 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__stores
[0m17:22:07.503658 [debug] [Thread-1 (]: Began running node model.postgres_dbt.dbt_sales
[0m17:22:07.504607 [info ] [Thread-1 (]: 10 of 10 SKIP relation dbt_schema.dbt_sales .................................... [[33mSKIP[0m]
[0m17:22:07.505724 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.dbt_sales
[0m17:22:07.509682 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:07.510650 [debug] [MainThread]: On master: BEGIN
[0m17:22:07.511647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:07.520456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:22:07.521438 [debug] [MainThread]: On master: COMMIT
[0m17:22:07.522477 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:07.523729 [debug] [MainThread]: On master: COMMIT
[0m17:22:07.525434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:22:07.527002 [debug] [MainThread]: On master: Close
[0m17:22:07.529033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:07.530424 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__stores' was properly closed.
[0m17:22:07.531588 [info ] [MainThread]: 
[0m17:22:07.532773 [info ] [MainThread]: Finished running 9 view models, 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m17:22:07.536376 [debug] [MainThread]: Command end result
[0m17:22:07.548168 [info ] [MainThread]: 
[0m17:22:07.549200 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:22:07.550142 [info ] [MainThread]: 
[0m17:22:07.551608 [error] [MainThread]:   Database Error in model dbt_channel_stg (models/dbt_channel_stg.sql)
  relation "public.dim_channel" does not exist
  LINE 7:     select * from public.dim_channel
                            ^
  compiled Code at target/run/postgres_dbt/models/dbt_channel_stg.sql
[0m17:22:07.552632 [info ] [MainThread]: 
[0m17:22:07.553604 [error] [MainThread]:   Database Error in model dbt_factonlinesales_stg (models/dbt_factonlinesales_stg.sql)
  relation "public.factonlinesales" does not exist
  LINE 7: ..., salesquantity, salesamount, discountamount from public.fac...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_factonlinesales_stg.sql
[0m17:22:07.554758 [info ] [MainThread]: 
[0m17:22:07.555891 [error] [MainThread]:   Database Error in model dbt_factsales (models/dbt_factsales.sql)
  relation "factonlinesales" does not exist
  LINE 16:     FROM FACTONLINESALES FS
                    ^
  compiled Code at target/run/postgres_dbt/models/dbt_factsales.sql
[0m17:22:07.557111 [info ] [MainThread]: 
[0m17:22:07.558127 [error] [MainThread]:   Database Error in model dbt_product_stg (models/dbt_product_stg.sql)
  relation "public.dimproduct" does not exist
  LINE 7: ...key , d.productname, pc.productcategoryname  from public.dim...
                                                               ^
  compiled Code at target/run/postgres_dbt/models/dbt_product_stg.sql
[0m17:22:07.559554 [info ] [MainThread]: 
[0m17:22:07.560736 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=4 SKIP=1 TOTAL=10
[0m17:22:07.562890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7592804, "process_user_time": 4.058396, "process_kernel_time": 0.306028, "process_mem_max_rss": "113377280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:07.564053 [debug] [MainThread]: Command `dbt run` failed at 17:22:07.563743 after 1.76 seconds
[0m17:22:07.564993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112455660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153e6e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156f39d0>]}
[0m17:22:07.565995 [debug] [MainThread]: Flushing usage events
[0m21:29:52.990587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6e530>]}


============================== 21:29:53.006090 | 9db3db53-76f3-4708-b240-ff0e33ab572f ==============================
[0m21:29:53.006090 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:29:53.007827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:53.789827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6e7a0>]}
[0m21:29:53.910896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee73d0>]}
[0m21:29:53.914419 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:29:53.967652 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:29:54.102959 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 0 files added, 1 files changed.
[0m21:29:54.104069 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/dbt_channel_stg.sql
[0m21:29:54.104913 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/dbt_factonlinesales_stg.sql
[0m21:29:54.105728 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/dbt_product_stg.sql
[0m21:29:54.106530 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/staging/stg_contoso__stores.sql
[0m21:29:54.107335 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/dbt_factsales.sql
[0m21:29:54.108170 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/dbt_sales.sql
[0m21:29:54.109169 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales.sql
[0m21:29:54.320071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:29:54.330045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c600d0>]}
[0m21:29:54.354099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af9180>]}
[0m21:29:54.355612 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:29:54.356785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af9210>]}
[0m21:29:54.359534 [info ] [MainThread]: 
[0m21:29:54.361202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:54.363879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:29:54.381635 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:29:54.382577 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:29:54.383407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:54.469056 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:29:54.472011 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:29:54.475034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:29:54.483772 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:29:54.485028 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:29:54.485898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:54.492278 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:29:54.493195 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:29:54.494068 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:29:54.509318 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:29:54.513060 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:29:54.514454 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:29:54.576093 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:54.577158 [debug] [MainThread]: On master: BEGIN
[0m21:29:54.578053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:54.585721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:29:54.586715 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:54.587712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:54.642822 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:29:54.644954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6e380>]}
[0m21:29:54.646007 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:54.647062 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:54.647908 [debug] [MainThread]: On master: BEGIN
[0m21:29:54.648940 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:29:54.649772 [debug] [MainThread]: On master: COMMIT
[0m21:29:54.650603 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:54.651430 [debug] [MainThread]: On master: COMMIT
[0m21:29:54.652427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:29:54.653281 [debug] [MainThread]: On master: Close
[0m21:29:54.654628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:54.655735 [info ] [MainThread]: 
[0m21:29:54.659942 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores
[0m21:29:54.661178 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_schema.int_contoso__stores ..................... [RUN]
[0m21:29:54.663076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores)
[0m21:29:54.664357 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores
[0m21:29:54.675674 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.677190 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (compile): 21:29:54.665125 => 21:29:54.676695
[0m21:29:54.678227 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores
[0m21:29:54.732246 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.733693 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.734680 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: BEGIN
[0m21:29:54.735567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:54.742120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:29:54.743124 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.744028 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME,
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m21:29:54.782185 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:29:54.793500 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.794640 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores" rename to "int_contoso__stores__dbt_backup"
[0m21:29:54.796525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:54.801893 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.802876 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp" rename to "int_contoso__stores"
[0m21:29:54.804356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:54.827430 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:29:54.828484 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.829380 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:29:54.831530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:29:54.842010 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup"
[0m21:29:54.848879 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:29:54.849898 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup" cascade
[0m21:29:54.858325 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:29:54.861349 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (execute): 21:29:54.678806 => 21:29:54.860835
[0m21:29:54.862428 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: Close
[0m21:29:54.864019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d27bb0>]}
[0m21:29:54.865466 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_schema.int_contoso__stores ................ [[32mCREATE VIEW[0m in 0.20s]
[0m21:29:54.866828 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores
[0m21:29:54.867837 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m21:29:54.868851 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m21:29:54.870245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores, now model.postgres_dbt.stg_contoso__channels)
[0m21:29:54.871350 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m21:29:54.874722 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.876673 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 21:29:54.872066 => 21:29:54.875899
[0m21:29:54.877757 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m21:29:54.888860 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.890711 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.891708 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m21:29:54.892592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:54.899120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:29:54.900106 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.901008 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m21:29:54.905292 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:29:54.911083 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.912052 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m21:29:54.913461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:54.918404 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.919354 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m21:29:54.920950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:54.924773 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:29:54.925723 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.926597 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:29:54.929406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:29:54.934856 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m21:29:54.937209 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:29:54.938129 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m21:29:54.940760 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:29:54.943660 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 21:29:54.878429 => 21:29:54.943159
[0m21:29:54.944721 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m21:29:54.946348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d1aad0>]}
[0m21:29:54.947829 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.08s]
[0m21:29:54.949183 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m21:29:54.950181 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m21:29:54.951185 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m21:29:54.952608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m21:29:54.953558 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m21:29:54.957068 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m21:29:54.958963 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 21:29:54.954151 => 21:29:54.958269
[0m21:29:54.960392 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m21:29:54.970945 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m21:29:54.972387 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:29:54.973314 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m21:29:54.974229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:54.981025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:29:54.982005 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:29:54.982938 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m21:29:54.986428 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:29:54.991590 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:29:54.992550 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m21:29:54.994105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:54.999249 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:29:55.000194 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m21:29:55.001538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:55.005284 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:29:55.006259 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:29:55.007141 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:29:55.009390 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:29:55.014678 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m21:29:55.016719 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:29:55.017601 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m21:29:55.020104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:29:55.022673 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 21:29:54.961582 => 21:29:55.022241
[0m21:29:55.023613 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m21:29:55.025007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae6aa0>]}
[0m21:29:55.026310 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.07s]
[0m21:29:55.027588 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m21:29:55.028564 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m21:29:55.029607 [info ] [Thread-1 (]: 4 of 5 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m21:29:55.031135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m21:29:55.032499 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m21:29:55.037321 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.039734 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 21:29:55.033274 => 21:29:55.038943
[0m21:29:55.042894 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m21:29:55.052917 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.057463 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.058470 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m21:29:55.059377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:55.070823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:29:55.071839 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.073446 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m21:29:55.083614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:29:55.090693 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.091875 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m21:29:55.093974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:55.099815 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.100818 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m21:29:55.102313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:29:55.106100 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:29:55.107062 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.107963 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:29:55.109429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:29:55.115492 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m21:29:55.117573 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:29:55.118535 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m21:29:55.121145 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:29:55.123861 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 21:29:55.043594 => 21:29:55.123385
[0m21:29:55.124872 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m21:29:55.126873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da3fd0>]}
[0m21:29:55.128315 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:29:55.129823 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m21:29:55.131288 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m21:29:55.132501 [info ] [Thread-1 (]: 5 of 5 START sql table model dbt_schema.sales .................................. [RUN]
[0m21:29:55.133845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.sales)
[0m21:29:55.135000 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m21:29:55.141598 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m21:29:55.144691 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 21:29:55.135896 => 21:29:55.143722
[0m21:29:55.145808 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m21:29:55.194842 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales"
[0m21:29:55.196532 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:29:55.197483 [debug] [Thread-1 (]: On model.postgres_dbt.sales: BEGIN
[0m21:29:55.198358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:55.207594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:29:55.209429 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:29:55.210652 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */

  
    

  create  table "contosodb"."dbt_schema"."sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
scp.productname,
st.storename,
scc.channelname,
s.unitcost,
s.unitprice,
s.salesquantity,
s.discountamount,
s.totalcost,
s.salesamount,
s.profit 
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
on s.storekey = st.storekey 
JOIN "contosodb"."dbt_schema"."stg_contoso__products" scp 
ON scp.productkey = s.productkey 
JOIN "contosodb"."dbt_schema"."stg_contoso__channels" scc 
ON s.channelkey = scc.channelkey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m21:30:19.139147 [debug] [Thread-1 (]: SQL status: SELECT 2897216 in 24.0 seconds
[0m21:30:19.144991 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:30:19.146518 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales__dbt_tmp" rename to "sales"
[0m21:30:19.724194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.0 seconds
[0m21:30:19.734348 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:30:19.735580 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:30:19.736532 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:30:19.738393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:19.743362 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."sales__dbt_backup"
[0m21:30:19.748019 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:30:19.749061 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
drop table if exists "contosodb"."dbt_schema"."sales__dbt_backup" cascade
[0m21:30:19.750414 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:19.752948 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 21:29:55.146404 => 21:30:19.752510
[0m21:30:19.753931 [debug] [Thread-1 (]: On model.postgres_dbt.sales: Close
[0m21:30:19.755282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db3db53-76f3-4708-b240-ff0e33ab572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d32c20>]}
[0m21:30:19.756640 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dbt_schema.sales ............................. [[32mSELECT 2897216[0m in 24.62s]
[0m21:30:19.758261 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m21:30:19.760357 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:19.761238 [debug] [MainThread]: On master: BEGIN
[0m21:30:19.762057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:19.788412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:19.789575 [debug] [MainThread]: On master: COMMIT
[0m21:30:19.790577 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:19.791461 [debug] [MainThread]: On master: COMMIT
[0m21:30:19.792593 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:19.793511 [debug] [MainThread]: On master: Close
[0m21:30:19.795277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:19.796217 [debug] [MainThread]: Connection 'model.postgres_dbt.sales' was properly closed.
[0m21:30:19.797474 [info ] [MainThread]: 
[0m21:30:19.798606 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 25.44 seconds (25.44s).
[0m21:30:19.800666 [debug] [MainThread]: Command end result
[0m21:30:19.812662 [info ] [MainThread]: 
[0m21:30:19.813821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:19.814797 [info ] [MainThread]: 
[0m21:30:19.815754 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:30:19.847509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.975658, "process_user_time": 4.557005, "process_kernel_time": 0.901653, "process_mem_max_rss": "111890432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:19.848933 [debug] [MainThread]: Command `dbt run` succeeded at 21:30:19.848572 after 26.98 seconds
[0m21:30:19.849997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af93c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8d1e0>]}
[0m21:30:19.851011 [debug] [MainThread]: Flushing usage events
[0m21:33:17.000713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109019b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b2860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b2500>]}


============================== 21:33:17.006032 | 4fc860c5-184d-4fdf-9cac-0788fd2b6e32 ==============================
[0m21:33:17.006032 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:33:17.007238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:17.270484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b2770>]}
[0m21:33:17.391216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b909060>]}
[0m21:33:17.392834 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:33:17.413287 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:33:17.470252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:33:17.471409 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/marts/store_sales.sql
[0m21:33:17.472554 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales.sql
[0m21:33:17.658540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:33:17.665929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2bc0d0>]}
[0m21:33:17.680174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c127e50>]}
[0m21:33:17.681224 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:33:17.682203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c127f10>]}
[0m21:33:17.685448 [info ] [MainThread]: 
[0m21:33:17.688492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:17.691142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:33:17.710142 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:33:17.711195 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:33:17.712079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:17.747823 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:33:17.750213 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:33:17.754547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:33:17.763161 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:33:17.764077 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:33:17.764935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:17.773263 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:17.774844 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:33:17.776263 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:33:17.785081 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:33:17.787776 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:33:17.788777 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:33:17.844762 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:17.845753 [debug] [MainThread]: On master: BEGIN
[0m21:33:17.846646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:17.853306 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:17.854202 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:17.855144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:17.886957 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:33:17.888989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2be6e0>]}
[0m21:33:17.889965 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:17.890947 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:17.891773 [debug] [MainThread]: On master: BEGIN
[0m21:33:17.892828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:17.893760 [debug] [MainThread]: On master: COMMIT
[0m21:33:17.894611 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:17.895418 [debug] [MainThread]: On master: COMMIT
[0m21:33:17.896366 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:17.897198 [debug] [MainThread]: On master: Close
[0m21:33:17.898556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:33:17.899774 [info ] [MainThread]: 
[0m21:33:17.902475 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores
[0m21:33:17.903530 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_schema.int_contoso__stores ..................... [RUN]
[0m21:33:17.905040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores)
[0m21:33:17.906106 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores
[0m21:33:17.916842 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores"
[0m21:33:17.918422 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (compile): 21:33:17.906752 => 21:33:17.917897
[0m21:33:17.919547 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores
[0m21:33:17.970977 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores"
[0m21:33:17.972399 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:33:17.973317 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: BEGIN
[0m21:33:17.974200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:17.980742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:17.981712 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:33:17.982619 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME,
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m21:33:17.988282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:33:17.996959 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:33:17.997934 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores" rename to "int_contoso__stores__dbt_backup"
[0m21:33:17.999311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.004300 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:33:18.005232 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp" rename to "int_contoso__stores"
[0m21:33:18.006772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.029325 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:33:18.030460 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:33:18.031355 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:33:18.033585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:18.044226 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup"
[0m21:33:18.051020 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:33:18.051999 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup" cascade
[0m21:33:18.055074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:33:18.058658 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (execute): 21:33:17.920257 => 21:33:18.058133
[0m21:33:18.059625 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: Close
[0m21:33:18.061069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c358580>]}
[0m21:33:18.062409 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_schema.int_contoso__stores ................ [[32mCREATE VIEW[0m in 0.16s]
[0m21:33:18.063790 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores
[0m21:33:18.064779 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m21:33:18.065915 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m21:33:18.067379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores, now model.postgres_dbt.stg_contoso__channels)
[0m21:33:18.068304 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m21:33:18.072983 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.076883 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 21:33:18.068886 => 21:33:18.075765
[0m21:33:18.078576 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m21:33:18.088156 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.089490 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.090399 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m21:33:18.091277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:18.098111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:18.099188 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.100098 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m21:33:18.104708 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:33:18.110147 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.111193 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m21:33:18.112789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.117732 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.118798 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m21:33:18.120130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.123646 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:33:18.124558 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.125430 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:33:18.127623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:18.132825 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m21:33:18.134919 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:33:18.135980 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m21:33:18.138424 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:33:18.140922 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 21:33:18.079958 => 21:33:18.140487
[0m21:33:18.141852 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m21:33:18.143327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c127be0>]}
[0m21:33:18.144588 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.08s]
[0m21:33:18.145846 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m21:33:18.146835 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m21:33:18.147847 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m21:33:18.149244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m21:33:18.150176 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m21:33:18.153248 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.154916 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 21:33:18.150770 => 21:33:18.154254
[0m21:33:18.156088 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m21:33:18.166358 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.168056 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.169704 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m21:33:18.170749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:18.177115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:18.178083 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.179225 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m21:33:18.183125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:33:18.189105 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.190065 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m21:33:18.191443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.196516 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.197620 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m21:33:18.198966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.202735 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:33:18.203673 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.204615 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:33:18.206236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:18.210855 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m21:33:18.212884 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:33:18.213916 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m21:33:18.216271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:33:18.218683 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 21:33:18.156707 => 21:33:18.218246
[0m21:33:18.219628 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m21:33:18.221274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1260e0>]}
[0m21:33:18.222699 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.07s]
[0m21:33:18.224190 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m21:33:18.225244 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m21:33:18.226581 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m21:33:18.228523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m21:33:18.229720 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m21:33:18.233120 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.234891 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 21:33:18.230359 => 21:33:18.234288
[0m21:33:18.235854 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m21:33:18.246216 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.248068 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.249394 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m21:33:18.250300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:18.260148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:18.261130 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.262044 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m21:33:18.267412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:33:18.273037 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.274009 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m21:33:18.275945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.282441 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.283431 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m21:33:18.285419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:18.289442 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:33:18.290384 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.291272 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:33:18.293458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:18.300144 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m21:33:18.302302 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:33:18.303250 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m21:33:18.305729 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:33:18.308146 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 21:33:18.236457 => 21:33:18.307713
[0m21:33:18.309062 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m21:33:18.310611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3cadd0>]}
[0m21:33:18.312037 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.08s]
[0m21:33:18.313387 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m21:33:18.314784 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m21:33:18.315851 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_schema.sales .................................. [RUN]
[0m21:33:18.317199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.sales)
[0m21:33:18.318112 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m21:33:18.323453 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m21:33:18.325306 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 21:33:18.318688 => 21:33:18.324442
[0m21:33:18.326253 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m21:33:18.364432 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales"
[0m21:33:18.366704 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:33:18.367886 [debug] [Thread-1 (]: On model.postgres_dbt.sales: BEGIN
[0m21:33:18.369119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:18.375695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:18.376773 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:33:18.377860 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */

  
    

  create  table "contosodb"."dbt_schema"."sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
scp.productname,
st.storename,
scc.channelname,
s.unitcost,
s.unitprice,
s.salesquantity,
s.discountamount,
s.totalcost,
s.salesamount,
s.profit 
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
JOIN "contosodb"."dbt_schema"."stg_contoso__products" scp 
ON scp.productkey = s.productkey 
JOIN "contosodb"."dbt_schema"."stg_contoso__channels" scc 
ON s.channelkey = scc.channelkey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m21:33:44.005194 [debug] [Thread-1 (]: SQL status: SELECT 2897216 in 26.0 seconds
[0m21:33:44.011153 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:33:44.012218 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales" rename to "sales__dbt_backup"
[0m21:33:44.013707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:44.019123 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:33:44.020181 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales__dbt_tmp" rename to "sales"
[0m21:33:44.098951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:33:44.109251 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:33:44.110335 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:33:44.111338 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:33:44.113772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:33:44.118424 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."sales__dbt_backup"
[0m21:33:44.122929 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:33:44.123893 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
drop table if exists "contosodb"."dbt_schema"."sales__dbt_backup" cascade
[0m21:33:44.159456 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:33:44.162953 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 21:33:18.326845 => 21:33:44.162368
[0m21:33:44.164040 [debug] [Thread-1 (]: On model.postgres_dbt.sales: Close
[0m21:33:44.165656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2de470>]}
[0m21:33:44.167332 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_schema.sales ............................. [[32mSELECT 2897216[0m in 25.85s]
[0m21:33:44.168921 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m21:33:44.170077 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m21:33:44.171193 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m21:33:44.172606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.sales, now model.postgres_dbt.store_sales)
[0m21:33:44.173543 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m21:33:44.178488 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m21:33:44.179977 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 21:33:44.174239 => 21:33:44.179520
[0m21:33:44.180898 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m21:33:44.189741 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m21:33:44.191405 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:33:44.192472 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m21:33:44.193387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:44.211955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:44.212998 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:33:44.213961 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m21:33:44.222124 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "st.storename" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15: st.storename,
         ^

[0m21:33:44.223173 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: ROLLBACK
[0m21:33:44.224668 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 21:33:44.181470 => 21:33:44.224196
[0m21:33:44.225606 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m21:33:44.250134 [debug] [Thread-1 (]: Database Error in model store_sales (models/marts/store_sales.sql)
  column "st.storename" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15: st.storename,
           ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m21:33:44.251613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc860c5-184d-4fdf-9cac-0788fd2b6e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f8760>]}
[0m21:33:44.253196 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model dbt_schema.store_sales ................... [[31mERROR[0m in 0.08s]
[0m21:33:44.255022 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m21:33:44.257369 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:44.258401 [debug] [MainThread]: On master: BEGIN
[0m21:33:44.259377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:44.266498 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:44.267437 [debug] [MainThread]: On master: COMMIT
[0m21:33:44.268272 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:44.269100 [debug] [MainThread]: On master: COMMIT
[0m21:33:44.270033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:44.270867 [debug] [MainThread]: On master: Close
[0m21:33:44.272156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:44.273100 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m21:33:44.274014 [info ] [MainThread]: 
[0m21:33:44.274948 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 26.59 seconds (26.59s).
[0m21:33:44.277410 [debug] [MainThread]: Command end result
[0m21:33:44.288977 [info ] [MainThread]: 
[0m21:33:44.290415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:33:44.291451 [info ] [MainThread]: 
[0m21:33:44.292337 [error] [MainThread]:   Database Error in model store_sales (models/marts/store_sales.sql)
  column "st.storename" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15: st.storename,
           ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m21:33:44.293205 [info ] [MainThread]: 
[0m21:33:44.294067 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:33:44.296115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.367285, "process_user_time": 4.027234, "process_kernel_time": 0.305798, "process_mem_max_rss": "111939584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:44.297399 [debug] [MainThread]: Command `dbt run` failed at 21:33:44.297075 after 27.37 seconds
[0m21:33:44.298988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109019b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ff3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3fbd90>]}
[0m21:33:44.300101 [debug] [MainThread]: Flushing usage events
[0m21:34:12.478688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c81b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21e500>]}


============================== 21:34:12.483990 | b6ef962b-946e-4df3-8cdd-33d92c4c1462 ==============================
[0m21:34:12.483990 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:34:12.485183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:34:12.758632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21e770>]}
[0m21:34:12.880054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a575060>]}
[0m21:34:12.881451 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:34:12.905179 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:34:12.975889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:12.977214 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/store_sales.sql
[0m21:34:13.158537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:34:13.165883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af180d0>]}
[0m21:34:13.181568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad98160>]}
[0m21:34:13.183144 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:34:13.184783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109830a90>]}
[0m21:34:13.187329 [info ] [MainThread]: 
[0m21:34:13.188967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:13.191464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:34:13.211993 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:34:13.213057 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:34:13.213915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:13.255728 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:34:13.258060 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:34:13.260961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:34:13.270489 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:34:13.271382 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:34:13.272200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:13.278312 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.279219 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:34:13.280081 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:34:13.286026 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:34:13.288668 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:34:13.289678 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:34:13.347689 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:13.348691 [debug] [MainThread]: On master: BEGIN
[0m21:34:13.349573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:13.355870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.356760 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:13.357671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:13.389524 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:34:13.391513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af2a920>]}
[0m21:34:13.392494 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:13.393467 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:13.394304 [debug] [MainThread]: On master: BEGIN
[0m21:34:13.395355 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.396197 [debug] [MainThread]: On master: COMMIT
[0m21:34:13.397034 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:13.397850 [debug] [MainThread]: On master: COMMIT
[0m21:34:13.398781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:13.399621 [debug] [MainThread]: On master: Close
[0m21:34:13.400878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:34:13.401916 [info ] [MainThread]: 
[0m21:34:13.404636 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores
[0m21:34:13.405705 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_schema.int_contoso__stores ..................... [RUN]
[0m21:34:13.407296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores)
[0m21:34:13.408363 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores
[0m21:34:13.419658 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.421947 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (compile): 21:34:13.409027 => 21:34:13.420976
[0m21:34:13.423400 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores
[0m21:34:13.473740 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.475176 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.476094 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: BEGIN
[0m21:34:13.476975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:13.483556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.484625 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.485575 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME,
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m21:34:13.490168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:34:13.498955 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.499937 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores" rename to "int_contoso__stores__dbt_backup"
[0m21:34:13.501379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.506975 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.507940 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp" rename to "int_contoso__stores"
[0m21:34:13.509272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.531537 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:34:13.532686 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.533610 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:34:13.535052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:13.546539 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup"
[0m21:34:13.553318 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:34:13.554299 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup" cascade
[0m21:34:13.557332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:13.560282 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (execute): 21:34:13.424085 => 21:34:13.559772
[0m21:34:13.561314 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: Close
[0m21:34:13.562998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb3160>]}
[0m21:34:13.564405 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_schema.int_contoso__stores ................ [[32mCREATE VIEW[0m in 0.16s]
[0m21:34:13.565732 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores
[0m21:34:13.566736 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m21:34:13.567813 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m21:34:13.569158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores, now model.postgres_dbt.stg_contoso__channels)
[0m21:34:13.570091 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m21:34:13.573442 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.575571 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 21:34:13.570677 => 21:34:13.574762
[0m21:34:13.577210 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m21:34:13.589479 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.590861 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.591763 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m21:34:13.592634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:13.599010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.599982 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.601412 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m21:34:13.605939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:34:13.611104 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.612057 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m21:34:13.613399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.618295 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.619239 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m21:34:13.620661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.624600 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:34:13.625667 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.626555 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:34:13.628029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:13.632990 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m21:34:13.635152 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:34:13.636190 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m21:34:13.638845 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:13.641630 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 21:34:13.578690 => 21:34:13.641190
[0m21:34:13.642547 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m21:34:13.643948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb0e50>]}
[0m21:34:13.645196 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.08s]
[0m21:34:13.646459 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m21:34:13.647450 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m21:34:13.648452 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m21:34:13.649815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m21:34:13.650735 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m21:34:13.654431 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.656079 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 21:34:13.651404 => 21:34:13.655502
[0m21:34:13.657040 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m21:34:13.668464 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.669830 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.670736 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m21:34:13.671825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:13.678282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.679252 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.680141 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m21:34:13.683932 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:34:13.691915 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.693006 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m21:34:13.694436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.699526 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.700606 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m21:34:13.701966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.705733 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:34:13.706664 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.707540 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:34:13.709399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:13.714314 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m21:34:13.716504 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:34:13.717425 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m21:34:13.719887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:13.722547 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 21:34:13.657833 => 21:34:13.722112
[0m21:34:13.723459 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m21:34:13.724858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb1630>]}
[0m21:34:13.726091 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.08s]
[0m21:34:13.727433 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m21:34:13.728414 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m21:34:13.729492 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m21:34:13.730874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m21:34:13.731815 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m21:34:13.735087 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.736699 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 21:34:13.732411 => 21:34:13.736100
[0m21:34:13.738012 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m21:34:13.747690 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.749559 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.750581 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m21:34:13.751462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:13.758234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.759214 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.760273 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m21:34:13.765047 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:34:13.770507 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.771460 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m21:34:13.773085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.778559 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.779600 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m21:34:13.781012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:13.784633 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:34:13.785547 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.786415 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:34:13.788594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:13.795210 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m21:34:13.797368 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:34:13.798312 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m21:34:13.800651 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:34:13.803030 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 21:34:13.738710 => 21:34:13.802600
[0m21:34:13.803950 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m21:34:13.805266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b036e30>]}
[0m21:34:13.806511 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.07s]
[0m21:34:13.807771 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m21:34:13.809144 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m21:34:13.810185 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_schema.sales .................................. [RUN]
[0m21:34:13.811485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.sales)
[0m21:34:13.812620 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m21:34:13.818226 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m21:34:13.820868 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 21:34:13.813347 => 21:34:13.819934
[0m21:34:13.822224 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m21:34:13.857699 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales"
[0m21:34:13.859116 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:34:13.860580 [debug] [Thread-1 (]: On model.postgres_dbt.sales: BEGIN
[0m21:34:13.861639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:13.868225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:13.869192 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:34:13.870334 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */

  
    

  create  table "contosodb"."dbt_schema"."sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
scp.productname,
st.storename,
scc.channelname,
s.unitcost,
s.unitprice,
s.salesquantity,
s.discountamount,
s.totalcost,
s.salesamount,
s.profit 
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
JOIN "contosodb"."dbt_schema"."stg_contoso__products" scp 
ON scp.productkey = s.productkey 
JOIN "contosodb"."dbt_schema"."stg_contoso__channels" scc 
ON s.channelkey = scc.channelkey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m21:34:38.567988 [debug] [Thread-1 (]: SQL status: SELECT 2897216 in 25.0 seconds
[0m21:34:38.573267 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:34:38.574233 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales" rename to "sales__dbt_backup"
[0m21:34:38.577812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:38.583000 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:34:38.584027 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales__dbt_tmp" rename to "sales"
[0m21:34:38.846916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:34:38.859619 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:34:38.860627 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:34:38.861518 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:34:38.894962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:34:38.901111 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."sales__dbt_backup"
[0m21:34:38.906489 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:34:38.907544 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
drop table if exists "contosodb"."dbt_schema"."sales__dbt_backup" cascade
[0m21:34:38.932360 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:34:38.935262 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 21:34:13.823102 => 21:34:38.934769
[0m21:34:38.936322 [debug] [Thread-1 (]: On model.postgres_dbt.sales: Close
[0m21:34:38.937902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aef10c0>]}
[0m21:34:38.939322 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_schema.sales ............................. [[32mSELECT 2897216[0m in 25.13s]
[0m21:34:38.940800 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m21:34:38.941922 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m21:34:38.943149 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m21:34:38.944556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.sales, now model.postgres_dbt.store_sales)
[0m21:34:38.945491 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m21:34:38.950694 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m21:34:38.952685 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 21:34:38.946079 => 21:34:38.951974
[0m21:34:38.953935 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m21:34:38.969348 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m21:34:38.970807 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:34:38.971718 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m21:34:38.972633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:38.994834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:38.995859 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:34:38.996858 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
ORDER BY s.salesamount DESC
  );
  
[0m21:34:38.999632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "st.storename" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15: st.storename,
         ^

[0m21:34:39.000950 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: ROLLBACK
[0m21:34:39.003228 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 21:34:38.955193 => 21:34:39.002669
[0m21:34:39.004270 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m21:34:39.008838 [debug] [Thread-1 (]: Database Error in model store_sales (models/marts/store_sales.sql)
  column "st.storename" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15: st.storename,
           ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m21:34:39.009927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ef962b-946e-4df3-8cdd-33d92c4c1462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5db940>]}
[0m21:34:39.011097 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model dbt_schema.store_sales ................... [[31mERROR[0m in 0.07s]
[0m21:34:39.012644 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m21:34:39.015222 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:39.016158 [debug] [MainThread]: On master: BEGIN
[0m21:34:39.017090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:39.023640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:39.024580 [debug] [MainThread]: On master: COMMIT
[0m21:34:39.025497 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:39.026392 [debug] [MainThread]: On master: COMMIT
[0m21:34:39.027394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:39.028239 [debug] [MainThread]: On master: Close
[0m21:34:39.029921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:39.030906 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m21:34:39.031857 [info ] [MainThread]: 
[0m21:34:39.032993 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 25.84 seconds (25.84s).
[0m21:34:39.038668 [debug] [MainThread]: Command end result
[0m21:34:39.055376 [info ] [MainThread]: 
[0m21:34:39.056628 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:34:39.058108 [info ] [MainThread]: 
[0m21:34:39.059651 [error] [MainThread]:   Database Error in model store_sales (models/marts/store_sales.sql)
  column "st.storename" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15: st.storename,
           ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m21:34:39.060746 [info ] [MainThread]: 
[0m21:34:39.061851 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m21:34:39.065163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.659513, "process_user_time": 3.974393, "process_kernel_time": 0.268473, "process_mem_max_rss": "112476160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:34:39.066616 [debug] [MainThread]: Command `dbt run` failed at 21:34:39.066232 after 26.66 seconds
[0m21:34:39.068155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c81b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d9300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b063ac0>]}
[0m21:34:39.069668 [debug] [MainThread]: Flushing usage events
[0m21:35:48.568315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10270b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca24d0>]}


============================== 21:35:48.573526 | d17aa0a5-6594-425d-8d83-b5d75931aac3 ==============================
[0m21:35:48.573526 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:35:48.574720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m store_sales.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:48.842970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca2740>]}
[0m21:35:48.963561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c621a0>]}
[0m21:35:48.965004 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:35:48.986341 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:35:49.042793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:49.044082 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/store_sales.sql
[0m21:35:49.225146 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:35:49.233033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c40d0>]}
[0m21:35:49.248979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105830130>]}
[0m21:35:49.250027 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:35:49.251020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105114f70>]}
[0m21:35:49.253770 [info ] [MainThread]: 
[0m21:35:49.255464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:49.257839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:35:49.274785 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:35:49.276734 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:35:49.279475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:49.318837 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:35:49.321263 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:35:49.324245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:35:49.332972 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:35:49.333875 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:35:49.334681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:49.341540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:35:49.342438 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:35:49.343289 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:35:49.349333 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:35:49.352166 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:35:49.353218 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:35:49.408893 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.409901 [debug] [MainThread]: On master: BEGIN
[0m21:35:49.410790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:49.417209 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:49.418096 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.419011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:49.450905 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:35:49.452891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d2a40>]}
[0m21:35:49.453861 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:49.454843 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.455679 [debug] [MainThread]: On master: BEGIN
[0m21:35:49.456750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:49.457608 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.458448 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.459283 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.460216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:49.461059 [debug] [MainThread]: On master: Close
[0m21:35:49.462454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:49.463602 [info ] [MainThread]: 
[0m21:35:49.466233 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m21:35:49.467288 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m21:35:49.468591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.store_sales)
[0m21:35:49.469641 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m21:35:49.480988 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m21:35:49.482745 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 21:35:49.470318 => 21:35:49.482080
[0m21:35:49.484016 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m21:35:49.539646 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m21:35:49.541174 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:35:49.542114 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m21:35:49.542994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:49.549485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:35:49.550466 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:35:49.551379 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey
GROUP BY st.storename
ORDER BY s.salesamount DESC
  );
  
[0m21:35:49.554298 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "s.salesamount" must appear in the GROUP BY clause or be used in an aggregate function
LINE 23: ORDER BY s.salesamount DESC
                  ^

[0m21:35:49.555264 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: ROLLBACK
[0m21:35:49.556643 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 21:35:49.484741 => 21:35:49.556189
[0m21:35:49.557547 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m21:35:49.560932 [debug] [Thread-1 (]: Database Error in model store_sales (models/marts/store_sales.sql)
  column "s.salesamount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 23: ORDER BY s.salesamount DESC
                    ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m21:35:49.561974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd17aa0a5-6594-425d-8d83-b5d75931aac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e2cb0>]}
[0m21:35:49.563168 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_schema.store_sales ................... [[31mERROR[0m in 0.09s]
[0m21:35:49.564460 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m21:35:49.566460 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.567335 [debug] [MainThread]: On master: BEGIN
[0m21:35:49.568179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:49.575912 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:49.577526 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.578832 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.580186 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.581232 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:49.582092 [debug] [MainThread]: On master: Close
[0m21:35:49.583375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:49.584297 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m21:35:49.585164 [info ] [MainThread]: 
[0m21:35:49.586174 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m21:35:49.587543 [debug] [MainThread]: Command end result
[0m21:35:49.601592 [info ] [MainThread]: 
[0m21:35:49.602954 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:35:49.603902 [info ] [MainThread]: 
[0m21:35:49.604823 [error] [MainThread]:   Database Error in model store_sales (models/marts/store_sales.sql)
  column "s.salesamount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 23: ORDER BY s.salesamount DESC
                    ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m21:35:49.605772 [info ] [MainThread]: 
[0m21:35:49.606709 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:35:49.609140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1142011, "process_user_time": 3.58058, "process_kernel_time": 0.26277, "process_mem_max_rss": "110587904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:49.611231 [debug] [MainThread]: Command `dbt run` failed at 21:35:49.610721 after 1.12 seconds
[0m21:35:49.612366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10270b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d19f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105194ac0>]}
[0m21:35:49.613340 [debug] [MainThread]: Flushing usage events
[0m21:36:08.421972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ae6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ee8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ee590>]}


============================== 21:36:08.429336 | a6e856de-814f-49da-b284-bc8389c35ebc ==============================
[0m21:36:08.429336 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:36:08.430569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m store_sales.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:08.690407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ee800>]}
[0m21:36:08.810063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de2710>]}
[0m21:36:08.811614 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:36:08.832213 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:36:08.888606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:36:08.890192 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/store_sales.sql
[0m21:36:09.071710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:36:09.079233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e80d0>]}
[0m21:36:09.095446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647c280>]}
[0m21:36:09.097095 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:36:09.098268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cac2e0>]}
[0m21:36:09.100696 [info ] [MainThread]: 
[0m21:36:09.102433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:09.106597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:36:09.122066 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:36:09.123056 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:36:09.124016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:09.164497 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:36:09.167481 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:36:09.170237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:36:09.179015 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:36:09.179932 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:36:09.180736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:09.187020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:36:09.187896 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:36:09.188807 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:36:09.194735 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:36:09.197347 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:36:09.198331 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:36:09.253586 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:09.254565 [debug] [MainThread]: On master: BEGIN
[0m21:36:09.255429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:09.261800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:36:09.262682 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:09.263587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:36:09.295329 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:36:09.297297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f51e0>]}
[0m21:36:09.298259 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:09.299254 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:09.300100 [debug] [MainThread]: On master: BEGIN
[0m21:36:09.301138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:36:09.301972 [debug] [MainThread]: On master: COMMIT
[0m21:36:09.302885 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:09.303687 [debug] [MainThread]: On master: COMMIT
[0m21:36:09.304608 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:36:09.305449 [debug] [MainThread]: On master: Close
[0m21:36:09.306709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:36:09.307743 [info ] [MainThread]: 
[0m21:36:09.310383 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m21:36:09.311427 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m21:36:09.312717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.store_sales)
[0m21:36:09.313774 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m21:36:09.326908 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m21:36:09.328384 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 21:36:09.314470 => 21:36:09.327925
[0m21:36:09.329273 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m21:36:09.383250 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m21:36:09.384667 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:36:09.385564 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m21:36:09.386422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:09.392817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:36:09.393801 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:36:09.394700 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey
GROUP BY st.storename
ORDER BY TotalSales DESC
  );
  
[0m21:36:11.363431 [debug] [Thread-1 (]: SQL status: SELECT 306 in 2.0 seconds
[0m21:36:11.372178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:36:11.373157 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
alter table "contosodb"."dbt_schema"."store_sales__dbt_tmp" rename to "store_sales"
[0m21:36:11.374607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:36:11.399713 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: COMMIT
[0m21:36:11.400698 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:36:11.401590 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: COMMIT
[0m21:36:11.403922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:36:11.414398 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."store_sales__dbt_backup"
[0m21:36:11.421173 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:36:11.422153 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
drop table if exists "contosodb"."dbt_schema"."store_sales__dbt_backup" cascade
[0m21:36:11.423353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:36:11.425804 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 21:36:09.329849 => 21:36:11.425316
[0m21:36:11.426722 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m21:36:11.428206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e856de-814f-49da-b284-bc8389c35ebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106490af0>]}
[0m21:36:11.429563 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.store_sales ....................... [[32mSELECT 306[0m in 2.12s]
[0m21:36:11.430951 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m21:36:11.432972 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:11.433838 [debug] [MainThread]: On master: BEGIN
[0m21:36:11.434642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:11.442511 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:36:11.443641 [debug] [MainThread]: On master: COMMIT
[0m21:36:11.444830 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:11.445888 [debug] [MainThread]: On master: COMMIT
[0m21:36:11.447407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:36:11.448308 [debug] [MainThread]: On master: Close
[0m21:36:11.449710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:11.450559 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m21:36:11.451405 [info ] [MainThread]: 
[0m21:36:11.452481 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m21:36:11.454960 [debug] [MainThread]: Command end result
[0m21:36:11.466569 [info ] [MainThread]: 
[0m21:36:11.467597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:11.468650 [info ] [MainThread]: 
[0m21:36:11.469982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:36:11.472998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1282327, "process_user_time": 3.578712, "process_kernel_time": 0.249233, "process_mem_max_rss": "110460928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:36:11.474667 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:11.474148 after 3.13 seconds
[0m21:36:11.476236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ae6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058eece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1c4c0>]}
[0m21:36:11.478056 [debug] [MainThread]: Flushing usage events
[0m21:47:59.758662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110271660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280a830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280a4d0>]}


============================== 21:47:59.763942 | c62766d4-9baf-4f7b-8b5e-1ff0579780d7 ==============================
[0m21:47:59.763942 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:47:59.765160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:00.029458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280a740>]}
[0m21:48:00.150589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c61a0>]}
[0m21:48:00.152088 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:48:00.172554 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:48:00.233215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:00.234244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:00.236082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:48:00.250104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b9540>]}
[0m21:48:00.269340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113384130>]}
[0m21:48:00.270836 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:48:00.272269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113384220>]}
[0m21:48:00.274897 [info ] [MainThread]: 
[0m21:48:00.276622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:48:00.289730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:48:00.307541 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:48:00.308509 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:48:00.309388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:00.352194 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:48:00.355969 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:48:00.359914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:48:00.370844 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:48:00.371872 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:48:00.373294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:00.380245 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.381155 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:48:00.382013 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:48:00.387969 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:48:00.390247 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:48:00.391245 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:48:00.400598 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:00.401507 [debug] [MainThread]: On master: BEGIN
[0m21:48:00.402316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:00.408507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.409402 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:00.410315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:48:00.444111 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m21:48:00.446088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133fa650>]}
[0m21:48:00.447267 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:00.448398 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:00.449295 [debug] [MainThread]: On master: BEGIN
[0m21:48:00.450899 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.456019 [debug] [MainThread]: On master: COMMIT
[0m21:48:00.457400 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:00.458658 [debug] [MainThread]: On master: COMMIT
[0m21:48:00.460007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:00.461082 [debug] [MainThread]: On master: Close
[0m21:48:00.462631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:00.463856 [info ] [MainThread]: 
[0m21:48:00.467124 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores
[0m21:48:00.468223 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_schema.int_contoso__stores ..................... [RUN]
[0m21:48:00.469727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores)
[0m21:48:00.470796 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores
[0m21:48:00.481664 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.483864 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (compile): 21:48:00.471451 => 21:48:00.483265
[0m21:48:00.485113 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores
[0m21:48:00.536142 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.537591 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.538512 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: BEGIN
[0m21:48:00.539545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:00.546663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.547722 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.548694 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp"
    
    
  as (
    SELECT 
STOREKEY,
STORENAME,
CASE
    WHEN STATUS = 'On' THEN 'Active'
    WHEN STATUS = 'Off' THEN 'Closed'
    ELSE 'No Status'
END AS STORESTATUS
FROM PUBLIC.DIMSTORES
  );
[0m21:48:00.553204 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:00.562039 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.563053 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores" rename to "int_contoso__stores__dbt_backup"
[0m21:48:00.564441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.569363 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.570309 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores__dbt_tmp" rename to "int_contoso__stores"
[0m21:48:00.571641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.593633 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:48:00.594612 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.595509 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: COMMIT
[0m21:48:00.597548 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:00.607023 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup"
[0m21:48:00.613819 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores"
[0m21:48:00.614849 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores__dbt_backup" cascade
[0m21:48:00.617450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:00.620371 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (execute): 21:48:00.485771 => 21:48:00.619859
[0m21:48:00.621449 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores: Close
[0m21:48:00.623368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113408a90>]}
[0m21:48:00.624998 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_schema.int_contoso__stores ................ [[32mCREATE VIEW[0m in 0.15s]
[0m21:48:00.626491 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores
[0m21:48:00.627504 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m21:48:00.628504 [info ] [Thread-1 (]: 2 of 6 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m21:48:00.629810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores, now model.postgres_dbt.stg_contoso__channels)
[0m21:48:00.630737 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m21:48:00.633945 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.635778 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 21:48:00.631332 => 21:48:00.635043
[0m21:48:00.637407 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m21:48:00.647865 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.649247 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.650162 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m21:48:00.651043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:00.657929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.658937 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.659883 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m21:48:00.664103 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:00.716977 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.718311 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m21:48:00.720364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.725958 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.726926 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m21:48:00.728240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.731826 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:48:00.732749 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.733627 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m21:48:00.736690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:00.741927 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m21:48:00.744432 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m21:48:00.745343 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m21:48:00.747723 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:00.750600 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 21:48:00.638606 => 21:48:00.750094
[0m21:48:00.751799 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m21:48:00.753442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134908e0>]}
[0m21:48:00.754906 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.12s]
[0m21:48:00.756271 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m21:48:00.757278 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m21:48:00.758284 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_schema.stg_contoso__products ................... [RUN]
[0m21:48:00.759586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m21:48:00.760514 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m21:48:00.763580 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.765164 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 21:48:00.761103 => 21:48:00.764594
[0m21:48:00.766212 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m21:48:00.775141 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.776607 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.778417 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: BEGIN
[0m21:48:00.779582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:00.786340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.787392 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.788304 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */

  create view "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp"
    
    
  as (
    select * from public.dimproducts
  );
[0m21:48:00.791599 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:00.799992 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.801000 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products" rename to "stg_contoso__products__dbt_backup"
[0m21:48:00.802394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.807434 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.808494 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
alter table "contosodb"."dbt_schema"."stg_contoso__products__dbt_tmp" rename to "stg_contoso__products"
[0m21:48:00.809858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.813814 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:48:00.814815 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.815779 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: COMMIT
[0m21:48:00.817590 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:00.823544 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup"
[0m21:48:00.825648 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__products"
[0m21:48:00.826580 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__products"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__products__dbt_backup" cascade
[0m21:48:00.829236 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:00.831939 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 21:48:00.767365 => 21:48:00.831509
[0m21:48:00.832868 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__products: Close
[0m21:48:00.834265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113497850>]}
[0m21:48:00.835523 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_schema.stg_contoso__products .............. [[32mCREATE VIEW[0m in 0.07s]
[0m21:48:00.836790 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m21:48:00.837770 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m21:48:00.838754 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m21:48:00.840166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m21:48:00.841098 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m21:48:00.844156 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.845865 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 21:48:00.841682 => 21:48:00.845184
[0m21:48:00.847210 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m21:48:00.858969 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.860444 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.861437 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m21:48:00.862468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:00.872424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.873686 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.874786 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT
FROM PUBLIC.FCTSALES
  );
[0m21:48:00.879330 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:00.886688 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.887799 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m21:48:00.889314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.894553 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.895577 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m21:48:00.897592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:00.901487 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:48:00.902465 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.903368 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m21:48:00.905161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:00.910279 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m21:48:00.912750 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m21:48:00.913853 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m21:48:00.916497 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:00.919250 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 21:48:00.848114 => 21:48:00.918620
[0m21:48:00.920388 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m21:48:00.922274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134aa230>]}
[0m21:48:00.923583 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.08s]
[0m21:48:00.924999 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m21:48:00.926505 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m21:48:00.927767 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_schema.sales .................................. [RUN]
[0m21:48:00.929320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now model.postgres_dbt.sales)
[0m21:48:00.930493 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m21:48:00.936362 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m21:48:00.939212 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 21:48:00.931176 => 21:48:00.938022
[0m21:48:00.940527 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m21:48:00.975642 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales"
[0m21:48:00.977073 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:48:00.978011 [debug] [Thread-1 (]: On model.postgres_dbt.sales: BEGIN
[0m21:48:00.978909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:00.985715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:00.986720 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:48:00.987707 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */

  
    

  create  table "contosodb"."dbt_schema"."sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
scp.productname,
st.storename,
scc.channelname,
s.unitcost,
s.unitprice,
s.salesquantity,
s.discountamount,
s.totalcost,
s.salesamount,
s.profit 
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
JOIN "contosodb"."dbt_schema"."stg_contoso__products" scp 
ON scp.productkey = s.productkey 
JOIN "contosodb"."dbt_schema"."stg_contoso__channels" scc 
ON s.channelkey = scc.channelkey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m21:48:25.949268 [debug] [Thread-1 (]: SQL status: SELECT 2897216 in 25.0 seconds
[0m21:48:25.955347 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:48:25.956353 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales" rename to "sales__dbt_backup"
[0m21:48:25.957757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:25.963646 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:48:25.965067 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales__dbt_tmp" rename to "sales"
[0m21:48:26.363634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:26.378176 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:48:26.379217 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:48:26.380108 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m21:48:26.381841 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:26.387426 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."sales__dbt_backup"
[0m21:48:26.392773 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m21:48:26.393811 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
drop table if exists "contosodb"."dbt_schema"."sales__dbt_backup" cascade
[0m21:48:26.428307 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:48:26.431490 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 21:48:00.941426 => 21:48:26.430681
[0m21:48:26.432797 [debug] [Thread-1 (]: On model.postgres_dbt.sales: Close
[0m21:48:26.434813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280ae30>]}
[0m21:48:26.436313 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_schema.sales ............................. [[32mSELECT 2897216[0m in 25.51s]
[0m21:48:26.438090 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m21:48:26.439811 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m21:48:26.441135 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m21:48:26.442510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.sales, now model.postgres_dbt.store_sales)
[0m21:48:26.443602 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m21:48:26.449053 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m21:48:26.450590 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 21:48:26.444361 => 21:48:26.450124
[0m21:48:26.451547 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m21:48:26.459979 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m21:48:26.461522 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:48:26.462767 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m21:48:26.464317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:26.485275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:48:26.486578 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:48:26.488163 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey
GROUP BY st.storename
ORDER BY TotalSales DESC
  );
  
[0m21:48:28.949758 [debug] [Thread-1 (]: SQL status: SELECT 306 in 2.0 seconds
[0m21:48:28.955812 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:48:28.956789 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
alter table "contosodb"."dbt_schema"."store_sales" rename to "store_sales__dbt_backup"
[0m21:48:28.958154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:28.965187 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:48:28.966170 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
alter table "contosodb"."dbt_schema"."store_sales__dbt_tmp" rename to "store_sales"
[0m21:48:28.967569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:28.972832 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: COMMIT
[0m21:48:28.973825 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:48:28.974716 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: COMMIT
[0m21:48:28.977040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:28.982136 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."store_sales__dbt_backup"
[0m21:48:28.984216 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m21:48:28.985494 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
drop table if exists "contosodb"."dbt_schema"."store_sales__dbt_backup" cascade
[0m21:48:28.988963 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:48:28.991390 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 21:48:26.452464 => 21:48:28.990958
[0m21:48:28.992354 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m21:48:28.994138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62766d4-9baf-4f7b-8b5e-1ff0579780d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a8fa0>]}
[0m21:48:28.995409 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dbt_schema.store_sales ....................... [[32mSELECT 306[0m in 2.55s]
[0m21:48:28.996869 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m21:48:28.999049 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:28.999938 [debug] [MainThread]: On master: BEGIN
[0m21:48:29.001146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:29.008993 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:29.009953 [debug] [MainThread]: On master: COMMIT
[0m21:48:29.010805 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:29.011643 [debug] [MainThread]: On master: COMMIT
[0m21:48:29.012602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:29.013467 [debug] [MainThread]: On master: Close
[0m21:48:29.014895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:29.015869 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m21:48:29.017296 [info ] [MainThread]: 
[0m21:48:29.018307 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 28.74 seconds (28.74s).
[0m21:48:29.020749 [debug] [MainThread]: Command end result
[0m21:48:29.032184 [info ] [MainThread]: 
[0m21:48:29.033582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:29.034570 [info ] [MainThread]: 
[0m21:48:29.035527 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:48:29.037887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.352324, "process_user_time": 3.837837, "process_kernel_time": 0.299061, "process_mem_max_rss": "109133824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:48:29.039650 [debug] [MainThread]: Command `dbt run` succeeded at 21:48:29.039122 after 29.35 seconds
[0m21:48:29.041077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110271660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113373b80>]}
[0m21:48:29.042234 [debug] [MainThread]: Flushing usage events
[0m18:44:04.081579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10338f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ce830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ce4d0>]}


============================== 18:44:04.091358 | d51af52b-a232-4d68-a4ac-22401253b699 ==============================
[0m18:44:04.091358 [info ] [MainThread]: Running with dbt=1.7.6
[0m18:44:04.093237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:04.873745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ce740>]}
[0m18:44:05.006788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588e1a0>]}
[0m18:44:05.010267 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m18:44:05.064179 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m18:44:05.200686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:44:05.202034 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://seeds/salestarget.csv
[0m18:44:05.361729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m18:44:05.373112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cff640>]}
[0m18:44:05.393420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106443dc0>]}
[0m18:44:05.395893 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:44:05.397810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106443f70>]}
[0m18:44:05.400261 [info ] [MainThread]: 
[0m18:44:05.402302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:05.406328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m18:44:05.422872 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m18:44:05.423810 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m18:44:05.424675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:05.501141 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:44:05.503794 [debug] [ThreadPool]: On list_contosodb: Close
[0m18:44:05.507268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m18:44:05.516596 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:44:05.517576 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m18:44:05.518424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:05.526562 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:44:05.527718 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:44:05.528894 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m18:44:05.547957 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:44:05.551116 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m18:44:05.552519 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m18:44:05.563617 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:05.564652 [debug] [MainThread]: On master: BEGIN
[0m18:44:05.565493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:05.572251 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:05.573166 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:05.574074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:05.625215 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:44:05.627321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dee650>]}
[0m18:44:05.628326 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:05.629367 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:05.630198 [debug] [MainThread]: On master: BEGIN
[0m18:44:05.631222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:05.632191 [debug] [MainThread]: On master: COMMIT
[0m18:44:05.633046 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:05.633861 [debug] [MainThread]: On master: COMMIT
[0m18:44:05.634825 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:05.635673 [debug] [MainThread]: On master: Close
[0m18:44:05.637034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:05.638136 [info ] [MainThread]: 
[0m18:44:05.698739 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m18:44:05.700215 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m18:44:05.701845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m18:44:05.702998 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m18:44:05.704408 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 18:44:05.703875 => 18:44:05.703879
[0m18:44:05.705418 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m18:44:05.749099 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:44:05.750262 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m18:44:05.751288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:05.758003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:05.759055 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:44:05.759964 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */

    create table "contosodb"."dbt_schema"."salestarget" ("channelkey" integer,"salestarget" integer)
  
[0m18:44:05.789217 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m18:44:05.815843 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:44:05.816941 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("channelkey", "salestarget") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:44:05.821207 [debug] [Thread-1 (]: Postgres adapter: Postgres error: integer out of range

[0m18:44:05.822389 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: ROLLBACK
[0m18:44:05.823893 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 18:44:05.706131 => 18:44:05.823431
[0m18:44:05.824807 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m18:44:05.839362 [debug] [Thread-1 (]: Database Error in seed salestarget (seeds/salestarget.csv)
  integer out of range
[0m18:44:05.840624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51af52b-a232-4d68-a4ac-22401253b699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ded450>]}
[0m18:44:05.841871 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt_schema.salestarget .......................... [[31mERROR[0m in 0.14s]
[0m18:44:05.843389 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m18:44:05.845825 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:05.846807 [debug] [MainThread]: On master: BEGIN
[0m18:44:05.847620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:05.858574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:05.859541 [debug] [MainThread]: On master: COMMIT
[0m18:44:05.860375 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:05.861191 [debug] [MainThread]: On master: COMMIT
[0m18:44:05.862353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:05.863482 [debug] [MainThread]: On master: Close
[0m18:44:05.865119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:05.866105 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m18:44:05.867033 [info ] [MainThread]: 
[0m18:44:05.868360 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:44:05.870043 [debug] [MainThread]: Command end result
[0m18:44:05.882036 [info ] [MainThread]: 
[0m18:44:05.883532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:44:05.884808 [info ] [MainThread]: 
[0m18:44:05.886918 [error] [MainThread]:   Database Error in seed salestarget (seeds/salestarget.csv)
  integer out of range
[0m18:44:05.887823 [info ] [MainThread]: 
[0m18:44:05.888738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:44:05.919543 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.963024, "process_user_time": 4.147402, "process_kernel_time": 0.844863, "process_mem_max_rss": "109883392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:44:05.920912 [debug] [MainThread]: Command `dbt seed` failed at 18:44:05.920593 after 1.96 seconds
[0m18:44:05.921881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10338f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c85900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105defd30>]}
[0m18:44:05.922890 [debug] [MainThread]: Flushing usage events
[0m18:45:25.141774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f28c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f2560>]}


============================== 18:45:25.147159 | 42212e3f-253d-4a91-a4ac-e200a1d641b4 ==============================
[0m18:45:25.147159 [info ] [MainThread]: Running with dbt=1.7.6
[0m18:45:25.148400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:45:25.455621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f27d0>]}
[0m18:45:25.597650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a612b60>]}
[0m18:45:25.599094 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m18:45:25.626412 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m18:45:25.718151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:25.719679 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://seeds/salestarget.csv
[0m18:45:25.880554 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m18:45:25.888283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a3d30>]}
[0m18:45:25.907454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac74940>]}
[0m18:45:25.908548 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:45:25.909511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac74ac0>]}
[0m18:45:25.912332 [info ] [MainThread]: 
[0m18:45:25.914332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:25.918038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m18:45:25.934877 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m18:45:25.936045 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m18:45:25.937438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:25.974935 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:45:25.977424 [debug] [ThreadPool]: On list_contosodb: Close
[0m18:45:25.980240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m18:45:25.989821 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:45:25.990751 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m18:45:25.991569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:25.998000 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:45:25.998940 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:45:25.999855 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m18:45:26.005910 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:45:26.008091 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m18:45:26.009065 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m18:45:26.018111 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:26.019004 [debug] [MainThread]: On master: BEGIN
[0m18:45:26.019793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:26.026906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:26.027789 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:26.028693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:26.063226 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:45:26.065164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac678e0>]}
[0m18:45:26.066134 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:26.067101 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:26.067921 [debug] [MainThread]: On master: BEGIN
[0m18:45:26.068954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:26.069796 [debug] [MainThread]: On master: COMMIT
[0m18:45:26.070614 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:26.071417 [debug] [MainThread]: On master: COMMIT
[0m18:45:26.072335 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:26.073155 [debug] [MainThread]: On master: Close
[0m18:45:26.074431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:26.075494 [info ] [MainThread]: 
[0m18:45:26.079214 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m18:45:26.080299 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m18:45:26.081870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m18:45:26.082970 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m18:45:26.084117 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 18:45:26.083631 => 18:45:26.083636
[0m18:45:26.085453 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m18:45:26.181393 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:45:26.182390 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m18:45:26.183272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:26.189915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:26.190863 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:45:26.191754 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */

    create table "contosodb"."dbt_schema"."salestarget" ("channelkey" integer,"salestarget" integer)
  
[0m18:45:26.194994 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m18:45:26.222342 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:45:26.223347 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("channelkey", "salestarget") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:45:26.225471 [debug] [Thread-1 (]: Postgres adapter: Postgres error: integer out of range

[0m18:45:26.226436 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: ROLLBACK
[0m18:45:26.227806 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 18:45:26.086622 => 18:45:26.227356
[0m18:45:26.228772 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m18:45:26.232049 [debug] [Thread-1 (]: Database Error in seed salestarget (seeds/salestarget.csv)
  integer out of range
[0m18:45:26.233068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42212e3f-253d-4a91-a4ac-e200a1d641b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adefa90>]}
[0m18:45:26.234139 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt_schema.salestarget .......................... [[31mERROR[0m in 0.15s]
[0m18:45:26.235492 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m18:45:26.238011 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:26.238923 [debug] [MainThread]: On master: BEGIN
[0m18:45:26.239742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:26.248891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:26.250095 [debug] [MainThread]: On master: COMMIT
[0m18:45:26.251287 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:26.252533 [debug] [MainThread]: On master: COMMIT
[0m18:45:26.253744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:26.254757 [debug] [MainThread]: On master: Close
[0m18:45:26.256143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:26.257050 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m18:45:26.257910 [info ] [MainThread]: 
[0m18:45:26.258997 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:45:26.260476 [debug] [MainThread]: Command end result
[0m18:45:26.272012 [info ] [MainThread]: 
[0m18:45:26.273067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:26.274063 [info ] [MainThread]: 
[0m18:45:26.275035 [error] [MainThread]:   Database Error in seed salestarget (seeds/salestarget.csv)
  integer out of range
[0m18:45:26.276024 [info ] [MainThread]: 
[0m18:45:26.276993 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:45:26.279545 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2110428, "process_user_time": 3.554737, "process_kernel_time": 0.297674, "process_mem_max_rss": "109969408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:45:26.281367 [debug] [MainThread]: Command `dbt seed` failed at 18:45:26.281018 after 1.21 seconds
[0m18:45:26.282362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ace3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdb730>]}
[0m18:45:26.283434 [debug] [MainThread]: Flushing usage events
[0m18:50:07.328359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3a500>]}


============================== 18:50:07.335659 | a942cd41-6e02-43dd-b48f-abba539b642f ==============================
[0m18:50:07.335659 [info ] [MainThread]: Running with dbt=1.7.6
[0m18:50:07.336923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:07.776691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3a770>]}
[0m18:50:07.908749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8d060>]}
[0m18:50:07.911428 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m18:50:07.948258 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m18:50:08.077585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:08.079085 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://seeds/salestarget.csv
[0m18:50:08.240545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m18:50:08.248921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e69ea0>]}
[0m18:50:08.269320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b08b0>]}
[0m18:50:08.270572 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:50:08.271849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b0be0>]}
[0m18:50:08.275249 [info ] [MainThread]: 
[0m18:50:08.278770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:08.280634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m18:50:08.298249 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m18:50:08.299214 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m18:50:08.300063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:08.355292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:50:08.357681 [debug] [ThreadPool]: On list_contosodb: Close
[0m18:50:08.361070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m18:50:08.369428 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:50:08.370459 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m18:50:08.371373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:08.378788 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:08.379901 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:50:08.380896 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m18:50:08.387167 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:50:08.389485 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m18:50:08.390520 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m18:50:08.399707 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.400615 [debug] [MainThread]: On master: BEGIN
[0m18:50:08.401430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:08.407647 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:08.408545 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.409468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:08.443507 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:50:08.445480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4304c0>]}
[0m18:50:08.446471 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:08.447481 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.448336 [debug] [MainThread]: On master: BEGIN
[0m18:50:08.449413 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:08.450261 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.451102 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.451926 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.452852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:08.453714 [debug] [MainThread]: On master: Close
[0m18:50:08.455034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:08.456083 [info ] [MainThread]: 
[0m18:50:08.461853 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m18:50:08.463135 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m18:50:08.464948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m18:50:08.466156 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m18:50:08.467351 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 18:50:08.466898 => 18:50:08.466901
[0m18:50:08.468365 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m18:50:08.565963 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:50:08.567148 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m18:50:08.568165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:08.575392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:08.576355 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:50:08.577405 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */

    create table "contosodb"."dbt_schema"."salestarget" ("channelkey" integer,"salestarget" integer)
  
[0m18:50:08.580445 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m18:50:08.607747 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:50:08.608738 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("channelkey", "salestarget") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:50:08.619603 [debug] [Thread-1 (]: Postgres adapter: Postgres error: integer out of range

[0m18:50:08.621369 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: ROLLBACK
[0m18:50:08.623367 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 18:50:08.469162 => 18:50:08.622711
[0m18:50:08.624732 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m18:50:08.671264 [debug] [Thread-1 (]: Database Error in seed salestarget (seeds/salestarget.csv)
  integer out of range
[0m18:50:08.673080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a942cd41-6e02-43dd-b48f-abba539b642f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64cb50>]}
[0m18:50:08.674656 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt_schema.salestarget .......................... [[31mERROR[0m in 0.21s]
[0m18:50:08.676504 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m18:50:08.680242 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.681625 [debug] [MainThread]: On master: BEGIN
[0m18:50:08.682796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:08.694540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:08.695545 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.696404 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.697353 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.698372 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:08.699240 [debug] [MainThread]: On master: Close
[0m18:50:08.700529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:08.701525 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m18:50:08.702391 [info ] [MainThread]: 
[0m18:50:08.703357 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m18:50:08.704724 [debug] [MainThread]: Command end result
[0m18:50:08.717107 [info ] [MainThread]: 
[0m18:50:08.718312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:08.719305 [info ] [MainThread]: 
[0m18:50:08.720322 [error] [MainThread]:   Database Error in seed salestarget (seeds/salestarget.csv)
  integer out of range
[0m18:50:08.721279 [info ] [MainThread]: 
[0m18:50:08.722246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:50:08.727618 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.510747, "process_user_time": 4.205478, "process_kernel_time": 0.656539, "process_mem_max_rss": "109662208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:50:08.730073 [debug] [MainThread]: Command `dbt seed` failed at 18:50:08.729511 after 1.51 seconds
[0m18:50:08.733671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64e2f0>]}
[0m18:50:08.735192 [debug] [MainThread]: Flushing usage events
[0m18:51:57.141804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fa830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fa4d0>]}


============================== 18:51:57.151783 | 6521b0a1-749f-4b36-96d5-c380c1246c05 ==============================
[0m18:51:57.151783 [info ] [MainThread]: Running with dbt=1.7.6
[0m18:51:57.153590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:57.475148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fa740>]}
[0m18:51:57.597850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ba1a0>]}
[0m18:51:57.601161 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m18:51:57.631520 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m18:51:57.750829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:57.752132 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://seeds/salestarget.csv
[0m18:51:57.911173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m18:51:57.921882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f95c90>]}
[0m18:51:57.940414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7c880>]}
[0m18:51:57.941503 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:51:57.942470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e7cbb0>]}
[0m18:51:57.946089 [info ] [MainThread]: 
[0m18:51:57.948919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:51:57.952810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m18:51:57.972794 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m18:51:57.975140 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m18:51:57.976349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:58.040101 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:51:58.042773 [debug] [ThreadPool]: On list_contosodb: Close
[0m18:51:58.047488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m18:51:58.059993 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:51:58.061191 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m18:51:58.062038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:58.069675 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:51:58.070791 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:51:58.071780 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m18:51:58.078989 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:51:58.081240 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m18:51:58.082237 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m18:51:58.091726 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:58.092612 [debug] [MainThread]: On master: BEGIN
[0m18:51:58.093418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:58.099719 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:58.100619 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:58.101538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:51:58.136830 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:51:58.138780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e6f820>]}
[0m18:51:58.139964 [debug] [MainThread]: On master: ROLLBACK
[0m18:51:58.141115 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:58.142013 [debug] [MainThread]: On master: BEGIN
[0m18:51:58.143115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:58.143980 [debug] [MainThread]: On master: COMMIT
[0m18:51:58.144818 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:58.145660 [debug] [MainThread]: On master: COMMIT
[0m18:51:58.146624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:51:58.147484 [debug] [MainThread]: On master: Close
[0m18:51:58.148869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:58.149924 [info ] [MainThread]: 
[0m18:51:58.154911 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m18:51:58.156269 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m18:51:58.157902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m18:51:58.158950 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m18:51:58.160099 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 18:51:58.159564 => 18:51:58.159568
[0m18:51:58.163071 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m18:51:58.261065 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:51:58.262168 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m18:51:58.263058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:58.269425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:51:58.270389 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:51:58.271275 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */

    create table "contosodb"."dbt_schema"."salestarget" ("storekey" integer,"totalsales" integer)
  
[0m18:51:58.274299 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m18:51:58.301118 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:51:58.302108 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("storekey", "totalsales") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:51:58.306149 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.0 seconds
[0m18:51:58.314889 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.postgres_dbt.salestarget"
[0m18:51:58.341418 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: COMMIT
[0m18:51:58.342405 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m18:51:58.343315 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: COMMIT
[0m18:51:58.345491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:51:58.347659 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 18:51:58.164859 => 18:51:58.347155
[0m18:51:58.348711 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m18:51:58.350283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6521b0a1-749f-4b36-96d5-c380c1246c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fae30>]}
[0m18:51:58.351534 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.salestarget .............................. [[32mINSERT 5[0m in 0.19s]
[0m18:51:58.352822 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m18:51:58.354903 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:58.355782 [debug] [MainThread]: On master: BEGIN
[0m18:51:58.356599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:58.363256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:51:58.364200 [debug] [MainThread]: On master: COMMIT
[0m18:51:58.365061 [debug] [MainThread]: Using postgres connection "master"
[0m18:51:58.365943 [debug] [MainThread]: On master: COMMIT
[0m18:51:58.367380 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:51:58.368386 [debug] [MainThread]: On master: Close
[0m18:51:58.371068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:58.372251 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m18:51:58.373311 [info ] [MainThread]: 
[0m18:51:58.374565 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m18:51:58.375914 [debug] [MainThread]: Command end result
[0m18:51:58.386472 [info ] [MainThread]: 
[0m18:51:58.387957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:58.389254 [info ] [MainThread]: 
[0m18:51:58.390331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:51:58.394087 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.3501668, "process_user_time": 4.120622, "process_kernel_time": 0.604861, "process_mem_max_rss": "109916160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:51:58.395649 [debug] [MainThread]: Command `dbt seed` succeeded at 18:51:58.395308 after 1.35 seconds
[0m18:51:58.396791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cc3f40>]}
[0m18:51:58.397791 [debug] [MainThread]: Flushing usage events
[0m18:59:30.731045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109826890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109826530>]}


============================== 18:59:30.737384 | 47c64e72-27b5-49a1-85b6-21581c00ba72 ==============================
[0m18:59:30.737384 [info ] [MainThread]: Running with dbt=1.7.6
[0m18:59:30.738623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m store_sales.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:59:31.015599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098267a0>]}
[0m18:59:31.138703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979b3d0>]}
[0m18:59:31.140211 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m18:59:31.163105 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m18:59:31.220906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:31.222166 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/store_sales.sql
[0m18:59:31.426470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m18:59:31.434574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5300d0>]}
[0m18:59:31.451673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b08e0>]}
[0m18:59:31.453177 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:59:31.454406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b0c10>]}
[0m18:59:31.462057 [info ] [MainThread]: 
[0m18:59:31.464088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:59:31.467138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m18:59:31.490949 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m18:59:31.492315 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m18:59:31.493696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:31.535245 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:59:31.539067 [debug] [ThreadPool]: On list_contosodb: Close
[0m18:59:31.546058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m18:59:31.560659 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:59:31.561685 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m18:59:31.562548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:31.569432 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:59:31.570325 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m18:59:31.571350 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m18:59:31.577476 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:59:31.579529 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m18:59:31.580495 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m18:59:31.637988 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:31.638991 [debug] [MainThread]: On master: BEGIN
[0m18:59:31.639861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:59:31.646298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:59:31.647181 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:31.648080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:59:31.684841 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:59:31.686814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a546620>]}
[0m18:59:31.687824 [debug] [MainThread]: On master: ROLLBACK
[0m18:59:31.688811 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:31.689647 [debug] [MainThread]: On master: BEGIN
[0m18:59:31.690690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:59:31.691529 [debug] [MainThread]: On master: COMMIT
[0m18:59:31.692357 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:31.693176 [debug] [MainThread]: On master: COMMIT
[0m18:59:31.694094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:31.694937 [debug] [MainThread]: On master: Close
[0m18:59:31.696229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:31.697266 [info ] [MainThread]: 
[0m18:59:31.700000 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m18:59:31.701071 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m18:59:31.702617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.store_sales)
[0m18:59:31.703714 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m18:59:31.716843 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m18:59:31.720691 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 18:59:31.704389 => 18:59:31.719989
[0m18:59:31.721818 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m18:59:31.777706 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m18:59:31.780542 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m18:59:31.781722 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m18:59:31.782743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:31.789709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:59:31.790774 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m18:59:31.792367 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storekey,
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey
GROUP BY st.storename
ORDER BY TotalSales DESC
  );
  
[0m18:59:31.796845 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "st.storekey" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15: st.storekey,
         ^

[0m18:59:31.798059 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: ROLLBACK
[0m18:59:31.799852 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 18:59:31.722615 => 18:59:31.799315
[0m18:59:31.800832 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m18:59:31.812770 [debug] [Thread-1 (]: Database Error in model store_sales (models/marts/store_sales.sql)
  column "st.storekey" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15: st.storekey,
           ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m18:59:31.813902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47c64e72-27b5-49a1-85b6-21581c00ba72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d4040>]}
[0m18:59:31.815306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_schema.store_sales ................... [[31mERROR[0m in 0.11s]
[0m18:59:31.816631 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m18:59:31.818945 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:31.819865 [debug] [MainThread]: On master: BEGIN
[0m18:59:31.820687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:59:31.833996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:59:31.834937 [debug] [MainThread]: On master: COMMIT
[0m18:59:31.835768 [debug] [MainThread]: Using postgres connection "master"
[0m18:59:31.836604 [debug] [MainThread]: On master: COMMIT
[0m18:59:31.837620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:59:31.838615 [debug] [MainThread]: On master: Close
[0m18:59:31.840281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:31.841547 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m18:59:31.842668 [info ] [MainThread]: 
[0m18:59:31.844335 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:59:31.846765 [debug] [MainThread]: Command end result
[0m18:59:31.861571 [info ] [MainThread]: 
[0m18:59:31.863250 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:59:31.864686 [info ] [MainThread]: 
[0m18:59:31.865868 [error] [MainThread]:   Database Error in model store_sales (models/marts/store_sales.sql)
  column "st.storekey" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15: st.storekey,
           ^
  compiled Code at target/run/postgres_dbt/models/marts/store_sales.sql
[0m18:59:31.867609 [info ] [MainThread]: 
[0m18:59:31.869229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:59:31.872287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.227159, "process_user_time": 3.65016, "process_kernel_time": 0.304383, "process_mem_max_rss": "110751744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:59:31.873865 [debug] [MainThread]: Command `dbt run` failed at 18:59:31.873511 after 1.23 seconds
[0m18:59:31.874898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cda980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd8d30>]}
[0m18:59:31.875831 [debug] [MainThread]: Flushing usage events
[0m19:00:00.224828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723e590>]}


============================== 19:00:00.232083 | 436917c5-3afc-4e4d-b63a-3bfbe800a57e ==============================
[0m19:00:00.232083 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:00:00.233328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m store_sales.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:00.543315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723e800>]}
[0m19:00:00.674895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772e710>]}
[0m19:00:00.676287 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:00:00.711120 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:00:00.770349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:00.771688 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/store_sales.sql
[0m19:00:00.973063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:00:00.982498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f480d0>]}
[0m19:00:01.000048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4940>]}
[0m19:00:01.001073 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:00:01.002295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4c70>]}
[0m19:00:01.006787 [info ] [MainThread]: 
[0m19:00:01.008787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:01.011076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:00:01.028152 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:00:01.029340 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:00:01.030213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:01.071161 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:00:01.074821 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:00:01.077951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:00:01.087222 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:00:01.088131 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:00:01.089114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:01.096011 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:01.096909 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:00:01.097749 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:00:01.103823 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:00:01.106085 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:00:01.107120 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:00:01.165864 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:01.166868 [debug] [MainThread]: On master: BEGIN
[0m19:00:01.167744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:01.174443 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:01.175334 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:01.176242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:01.212813 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:00:01.214770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1be20>]}
[0m19:00:01.215739 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:01.216728 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:01.217556 [debug] [MainThread]: On master: BEGIN
[0m19:00:01.218604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:01.219443 [debug] [MainThread]: On master: COMMIT
[0m19:00:01.220304 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:01.221118 [debug] [MainThread]: On master: COMMIT
[0m19:00:01.222041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:01.222873 [debug] [MainThread]: On master: Close
[0m19:00:01.224270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:01.225315 [info ] [MainThread]: 
[0m19:00:01.227927 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m19:00:01.229341 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.store_sales ............................ [RUN]
[0m19:00:01.231066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.store_sales)
[0m19:00:01.232130 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m19:00:01.246320 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m19:00:01.247800 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 19:00:01.232782 => 19:00:01.247320
[0m19:00:01.248703 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m19:00:01.314327 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.store_sales"
[0m19:00:01.316095 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m19:00:01.317625 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: BEGIN
[0m19:00:01.318541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:01.326189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:01.327817 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m19:00:01.329429 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */

  
    

  create  table "contosodb"."dbt_schema"."store_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
st.storekey,
st.storename,
SUM(s.totalcost) AS TotalCost,
SUM(s.salesamount) AS TotalSales,
SUM(s.profit) AS TotalProfit
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey
GROUP BY st.storekey, st.storename
ORDER BY TotalSales DESC
  );
  
[0m19:00:03.454763 [debug] [Thread-1 (]: SQL status: SELECT 306 in 2.0 seconds
[0m19:00:03.463556 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m19:00:03.464624 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
alter table "contosodb"."dbt_schema"."store_sales" rename to "store_sales__dbt_backup"
[0m19:00:03.470374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:03.476607 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m19:00:03.477682 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
alter table "contosodb"."dbt_schema"."store_sales__dbt_tmp" rename to "store_sales"
[0m19:00:03.479272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:00:03.508198 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: COMMIT
[0m19:00:03.509431 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m19:00:03.510342 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: COMMIT
[0m19:00:03.512527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:00:03.521889 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."store_sales__dbt_backup"
[0m19:00:03.528866 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.store_sales"
[0m19:00:03.529859 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.store_sales"} */
drop table if exists "contosodb"."dbt_schema"."store_sales__dbt_backup" cascade
[0m19:00:03.544912 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:00:03.548019 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 19:00:01.249285 => 19:00:03.547509
[0m19:00:03.549098 [debug] [Thread-1 (]: On model.postgres_dbt.store_sales: Close
[0m19:00:03.550850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436917c5-3afc-4e4d-b63a-3bfbe800a57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4bca0>]}
[0m19:00:03.552386 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.store_sales ....................... [[32mSELECT 306[0m in 2.32s]
[0m19:00:03.553825 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m19:00:03.555943 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:03.556858 [debug] [MainThread]: On master: BEGIN
[0m19:00:03.557739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:03.565465 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:03.566505 [debug] [MainThread]: On master: COMMIT
[0m19:00:03.567503 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:03.568535 [debug] [MainThread]: On master: COMMIT
[0m19:00:03.571437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:03.573903 [debug] [MainThread]: On master: Close
[0m19:00:03.576045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:03.577092 [debug] [MainThread]: Connection 'model.postgres_dbt.store_sales' was properly closed.
[0m19:00:03.578068 [info ] [MainThread]: 
[0m19:00:03.579432 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m19:00:03.581978 [debug] [MainThread]: Command end result
[0m19:00:03.598788 [info ] [MainThread]: 
[0m19:00:03.599923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:03.600900 [info ] [MainThread]: 
[0m19:00:03.601835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:03.604413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.461265, "process_user_time": 3.731744, "process_kernel_time": 0.288791, "process_mem_max_rss": "110252032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:03.606076 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:03.605652 after 3.46 seconds
[0m19:00:03.607603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c36980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5cb20>]}
[0m19:00:03.608573 [debug] [MainThread]: Flushing usage events
[0m19:00:54.211146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107657400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bee800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bee4a0>]}


============================== 19:00:54.216787 | f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8 ==============================
[0m19:00:54.216787 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:00:54.218071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:54.500897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bee710>]}
[0m19:00:54.628721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109baa470>]}
[0m19:00:54.630312 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:00:54.654442 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:00:54.714891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:54.716103 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://seeds/salestarget.csv
[0m19:00:54.872377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:00:54.880216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b9c60>]}
[0m19:00:54.897516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a764880>]}
[0m19:00:54.898625 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:00:54.899600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a764ac0>]}
[0m19:00:54.902089 [info ] [MainThread]: 
[0m19:00:54.904899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:54.907570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:00:54.924474 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:00:54.925497 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:00:54.926349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:54.963799 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:00:54.967706 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:00:54.971839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:00:54.981269 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:00:54.982554 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:00:54.983447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:54.990200 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:00:54.991110 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:00:54.991963 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:00:54.998389 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:00:55.000835 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:00:55.002064 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:00:55.011577 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:55.012510 [debug] [MainThread]: On master: BEGIN
[0m19:00:55.013368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:55.019544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:55.020448 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:55.021368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:55.058412 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:00:55.060512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7577f0>]}
[0m19:00:55.061519 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:55.062547 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:55.063384 [debug] [MainThread]: On master: BEGIN
[0m19:00:55.064601 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:55.065471 [debug] [MainThread]: On master: COMMIT
[0m19:00:55.066311 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:55.067124 [debug] [MainThread]: On master: COMMIT
[0m19:00:55.068054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:55.068902 [debug] [MainThread]: On master: Close
[0m19:00:55.070228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:55.071342 [info ] [MainThread]: 
[0m19:00:55.075075 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m19:00:55.076188 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m19:00:55.077967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m19:00:55.079037 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m19:00:55.080500 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 19:00:55.079806 => 19:00:55.079812
[0m19:00:55.081523 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m19:00:55.181046 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:00:55.182041 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m19:00:55.182953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:55.189695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:00:55.190662 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:00:55.191709 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */
truncate table "contosodb"."dbt_schema"."salestarget"
[0m19:00:55.195605 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m19:00:55.225980 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:00:55.226985 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("storekey", "salestarget") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m19:00:55.228961 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "salestarget" of relation "salestarget" does not exist
LINE 2: ...ontosodb"."dbt_schema"."salestarget" ("storekey", "salestarg...
                                                             ^

[0m19:00:55.229922 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: ROLLBACK
[0m19:00:55.231337 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 19:00:55.082137 => 19:00:55.230833
[0m19:00:55.232317 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m19:00:55.236718 [debug] [Thread-1 (]: Database Error in seed salestarget (seeds/salestarget.csv)
  column "salestarget" of relation "salestarget" does not exist
  LINE 2: ...ontosodb"."dbt_schema"."salestarget" ("storekey", "salestarg...
                                                               ^
[0m19:00:55.237796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4227dbb-f21b-4c73-ba08-d1aa6e7d62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a79b010>]}
[0m19:00:55.239000 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt_schema.salestarget .......................... [[31mERROR[0m in 0.16s]
[0m19:00:55.240567 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m19:00:55.242562 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:55.243484 [debug] [MainThread]: On master: BEGIN
[0m19:00:55.244458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:55.253211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:00:55.254278 [debug] [MainThread]: On master: COMMIT
[0m19:00:55.255753 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:55.256634 [debug] [MainThread]: On master: COMMIT
[0m19:00:55.257637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:00:55.258498 [debug] [MainThread]: On master: Close
[0m19:00:55.259784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:55.260716 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m19:00:55.261566 [info ] [MainThread]: 
[0m19:00:55.262506 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m19:00:55.263981 [debug] [MainThread]: Command end result
[0m19:00:55.276183 [info ] [MainThread]: 
[0m19:00:55.277249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:55.278190 [info ] [MainThread]: 
[0m19:00:55.279226 [error] [MainThread]:   Database Error in seed salestarget (seeds/salestarget.csv)
  column "salestarget" of relation "salestarget" does not exist
  LINE 2: ...ontosodb"."dbt_schema"."salestarget" ("storekey", "salestarg...
                                                               ^
[0m19:00:55.280189 [info ] [MainThread]: 
[0m19:00:55.281155 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:00:55.283590 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.1496688, "process_user_time": 3.69516, "process_kernel_time": 0.316417, "process_mem_max_rss": "109510656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:55.284957 [debug] [MainThread]: Command `dbt seed` failed at 19:00:55.284619 after 1.15 seconds
[0m19:00:55.286865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107657400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7578e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f3010>]}
[0m19:00:55.288228 [debug] [MainThread]: Flushing usage events
[0m19:01:41.168452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0826b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c2590>]}


============================== 19:01:41.173763 | b55f7469-d34b-4d07-ad93-19674f67ad5e ==============================
[0m19:01:41.173763 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:01:41.175003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed -s salestarget.csv', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:01:41.442807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c2800>]}
[0m19:01:41.564880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab6710>]}
[0m19:01:41.566430 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:01:41.588289 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:01:41.648735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:01:41.649651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:01:41.651576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:01:41.661193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e17dd20>]}
[0m19:01:41.677349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e158940>]}
[0m19:01:41.678395 [info ] [MainThread]: Found 6 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:01:41.679592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e158c70>]}
[0m19:01:41.682266 [info ] [MainThread]: 
[0m19:01:41.686816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:01:41.689017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:01:41.705487 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:01:41.706866 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:01:41.708431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:41.743987 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:01:41.746557 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:01:41.749633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:01:41.758468 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:01:41.759379 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:01:41.760186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:41.767384 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:01:41.768276 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:01:41.769120 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:01:41.775104 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:01:41.777273 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:01:41.778275 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:01:41.787188 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:41.788097 [debug] [MainThread]: On master: BEGIN
[0m19:01:41.788943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:41.795388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:41.796277 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:41.797194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:01:41.834430 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:01:41.836468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1c2890>]}
[0m19:01:41.838523 [debug] [MainThread]: On master: ROLLBACK
[0m19:01:41.839821 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:41.840689 [debug] [MainThread]: On master: BEGIN
[0m19:01:41.841845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:41.842716 [debug] [MainThread]: On master: COMMIT
[0m19:01:41.843674 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:41.844518 [debug] [MainThread]: On master: COMMIT
[0m19:01:41.846815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:41.847937 [debug] [MainThread]: On master: Close
[0m19:01:41.850105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:41.851291 [info ] [MainThread]: 
[0m19:01:41.854452 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m19:01:41.855587 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m19:01:41.857394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m19:01:41.858568 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m19:01:41.859795 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 19:01:41.859210 => 19:01:41.859214
[0m19:01:41.860878 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m19:01:41.905900 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:01:41.907376 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m19:01:41.908427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:41.915636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:01:41.917118 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:01:41.918123 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */

    create table "contosodb"."dbt_schema"."salestarget" ("storekey" integer,"salestarget" integer)
  
[0m19:01:41.921189 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m19:01:41.949899 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:01:41.950910 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("storekey", "salestarget") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m19:01:41.952769 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.0 seconds
[0m19:01:41.961087 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.postgres_dbt.salestarget"
[0m19:01:41.985857 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: COMMIT
[0m19:01:41.986832 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:01:41.987763 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: COMMIT
[0m19:01:41.989935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:01:41.992149 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 19:01:41.861501 => 19:01:41.991638
[0m19:01:41.993217 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m19:01:41.994653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b55f7469-d34b-4d07-ad93-19674f67ad5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f3af0>]}
[0m19:01:41.995912 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.salestarget .............................. [[32mINSERT 5[0m in 0.14s]
[0m19:01:41.997233 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m19:01:41.999333 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:42.000230 [debug] [MainThread]: On master: BEGIN
[0m19:01:42.001045 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:42.009637 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:01:42.011087 [debug] [MainThread]: On master: COMMIT
[0m19:01:42.012223 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:42.013212 [debug] [MainThread]: On master: COMMIT
[0m19:01:42.014559 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:01:42.015732 [debug] [MainThread]: On master: Close
[0m19:01:42.017853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:42.018851 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m19:01:42.019738 [info ] [MainThread]: 
[0m19:01:42.020702 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m19:01:42.022062 [debug] [MainThread]: Command end result
[0m19:01:42.033018 [info ] [MainThread]: 
[0m19:01:42.034322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:42.035202 [info ] [MainThread]: 
[0m19:01:42.036311 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:01:42.038513 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.94443077, "process_user_time": 3.396468, "process_kernel_time": 0.282579, "process_mem_max_rss": "108064768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:01:42.039782 [debug] [MainThread]: Command `dbt seed` succeeded at 19:01:42.039464 after 0.95 seconds
[0m19:01:42.040734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0826b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e158be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1df370>]}
[0m19:01:42.042157 [debug] [MainThread]: Flushing usage events
[0m19:10:21.081176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab85660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11e560>]}


============================== 19:10:21.090863 | 36083a09-1267-49e4-8bee-5ee964fab0c7 ==============================
[0m19:10:21.090863 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:10:21.093466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m sales_target.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:21.463510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11e7d0>]}
[0m19:10:21.599009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dae6b60>]}
[0m19:10:21.601753 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:10:21.631315 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:10:21.750548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:10:21.751785 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/marts/sales_target.sql
[0m19:10:21.964014 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:10:21.972511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de440d0>]}
[0m19:10:21.993843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc93eb0>]}
[0m19:10:21.994925 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:10:21.995992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc93d60>]}
[0m19:10:21.998308 [info ] [MainThread]: 
[0m19:10:22.000196 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:10:22.007318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:10:22.026976 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:10:22.027978 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:10:22.029251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:22.101364 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:10:22.107207 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:10:22.116781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:10:22.135605 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:10:22.136617 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:10:22.144107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:10:22.168015 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:10:22.169227 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:10:22.170213 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:10:22.176956 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:10:22.179257 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:10:22.180563 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:10:22.259262 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:22.260845 [debug] [MainThread]: On master: BEGIN
[0m19:10:22.262371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:10:22.272001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:10:22.273628 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:22.275290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:10:22.315814 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:10:22.317871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc92f50>]}
[0m19:10:22.318868 [debug] [MainThread]: On master: ROLLBACK
[0m19:10:22.319881 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:22.320727 [debug] [MainThread]: On master: BEGIN
[0m19:10:22.321766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:10:22.322615 [debug] [MainThread]: On master: COMMIT
[0m19:10:22.323465 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:22.324301 [debug] [MainThread]: On master: COMMIT
[0m19:10:22.325248 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:10:22.326104 [debug] [MainThread]: On master: Close
[0m19:10:22.327417 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:22.328522 [info ] [MainThread]: 
[0m19:10:22.332761 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target
[0m19:10:22.334016 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.sales_target ............................ [RUN]
[0m19:10:22.335529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales_target)
[0m19:10:22.336658 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target
[0m19:10:22.347679 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target"
[0m19:10:22.349294 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target (compile): 19:10:22.337329 => 19:10:22.348739
[0m19:10:22.350273 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target
[0m19:10:22.403141 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales_target"
[0m19:10:22.404762 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target"
[0m19:10:22.405752 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target: BEGIN
[0m19:10:22.406726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:10:22.414456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:10:22.415540 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target"
[0m19:10:22.416566 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target"} */

  create view "contosodb"."dbt_schema"."sales_target__dbt_tmp"
    
    
  as (
    SELECT 
st.storekey,
ss.storename,
st.salestarget,
ss.totalsales,
(ss.totalsales - st.salestarget) as salesdiff,
CASE 
    WHEN 
    (ss.totalsales - st.salestarget) < 0 THEN 'NO'
    ELSE 'YES'
    END AS target_achieved
FROM salestarget st 
JOIN store_sales ss 
ON ss.storekey = st.storekey
  );
[0m19:10:22.426077 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "salestarget" does not exist
LINE 18: FROM salestarget st 
              ^

[0m19:10:22.427852 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target: ROLLBACK
[0m19:10:22.430123 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target (execute): 19:10:22.350907 => 19:10:22.429455
[0m19:10:22.431467 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target: Close
[0m19:10:22.455114 [debug] [Thread-1 (]: Database Error in model sales_target (models/marts/sales_target.sql)
  relation "salestarget" does not exist
  LINE 18: FROM salestarget st 
                ^
  compiled Code at target/run/postgres_dbt/models/marts/sales_target.sql
[0m19:10:22.456814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36083a09-1267-49e4-8bee-5ee964fab0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d49fb80>]}
[0m19:10:22.458529 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.sales_target ................... [[31mERROR[0m in 0.12s]
[0m19:10:22.460476 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target
[0m19:10:22.463342 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:22.464461 [debug] [MainThread]: On master: BEGIN
[0m19:10:22.466435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:22.479461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:10:22.480588 [debug] [MainThread]: On master: COMMIT
[0m19:10:22.481468 [debug] [MainThread]: Using postgres connection "master"
[0m19:10:22.482311 [debug] [MainThread]: On master: COMMIT
[0m19:10:22.483330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:10:22.485702 [debug] [MainThread]: On master: Close
[0m19:10:22.487223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:22.488169 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target' was properly closed.
[0m19:10:22.489048 [info ] [MainThread]: 
[0m19:10:22.490710 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m19:10:22.492344 [debug] [MainThread]: Command end result
[0m19:10:22.508170 [info ] [MainThread]: 
[0m19:10:22.509350 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:10:22.510377 [info ] [MainThread]: 
[0m19:10:22.511430 [error] [MainThread]:   Database Error in model sales_target (models/marts/sales_target.sql)
  relation "salestarget" does not exist
  LINE 18: FROM salestarget st 
                ^
  compiled Code at target/run/postgres_dbt/models/marts/sales_target.sql
[0m19:10:22.512461 [info ] [MainThread]: 
[0m19:10:22.513817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:10:22.521326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5433153, "process_user_time": 4.176339, "process_kernel_time": 0.621949, "process_mem_max_rss": "110731264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:10:22.524167 [debug] [MainThread]: Command `dbt run` failed at 19:10:22.523620 after 1.55 seconds
[0m19:10:22.525403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab85660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de477c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de46d10>]}
[0m19:10:22.526471 [debug] [MainThread]: Flushing usage events
[0m19:11:32.685981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e239b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d24d0>]}


============================== 19:11:32.693519 | 8587a061-87b5-470d-ab17-9c2ca802f5b1 ==============================
[0m19:11:32.693519 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:11:32.696150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m sales_target.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:32.984238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8587a061-87b5-470d-ab17-9c2ca802f5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d2740>]}
[0m19:11:33.107891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8587a061-87b5-470d-ab17-9c2ca802f5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107921a0>]}
[0m19:11:33.111296 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:11:33.140070 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:11:33.257373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:11:33.258576 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales_target.sql
[0m19:11:33.456457 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:11:33.463795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8587a061-87b5-470d-ab17-9c2ca802f5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e80d0>]}
[0m19:11:33.478542 [error] [MainThread]: Encountered an error:
Found a cycle: model.postgres_dbt.sales_target
[0m19:11:33.494758 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/task/runnable.py", line 143, in _runtime_initialize
    self.compile_manifest()
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/task/base.py", line 173, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/compilation.py", line 455, in compile
    linker.link_graph(manifest)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/compilation.py", line 200, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.postgres_dbt.sales_target

[0m19:11:33.498932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9066029, "process_user_time": 3.775534, "process_kernel_time": 0.404593, "process_mem_max_rss": "106708992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:11:33.501010 [debug] [MainThread]: Command `dbt run` failed at 19:11:33.500400 after 0.91 seconds
[0m19:11:33.502544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e239b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135d030>]}
[0m19:11:33.503839 [debug] [MainThread]: Flushing usage events
[0m19:12:47.711400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108506b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9e560>]}


============================== 19:12:47.719640 | 5b1dc393-e1a3-488b-a85b-696b6f12190f ==============================
[0m19:12:47.719640 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:12:47.721122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m sales_target_result.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:12:48.039278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9e7d0>]}
[0m19:12:48.161193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbab60>]}
[0m19:12:48.164653 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:12:48.194159 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:12:48.324754 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:12:48.326006 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/marts/sales_target_result.sql
[0m19:12:48.326858 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://models/marts/sales_target.sql
[0m19:12:48.514834 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:12:48.522377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b40d0>]}
[0m19:12:48.540466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b628e50>]}
[0m19:12:48.541562 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:12:48.542641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b629180>]}
[0m19:12:48.545125 [info ] [MainThread]: 
[0m19:12:48.546646 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:12:48.549303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:12:48.568365 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:12:48.569713 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:12:48.571046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:48.617787 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:12:48.620193 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:12:48.623908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:12:48.633772 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:12:48.634784 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:12:48.635703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:12:48.643282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.644380 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:12:48.645370 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:12:48.651649 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:12:48.653720 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:12:48.654690 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:12:48.711409 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.712394 [debug] [MainThread]: On master: BEGIN
[0m19:12:48.713270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:48.719853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.720739 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.721642 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:12:48.757406 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:12:48.759353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b64afe0>]}
[0m19:12:48.760323 [debug] [MainThread]: On master: ROLLBACK
[0m19:12:48.761294 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.762135 [debug] [MainThread]: On master: BEGIN
[0m19:12:48.763297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.764156 [debug] [MainThread]: On master: COMMIT
[0m19:12:48.764993 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.765817 [debug] [MainThread]: On master: COMMIT
[0m19:12:48.766829 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:12:48.767689 [debug] [MainThread]: On master: Close
[0m19:12:48.769088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:48.770211 [info ] [MainThread]: 
[0m19:12:48.774988 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target_result
[0m19:12:48.776268 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.sales_target_result ..................... [RUN]
[0m19:12:48.777735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales_target_result)
[0m19:12:48.778734 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target_result
[0m19:12:48.790983 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target_result"
[0m19:12:48.793227 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (compile): 19:12:48.779328 => 19:12:48.792299
[0m19:12:48.794256 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target_result
[0m19:12:48.844492 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales_target_result"
[0m19:12:48.845952 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:12:48.846905 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: BEGIN
[0m19:12:48.847786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:48.854359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.855325 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:12:48.856370 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */

  create view "contosodb"."dbt_schema"."sales_target_result__dbt_tmp"
    
    
  as (
    SELECT 
st.storekey,
ss.storename,
st.salestarget,
ss.totalsales,
(ss.totalsales - st.salestarget) as salesdiff,
CASE 
    WHEN 
    (ss.totalsales - st.salestarget) < 0 THEN 'NO'
    ELSE 'YES'
    END AS target_achieved
FROM "contosodb"."dbt_schema"."salestarget" st 
JOIN "contosodb"."dbt_schema"."sales" ss 
ON ss.storekey = st.storekey
  );
[0m19:12:48.859375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column ss.storekey does not exist
LINE 20: ON ss.storekey = st.storekey
            ^
HINT:  Perhaps you meant to reference the column "st.storekey".

[0m19:12:48.860519 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: ROLLBACK
[0m19:12:48.861953 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (execute): 19:12:48.794841 => 19:12:48.861498
[0m19:12:48.862875 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: Close
[0m19:12:48.916256 [debug] [Thread-1 (]: Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  column ss.storekey does not exist
  LINE 20: ON ss.storekey = st.storekey
              ^
  HINT:  Perhaps you meant to reference the column "st.storekey".
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:12:48.918155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b1dc393-e1a3-488b-a85b-696b6f12190f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af52740>]}
[0m19:12:48.919900 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.sales_target_result ............ [[31mERROR[0m in 0.14s]
[0m19:12:48.921727 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target_result
[0m19:12:48.924597 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.925787 [debug] [MainThread]: On master: BEGIN
[0m19:12:48.926745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:48.937484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:12:48.939505 [debug] [MainThread]: On master: COMMIT
[0m19:12:48.940901 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:48.942362 [debug] [MainThread]: On master: COMMIT
[0m19:12:48.943431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:12:48.944299 [debug] [MainThread]: On master: Close
[0m19:12:48.945599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:48.946603 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target_result' was properly closed.
[0m19:12:48.947475 [info ] [MainThread]: 
[0m19:12:48.948405 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:12:48.949744 [debug] [MainThread]: Command end result
[0m19:12:48.964371 [info ] [MainThread]: 
[0m19:12:48.965431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:48.966356 [info ] [MainThread]: 
[0m19:12:48.967288 [error] [MainThread]:   Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  column ss.storekey does not exist
  LINE 20: ON ss.storekey = st.storekey
              ^
  HINT:  Perhaps you meant to reference the column "st.storekey".
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:12:48.968199 [info ] [MainThread]: 
[0m19:12:48.969168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:48.975574 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.376757, "process_user_time": 4.213355, "process_kernel_time": 0.602919, "process_mem_max_rss": "110460928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:12:48.976974 [debug] [MainThread]: Command `dbt run` failed at 19:12:48.976592 after 1.38 seconds
[0m19:12:48.977940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108506b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa130d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66b760>]}
[0m19:12:48.978854 [debug] [MainThread]: Flushing usage events
[0m19:13:18.836083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb36890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb36530>]}


============================== 19:13:18.842093 | 68bad93d-af5f-4b51-b064-afc3020daa2e ==============================
[0m19:13:18.842093 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:13:18.843282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed -s salestarget.csv', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:19.103946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb367a0>]}
[0m19:13:19.222980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaab3d0>]}
[0m19:13:19.224459 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:13:19.248377 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:13:19.305986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:19.307260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:19.308882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:13:19.318611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6f2200>]}
[0m19:13:19.335003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6cce20>]}
[0m19:13:19.336235 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:13:19.337326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6cd150>]}
[0m19:13:19.343190 [info ] [MainThread]: 
[0m19:13:19.344896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:13:19.346623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:13:19.364441 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:13:19.365410 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:13:19.366271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:19.400964 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:13:19.403617 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:13:19.407069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:13:19.416866 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:13:19.417895 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:13:19.418723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:19.424998 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:13:19.425889 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:13:19.426849 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:13:19.432815 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:13:19.435000 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:13:19.435982 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:13:19.445321 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:19.446264 [debug] [MainThread]: On master: BEGIN
[0m19:13:19.447076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:19.453211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:19.454106 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:19.455019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:13:19.493480 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:13:19.495537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f73aef0>]}
[0m19:13:19.496567 [debug] [MainThread]: On master: ROLLBACK
[0m19:13:19.497613 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:19.498470 [debug] [MainThread]: On master: BEGIN
[0m19:13:19.499685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:19.500587 [debug] [MainThread]: On master: COMMIT
[0m19:13:19.501446 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:19.502297 [debug] [MainThread]: On master: COMMIT
[0m19:13:19.503361 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:19.504264 [debug] [MainThread]: On master: Close
[0m19:13:19.505658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:19.506743 [info ] [MainThread]: 
[0m19:13:19.510245 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m19:13:19.511384 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_schema.salestarget .................................. [RUN]
[0m19:13:19.512784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now seed.postgres_dbt.salestarget)
[0m19:13:19.513776 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m19:13:19.515391 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 19:13:19.514741 => 19:13:19.514747
[0m19:13:19.516371 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m19:13:19.564174 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:13:19.565194 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: BEGIN
[0m19:13:19.566077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:19.573528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:19.574588 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:13:19.575494 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "seed.postgres_dbt.salestarget"} */
truncate table "contosodb"."dbt_schema"."salestarget"
[0m19:13:19.577887 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m19:13:19.605227 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:13:19.606233 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: 
          insert into "contosodb"."dbt_schema"."salestarget" ("storekey", "salestarget") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m19:13:19.608013 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.0 seconds
[0m19:13:19.615848 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.postgres_dbt.salestarget"
[0m19:13:19.635938 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: COMMIT
[0m19:13:19.636942 [debug] [Thread-1 (]: Using postgres connection "seed.postgres_dbt.salestarget"
[0m19:13:19.637845 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: COMMIT
[0m19:13:19.640827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:19.642946 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 19:13:19.516979 => 19:13:19.642454
[0m19:13:19.643951 [debug] [Thread-1 (]: On seed.postgres_dbt.salestarget: Close
[0m19:13:19.645303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68bad93d-af5f-4b51-b064-afc3020daa2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7840d0>]}
[0m19:13:19.646567 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_schema.salestarget .............................. [[32mINSERT 5[0m in 0.13s]
[0m19:13:19.648108 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m19:13:19.650177 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:19.651065 [debug] [MainThread]: On master: BEGIN
[0m19:13:19.651982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:19.660953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:19.662107 [debug] [MainThread]: On master: COMMIT
[0m19:13:19.663325 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:19.664227 [debug] [MainThread]: On master: COMMIT
[0m19:13:19.665225 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:19.666109 [debug] [MainThread]: On master: Close
[0m19:13:19.667389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:19.668342 [debug] [MainThread]: Connection 'seed.postgres_dbt.salestarget' was properly closed.
[0m19:13:19.669218 [info ] [MainThread]: 
[0m19:13:19.670176 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m19:13:19.671549 [debug] [MainThread]: Command end result
[0m19:13:19.683309 [info ] [MainThread]: 
[0m19:13:19.684384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:19.685321 [info ] [MainThread]: 
[0m19:13:19.686287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:13:19.688456 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.9289309, "process_user_time": 3.328518, "process_kernel_time": 0.268917, "process_mem_max_rss": "107618304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:13:19.690436 [debug] [MainThread]: Command `dbt seed` succeeded at 19:13:19.689651 after 0.93 seconds
[0m19:13:19.691552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7842e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6abcd0>]}
[0m19:13:19.692703 [debug] [MainThread]: Flushing usage events
[0m19:14:42.871734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc2860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc2500>]}


============================== 19:14:42.888094 | ef58543a-1a66-480e-b6c3-b7722adda6fa ==============================
[0m19:14:42.888094 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:14:42.889872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed -s salestarget.csv', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:43.351974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef58543a-1a66-480e-b6c3-b7722adda6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc2770>]}
[0m19:14:43.479520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef58543a-1a66-480e-b6c3-b7722adda6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edad060>]}
[0m19:14:43.481437 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:14:43.512067 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:14:43.628197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:43.629511 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales_target_result.sql
[0m19:14:43.830626 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.postgres_dbt.sales_target_result' (models/marts/sales_target_result.sql) depends on a node named 'salestarget.csv' which was not found
[0m19:14:43.836222 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.0709486, "process_user_time": 3.90743, "process_kernel_time": 0.580086, "process_mem_max_rss": "103268352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:14:43.844070 [debug] [MainThread]: Command `dbt seed` failed at 19:14:43.843212 after 1.08 seconds
[0m19:14:43.847057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8d2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f867010>]}
[0m19:14:43.851974 [debug] [MainThread]: Flushing usage events
[0m19:15:40.210322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee65c0>]}


============================== 19:15:40.215631 | d51ecedc-ac59-4e8b-beca-a639f90ef7d9 ==============================
[0m19:15:40.215631 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:15:40.216843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m sales_target_result.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:15:40.481079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee6830>]}
[0m19:15:40.601342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5a470>]}
[0m19:15:40.602803 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:15:40.624284 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:15:40.681914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:15:40.683156 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales_target_result.sql
[0m19:15:40.866107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:15:40.873906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfc0d0>]}
[0m19:15:40.893651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a70eb0>]}
[0m19:15:40.894983 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:15:40.896065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a711e0>]}
[0m19:15:40.899166 [info ] [MainThread]: 
[0m19:15:40.901265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:40.903920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:15:40.922399 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:15:40.923794 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:15:40.924666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:40.971396 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:15:40.973776 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:15:40.976841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:15:40.985974 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:15:40.986916 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:15:40.987797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:40.994938 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:40.996037 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:15:40.997019 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:15:41.003794 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:15:41.005816 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:15:41.006770 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:15:41.063728 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:41.064710 [debug] [MainThread]: On master: BEGIN
[0m19:15:41.065587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:41.072000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:41.072910 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:41.073849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:41.109624 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:15:41.111595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092641f0>]}
[0m19:15:41.112559 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:41.113537 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:41.114364 [debug] [MainThread]: On master: BEGIN
[0m19:15:41.115431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:41.116270 [debug] [MainThread]: On master: COMMIT
[0m19:15:41.117086 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:41.117899 [debug] [MainThread]: On master: COMMIT
[0m19:15:41.118823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:41.119663 [debug] [MainThread]: On master: Close
[0m19:15:41.120946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:41.121973 [info ] [MainThread]: 
[0m19:15:41.126632 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target_result
[0m19:15:41.128020 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.sales_target_result ..................... [RUN]
[0m19:15:41.129875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales_target_result)
[0m19:15:41.131052 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target_result
[0m19:15:41.143089 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target_result"
[0m19:15:41.144521 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (compile): 19:15:41.131867 => 19:15:41.144060
[0m19:15:41.145480 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target_result
[0m19:15:41.209412 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales_target_result"
[0m19:15:41.211074 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:15:41.212119 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: BEGIN
[0m19:15:41.213033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:41.220854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:41.222819 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:15:41.224500 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */

  create view "contosodb"."dbt_schema"."sales_target_result__dbt_tmp"
    
    
  as (
    SELECT 
st.storekey,
ss.storename,
st.salestarget,
ss.totalsales,
(ss.totalsales - st.salestarget) as salesdiff,
CASE 
    WHEN 
    (ss.totalsales - st.salestarget) < 0 THEN 'NO'
    ELSE 'YES'
    END AS target_achieved
FROM salestarget st 
JOIN "contosodb"."dbt_schema"."sales" ss 
ON ss.storekey = st.storekey
  );
[0m19:15:41.227840 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "salestarget" does not exist
LINE 18: FROM salestarget st 
              ^

[0m19:15:41.229027 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: ROLLBACK
[0m19:15:41.230816 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (execute): 19:15:41.146126 => 19:15:41.230211
[0m19:15:41.232620 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: Close
[0m19:15:41.255545 [debug] [Thread-1 (]: Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  relation "salestarget" does not exist
  LINE 18: FROM salestarget st 
                ^
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:15:41.257396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51ecedc-ac59-4e8b-beca-a639f90ef7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a91120>]}
[0m19:15:41.259056 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.sales_target_result ............ [[31mERROR[0m in 0.13s]
[0m19:15:41.261021 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target_result
[0m19:15:41.263727 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:41.264749 [debug] [MainThread]: On master: BEGIN
[0m19:15:41.265690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:41.275332 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:41.276353 [debug] [MainThread]: On master: COMMIT
[0m19:15:41.277199 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:41.278028 [debug] [MainThread]: On master: COMMIT
[0m19:15:41.279067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:41.279923 [debug] [MainThread]: On master: Close
[0m19:15:41.281159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:41.282155 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target_result' was properly closed.
[0m19:15:41.283514 [info ] [MainThread]: 
[0m19:15:41.284876 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:15:41.286842 [debug] [MainThread]: Command end result
[0m19:15:41.300861 [info ] [MainThread]: 
[0m19:15:41.303332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:15:41.304717 [info ] [MainThread]: 
[0m19:15:41.306480 [error] [MainThread]:   Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  relation "salestarget" does not exist
  LINE 18: FROM salestarget st 
                ^
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:15:41.308627 [info ] [MainThread]: 
[0m19:15:41.309855 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:15:41.312095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1752635, "process_user_time": 3.57073, "process_kernel_time": 0.277727, "process_mem_max_rss": "110891008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:41.313862 [debug] [MainThread]: Command `dbt run` failed at 19:15:41.312982 after 1.18 seconds
[0m19:15:41.314914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a7a60>]}
[0m19:15:41.315821 [debug] [MainThread]: Flushing usage events
[0m19:16:12.650733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102809660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4a560>]}


============================== 19:16:12.656319 | c8bdb92a-f1e7-4634-b992-6b664e7d8ba9 ==============================
[0m19:16:12.656319 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:16:12.657520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m sales_target_result.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:16:12.922614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4a7d0>]}
[0m19:16:13.047484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526ab60>]}
[0m19:16:13.048984 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:16:13.070401 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:16:13.128858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:13.130147 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales_target_result.sql
[0m19:16:13.314602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:16:13.322694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a480d0>]}
[0m19:16:13.339958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e0df0>]}
[0m19:16:13.341040 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:16:13.342010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e1120>]}
[0m19:16:13.344445 [info ] [MainThread]: 
[0m19:16:13.346793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:16:13.349024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:16:13.367574 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:16:13.369379 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:16:13.370499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:13.404263 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:16:13.406614 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:16:13.410760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:16:13.419771 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:16:13.420815 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:16:13.421648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:13.428010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.428908 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:16:13.429763 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:16:13.435800 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:16:13.437879 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:16:13.438941 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:16:13.496200 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.497198 [debug] [MainThread]: On master: BEGIN
[0m19:16:13.498079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:13.504573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.505470 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.506382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:16:13.542342 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:16:13.544309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105903be0>]}
[0m19:16:13.545286 [debug] [MainThread]: On master: ROLLBACK
[0m19:16:13.546283 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.547127 [debug] [MainThread]: On master: BEGIN
[0m19:16:13.548204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.549057 [debug] [MainThread]: On master: COMMIT
[0m19:16:13.549895 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.550758 [debug] [MainThread]: On master: COMMIT
[0m19:16:13.551696 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:16:13.552537 [debug] [MainThread]: On master: Close
[0m19:16:13.553833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:13.554896 [info ] [MainThread]: 
[0m19:16:13.557515 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target_result
[0m19:16:13.558585 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.sales_target_result ..................... [RUN]
[0m19:16:13.560076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales_target_result)
[0m19:16:13.561161 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target_result
[0m19:16:13.574471 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target_result"
[0m19:16:13.575944 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (compile): 19:16:13.561812 => 19:16:13.575474
[0m19:16:13.576866 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target_result
[0m19:16:13.629608 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales_target_result"
[0m19:16:13.631029 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:16:13.631943 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: BEGIN
[0m19:16:13.632855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:13.639371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.640353 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:16:13.641278 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */

  create view "contosodb"."dbt_schema"."sales_target_result__dbt_tmp"
    
    
  as (
    SELECT 
st.storekey,
ss.storename,
st.salestarget,
ss.totalsales,
(ss.totalsales - st.salestarget) as salesdiff,
CASE 
    WHEN 
    (ss.totalsales - st.salestarget) < 0 THEN 'NO'
    ELSE 'YES'
    END AS target_achieved
FROM public.salestarget st 
JOIN "contosodb"."dbt_schema"."sales" ss 
ON ss.storekey = st.storekey
  );
[0m19:16:13.643043 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.salestarget" does not exist
LINE 18: FROM public.salestarget st 
              ^

[0m19:16:13.644028 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: ROLLBACK
[0m19:16:13.645414 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (execute): 19:16:13.577456 => 19:16:13.644960
[0m19:16:13.646326 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: Close
[0m19:16:13.649643 [debug] [Thread-1 (]: Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  relation "public.salestarget" does not exist
  LINE 18: FROM public.salestarget st 
                ^
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:16:13.650772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bdb92a-f1e7-4634-b992-6b664e7d8ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105203c40>]}
[0m19:16:13.652004 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.sales_target_result ............ [[31mERROR[0m in 0.09s]
[0m19:16:13.653420 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target_result
[0m19:16:13.655460 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.656356 [debug] [MainThread]: On master: BEGIN
[0m19:16:13.657193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:13.664548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.665471 [debug] [MainThread]: On master: COMMIT
[0m19:16:13.666382 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.667335 [debug] [MainThread]: On master: COMMIT
[0m19:16:13.668521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:16:13.669431 [debug] [MainThread]: On master: Close
[0m19:16:13.671590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:13.672870 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target_result' was properly closed.
[0m19:16:13.674138 [info ] [MainThread]: 
[0m19:16:13.675141 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m19:16:13.676492 [debug] [MainThread]: Command end result
[0m19:16:13.690259 [info ] [MainThread]: 
[0m19:16:13.691492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:16:13.692878 [info ] [MainThread]: 
[0m19:16:13.694416 [error] [MainThread]:   Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  relation "public.salestarget" does not exist
  LINE 18: FROM public.salestarget st 
                ^
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:16:13.695559 [info ] [MainThread]: 
[0m19:16:13.696804 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:16:13.699067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1240337, "process_user_time": 3.569382, "process_kernel_time": 0.267461, "process_mem_max_rss": "111026176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:16:13.700243 [debug] [MainThread]: Command `dbt run` failed at 19:16:13.699927 after 1.13 seconds
[0m19:16:13.701313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102809660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104927790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104927760>]}
[0m19:16:13.702898 [debug] [MainThread]: Flushing usage events
[0m19:18:24.576642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f173d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b6800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b64a0>]}


============================== 19:18:24.583453 | b82b3eb7-a368-4e0c-8397-a1447a809b2b ==============================
[0m19:18:24.583453 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:18:24.584683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m sales_target_result.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:24.933132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b6710>]}
[0m19:18:25.055882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134758a0>]}
[0m19:18:25.058732 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:18:25.105228 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:18:25.216142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:25.217884 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales_target_result.sql
[0m19:18:25.419263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:18:25.428988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d40d0>]}
[0m19:18:25.449121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11404cd60>]}
[0m19:18:25.450256 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:18:25.451617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11404cfa0>]}
[0m19:18:25.454510 [info ] [MainThread]: 
[0m19:18:25.456147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:25.460939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:18:25.480396 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:18:25.481375 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:18:25.482230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:25.526487 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:18:25.529067 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:18:25.536076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:18:25.548737 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:18:25.549658 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:18:25.550468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:25.557412 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:18:25.558327 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:18:25.559182 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:18:25.565935 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:18:25.568123 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:18:25.569150 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:18:25.630154 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:25.631073 [debug] [MainThread]: On master: BEGIN
[0m19:18:25.631884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:25.638917 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:25.639818 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:25.640735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:25.684505 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:18:25.686521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114071300>]}
[0m19:18:25.687631 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:25.688667 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:25.689526 [debug] [MainThread]: On master: BEGIN
[0m19:18:25.692212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:25.693160 [debug] [MainThread]: On master: COMMIT
[0m19:18:25.693996 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:25.694833 [debug] [MainThread]: On master: COMMIT
[0m19:18:25.696043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:18:25.696932 [debug] [MainThread]: On master: Close
[0m19:18:25.698482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:25.700532 [info ] [MainThread]: 
[0m19:18:25.705195 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target_result
[0m19:18:25.706554 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.sales_target_result ..................... [RUN]
[0m19:18:25.709060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales_target_result)
[0m19:18:25.710044 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target_result
[0m19:18:25.721307 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target_result"
[0m19:18:25.723059 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (compile): 19:18:25.710638 => 19:18:25.722411
[0m19:18:25.724017 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target_result
[0m19:18:25.785151 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales_target_result"
[0m19:18:25.787072 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:18:25.788094 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: BEGIN
[0m19:18:25.789057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:25.797039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:25.798726 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:18:25.800222 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */

  create view "contosodb"."dbt_schema"."sales_target_result__dbt_tmp"
    
    
  as (
    SELECT 
st.storekey,
ss.storename,
st.salestarget,
ss.totalsales,
(ss.totalsales - st.salestarget) as salesdiff,
CASE 
    WHEN 
    (ss.totalsales - st.salestarget) < 0 THEN 'NO'
    ELSE 'YES'
    END AS target_achieved
FROM "contosodb"."dbt_schema"."salestarget" st 
JOIN "contosodb"."dbt_schema"."sales" ss 
ON ss.storekey = st.storekey
  );
[0m19:18:25.803816 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column ss.storekey does not exist
LINE 20: ON ss.storekey = st.storekey
            ^
HINT:  Perhaps you meant to reference the column "st.storekey".

[0m19:18:25.804901 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: ROLLBACK
[0m19:18:25.806372 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (execute): 19:18:25.724699 => 19:18:25.805897
[0m19:18:25.807307 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: Close
[0m19:18:25.830121 [debug] [Thread-1 (]: Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  column ss.storekey does not exist
  LINE 20: ON ss.storekey = st.storekey
              ^
  HINT:  Perhaps you meant to reference the column "st.storekey".
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:18:25.831380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82b3eb7-a368-4e0c-8397-a1447a809b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114072830>]}
[0m19:18:25.832710 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.sales_target_result ............ [[31mERROR[0m in 0.12s]
[0m19:18:25.834580 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target_result
[0m19:18:25.837384 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:25.838280 [debug] [MainThread]: On master: BEGIN
[0m19:18:25.839101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:25.870823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:25.871857 [debug] [MainThread]: On master: COMMIT
[0m19:18:25.872706 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:25.874599 [debug] [MainThread]: On master: COMMIT
[0m19:18:25.883704 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:18:25.884693 [debug] [MainThread]: On master: Close
[0m19:18:25.887863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:25.890018 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target_result' was properly closed.
[0m19:18:25.890983 [info ] [MainThread]: 
[0m19:18:25.891886 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m19:18:25.893178 [debug] [MainThread]: Command end result
[0m19:18:25.925276 [info ] [MainThread]: 
[0m19:18:26.044007 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:18:26.056394 [info ] [MainThread]: 
[0m19:18:26.063075 [error] [MainThread]:   Database Error in model sales_target_result (models/marts/sales_target_result.sql)
  column ss.storekey does not exist
  LINE 20: ON ss.storekey = st.storekey
              ^
  HINT:  Perhaps you meant to reference the column "st.storekey".
  compiled Code at target/run/postgres_dbt/models/marts/sales_target_result.sql
[0m19:18:26.066114 [info ] [MainThread]: 
[0m19:18:26.068618 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:18:26.072535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5839229, "process_user_time": 3.844343, "process_kernel_time": 0.421792, "process_mem_max_rss": "110891008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:18:26.078159 [debug] [MainThread]: Command `dbt run` failed at 19:18:26.077408 after 1.59 seconds
[0m19:18:26.080207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f173d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113083760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138771c0>]}
[0m19:18:26.084453 [debug] [MainThread]: Flushing usage events
[0m19:19:13.559425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3bf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111956800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119564a0>]}


============================== 19:19:13.564878 | 23813fa2-3b9a-4daf-9b76-de6276323315 ==============================
[0m19:19:13.564878 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:19:13.566056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m sales_target_result.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:19:13.830176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111956710>]}
[0m19:19:13.949946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111916470>]}
[0m19:19:13.951349 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:19:13.971627 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:19:14.031275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:19:14.032489 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales_target_result.sql
[0m19:19:14.215024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:19:14.222858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11266c0d0>]}
[0m19:19:14.240063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e0dc0>]}
[0m19:19:14.241156 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m19:19:14.242212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e1000>]}
[0m19:19:14.246727 [info ] [MainThread]: 
[0m19:19:14.249561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:19:14.251756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:19:14.268814 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:19:14.269813 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:19:14.270828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:14.308792 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:19:14.312783 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:19:14.317754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:19:14.326785 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:19:14.327716 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:19:14.328525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:14.334985 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:19:14.335872 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:19:14.336712 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:19:14.342749 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:19:14.344823 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:19:14.345809 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:19:14.403586 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.404583 [debug] [MainThread]: On master: BEGIN
[0m19:19:14.405471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:14.412149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:14.413041 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.413953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:14.451135 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:19:14.453126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112501f60>]}
[0m19:19:14.454096 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:14.455146 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.456011 [debug] [MainThread]: On master: BEGIN
[0m19:19:14.457089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:14.457941 [debug] [MainThread]: On master: COMMIT
[0m19:19:14.458786 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.459604 [debug] [MainThread]: On master: COMMIT
[0m19:19:14.460527 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:14.461353 [debug] [MainThread]: On master: Close
[0m19:19:14.462616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:14.463645 [info ] [MainThread]: 
[0m19:19:14.466269 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target_result
[0m19:19:14.467343 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.sales_target_result ..................... [RUN]
[0m19:19:14.468779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales_target_result)
[0m19:19:14.469823 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target_result
[0m19:19:14.483223 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target_result"
[0m19:19:14.484835 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (compile): 19:19:14.470702 => 19:19:14.484320
[0m19:19:14.485789 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target_result
[0m19:19:14.539080 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales_target_result"
[0m19:19:14.540504 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:19:14.541448 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: BEGIN
[0m19:19:14.542374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:14.549162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:14.550289 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:19:14.551970 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */

  create view "contosodb"."dbt_schema"."sales_target_result__dbt_tmp"
    
    
  as (
    SELECT 
st.storekey,
ss.storename,
st.salestarget,
ss.totalsales,
(ss.totalsales - st.salestarget) as salesdiff,
CASE 
    WHEN 
    (ss.totalsales - st.salestarget) < 0 THEN 'NO'
    ELSE 'YES'
    END AS target_achieved
FROM "contosodb"."dbt_schema"."salestarget" st 
JOIN "contosodb"."dbt_schema"."store_sales" ss 
ON ss.storekey = st.storekey
  );
[0m19:19:14.564628 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:14.579761 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:19:14.581464 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */
alter table "contosodb"."dbt_schema"."sales_target_result__dbt_tmp" rename to "sales_target_result"
[0m19:19:14.585126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:14.616662 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: COMMIT
[0m19:19:14.618141 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:19:14.619639 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: COMMIT
[0m19:19:14.621973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:14.634271 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."sales_target_result__dbt_backup"
[0m19:19:14.641000 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales_target_result"
[0m19:19:14.641971 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales_target_result"} */
drop view if exists "contosodb"."dbt_schema"."sales_target_result__dbt_backup" cascade
[0m19:19:14.644244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:14.647142 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (execute): 19:19:14.486372 => 19:19:14.646625
[0m19:19:14.648197 [debug] [Thread-1 (]: On model.postgres_dbt.sales_target_result: Close
[0m19:19:14.649765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23813fa2-3b9a-4daf-9b76-de6276323315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126db340>]}
[0m19:19:14.651226 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.sales_target_result ................ [[32mCREATE VIEW[0m in 0.18s]
[0m19:19:14.652589 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target_result
[0m19:19:14.654521 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.655391 [debug] [MainThread]: On master: BEGIN
[0m19:19:14.656208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:14.665619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:14.666836 [debug] [MainThread]: On master: COMMIT
[0m19:19:14.668039 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.669066 [debug] [MainThread]: On master: COMMIT
[0m19:19:14.670070 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:14.670937 [debug] [MainThread]: On master: Close
[0m19:19:14.672170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:14.673086 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target_result' was properly closed.
[0m19:19:14.673952 [info ] [MainThread]: 
[0m19:19:14.674865 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m19:19:14.676194 [debug] [MainThread]: Command end result
[0m19:19:14.687784 [info ] [MainThread]: 
[0m19:19:14.688853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:14.689769 [info ] [MainThread]: 
[0m19:19:14.690783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:14.692884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2079222, "process_user_time": 3.623513, "process_kernel_time": 0.293959, "process_mem_max_rss": "110739456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:19:14.694100 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:14.693719 after 1.21 seconds
[0m19:19:14.695217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3bf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11234dba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126b4970>]}
[0m19:19:14.696445 [debug] [MainThread]: Flushing usage events
[0m20:53:11.916155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105e590>]}


============================== 20:53:11.932837 | 9e0ec8f8-86d6-4261-afce-2a3bc8dee60d ==============================
[0m20:53:11.932837 [info ] [MainThread]: Running with dbt=1.7.6
[0m20:53:11.935247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m int_contoso__stores_products.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:12.511131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e0ec8f8-86d6-4261-afce-2a3bc8dee60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105e800>]}
[0m20:53:12.635866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e0ec8f8-86d6-4261-afce-2a3bc8dee60d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111552710>]}
[0m20:53:12.639397 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m20:53:12.670003 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m20:53:12.832127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:53:12.833614 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/intermediate/int_contoso__stores_products.sql
[0m20:53:12.834738 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/schema.yml
[0m20:53:13.211286 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.postgres_dbt.int_contoso__stores_products' (models/intermediate/int_contoso__stores_products.sql) depends on a source named 'contosodb.stores' which was not found
[0m20:53:13.216776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4247254, "process_user_time": 4.174894, "process_kernel_time": 0.575972, "process_mem_max_rss": "105037824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:53:13.218255 [debug] [MainThread]: Command `dbt run` failed at 20:53:13.217882 after 1.43 seconds
[0m20:53:13.219562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db83d0>]}
[0m20:53:13.220916 [debug] [MainThread]: Flushing usage events
[0m20:53:58.936531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeaf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ee860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ee500>]}


============================== 20:53:58.941884 | 12ee94e0-620c-4fb0-a743-de68e4fc9c37 ==============================
[0m20:53:58.941884 [info ] [MainThread]: Running with dbt=1.7.6
[0m20:53:58.943087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m int_contoso__stores_products.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:53:59.268247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ee770>]}
[0m20:53:59.408590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d9060>]}
[0m20:53:59.410179 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m20:53:59.442565 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m20:53:59.523386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:53:59.526685 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/schema.yml
[0m20:53:59.528733 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/intermediate/int_contoso__stores_products.sql
[0m20:53:59.957238 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m20:53:59.965726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f59f0>]}
[0m20:53:59.983925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f67df0>]}
[0m20:53:59.985367 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:53:59.986581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f67e20>]}
[0m20:53:59.988947 [info ] [MainThread]: 
[0m20:53:59.990331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:53:59.992368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m20:54:00.024823 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m20:54:00.025796 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m20:54:00.026664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:00.081043 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:54:00.085376 [debug] [ThreadPool]: On list_contosodb: Close
[0m20:54:00.090792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m20:54:00.101348 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m20:54:00.103568 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m20:54:00.104939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:00.122007 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:00.123295 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m20:54:00.124177 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m20:54:00.131725 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:54:00.134081 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m20:54:00.135286 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m20:54:00.145614 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:00.146529 [debug] [MainThread]: On master: BEGIN
[0m20:54:00.147417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:00.154019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:00.154926 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:00.155875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:00.197509 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:54:00.200486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112232860>]}
[0m20:54:00.201473 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:00.202801 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:00.203699 [debug] [MainThread]: On master: BEGIN
[0m20:54:00.204871 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:00.205759 [debug] [MainThread]: On master: COMMIT
[0m20:54:00.206612 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:00.207454 [debug] [MainThread]: On master: COMMIT
[0m20:54:00.208437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:00.209398 [debug] [MainThread]: On master: Close
[0m20:54:00.210821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:00.212233 [info ] [MainThread]: 
[0m20:54:00.215629 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores_products
[0m20:54:00.216727 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_contoso__stores_products ............ [RUN]
[0m20:54:00.218023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores_products)
[0m20:54:00.219417 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores_products
[0m20:54:00.234514 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:00.238190 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (compile): 20:54:00.220649 => 20:54:00.236231
[0m20:54:00.239152 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores_products
[0m20:54:00.310817 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:00.313494 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:00.314807 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: BEGIN
[0m20:54:00.315727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:00.323748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:00.325208 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:00.327227 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_tmp"
    
    
  as (
    WITH products AS (
    SELECT * FROM "contosodb"."public"."dimproducts"
),

stores AS (
    SELECT * FROM "contosodb"."public"."dimstores"
)

stores_products AS (
    SELECT storekey, productkey FROM "contosodb"."public"."fctsales"
    GROUP BY storekey, productkey 
),

final AS (
    SELECT 
    st.storename,
    p.productname
    FROM sales s
    JOIN products p
    ON s.productkey = p.productkey
    JOIN stores st
    ON s.storekey = st.storekey
)

SELECT * FROM final
  );
[0m20:54:00.330325 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "stores_products"
LINE 15: stores_products AS (
         ^

[0m20:54:00.332078 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: ROLLBACK
[0m20:54:00.333738 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (execute): 20:54:00.240097 => 20:54:00.333242
[0m20:54:00.334737 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: Close
[0m20:54:00.351894 [debug] [Thread-1 (]: Database Error in model int_contoso__stores_products (models/intermediate/int_contoso__stores_products.sql)
  syntax error at or near "stores_products"
  LINE 15: stores_products AS (
           ^
  compiled Code at target/run/postgres_dbt/models/intermediate/int_contoso__stores_products.sql
[0m20:54:00.353016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12ee94e0-620c-4fb0-a743-de68e4fc9c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224ebc0>]}
[0m20:54:00.354306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.int_contoso__stores_products ... [[31mERROR[0m in 0.14s]
[0m20:54:00.355791 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores_products
[0m20:54:00.357971 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:00.358966 [debug] [MainThread]: On master: BEGIN
[0m20:54:00.359808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:00.370821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:00.372444 [debug] [MainThread]: On master: COMMIT
[0m20:54:00.373600 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:00.374960 [debug] [MainThread]: On master: COMMIT
[0m20:54:00.376085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:00.378649 [debug] [MainThread]: On master: Close
[0m20:54:00.380961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:00.381913 [debug] [MainThread]: Connection 'model.postgres_dbt.int_contoso__stores_products' was properly closed.
[0m20:54:00.382863 [info ] [MainThread]: 
[0m20:54:00.384059 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:54:00.386376 [debug] [MainThread]: Command end result
[0m20:54:00.417128 [info ] [MainThread]: 
[0m20:54:00.419628 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:54:00.421231 [info ] [MainThread]: 
[0m20:54:00.422440 [error] [MainThread]:   Database Error in model int_contoso__stores_products (models/intermediate/int_contoso__stores_products.sql)
  syntax error at or near "stores_products"
  LINE 15: stores_products AS (
           ^
  compiled Code at target/run/postgres_dbt/models/intermediate/int_contoso__stores_products.sql
[0m20:54:00.423803 [info ] [MainThread]: 
[0m20:54:00.425505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:54:00.430108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5655098, "process_user_time": 3.856469, "process_kernel_time": 0.283424, "process_mem_max_rss": "112939008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:54:00.439092 [debug] [MainThread]: Command `dbt run` failed at 20:54:00.438333 after 1.58 seconds
[0m20:54:00.441233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeaf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112278d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112279ff0>]}
[0m20:54:00.442352 [debug] [MainThread]: Flushing usage events
[0m20:54:39.532251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f101660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169a560>]}


============================== 20:54:39.537956 | 2ed8477e-3398-4bd4-a2d7-182ac19fd7cd ==============================
[0m20:54:39.537956 [info ] [MainThread]: Running with dbt=1.7.6
[0m20:54:39.539423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m int_contoso__stores_products.sql', 'send_anonymous_usage_stats': 'True'}
[0m20:54:39.837073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169a7d0>]}
[0m20:54:39.966644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb6b60>]}
[0m20:54:39.968140 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m20:54:39.989017 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m20:54:40.061777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:40.063193 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/intermediate/int_contoso__stores_products.sql
[0m20:54:40.366489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m20:54:40.375818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a4a30>]}
[0m20:54:40.398891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112221c90>]}
[0m20:54:40.403222 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:54:40.404572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112221c00>]}
[0m20:54:40.407154 [info ] [MainThread]: 
[0m20:54:40.408880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:40.412236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m20:54:40.431406 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m20:54:40.432799 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m20:54:40.434747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:40.473874 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:54:40.478239 [debug] [ThreadPool]: On list_contosodb: Close
[0m20:54:40.483249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m20:54:40.497905 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m20:54:40.498843 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m20:54:40.499682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:40.507142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:54:40.508117 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m20:54:40.509086 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m20:54:40.515744 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:54:40.517969 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m20:54:40.519160 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m20:54:40.580831 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:40.581859 [debug] [MainThread]: On master: BEGIN
[0m20:54:40.582871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:40.590166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:40.591101 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:40.592074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:54:40.632921 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:54:40.635991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224a230>]}
[0m20:54:40.637215 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:40.638394 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:40.639305 [debug] [MainThread]: On master: BEGIN
[0m20:54:40.640600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:40.641540 [debug] [MainThread]: On master: COMMIT
[0m20:54:40.642451 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:40.643311 [debug] [MainThread]: On master: COMMIT
[0m20:54:40.644449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:40.645391 [debug] [MainThread]: On master: Close
[0m20:54:40.647284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:54:40.648321 [info ] [MainThread]: 
[0m20:54:40.651352 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores_products
[0m20:54:40.652574 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_contoso__stores_products ............ [RUN]
[0m20:54:40.653952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores_products)
[0m20:54:40.654943 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores_products
[0m20:54:40.667641 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:40.670049 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (compile): 20:54:40.655545 => 20:54:40.668870
[0m20:54:40.672858 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores_products
[0m20:54:40.751436 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:40.752994 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:40.754114 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: BEGIN
[0m20:54:40.755113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:40.762173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:54:40.763243 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:54:40.764387 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_tmp"
    
    
  as (
    WITH products AS (
    SELECT * FROM "contosodb"."public"."dimproducts"
),

stores AS (
    SELECT * FROM "contosodb"."public"."dimstores"
),

stores_products AS (
    SELECT storekey, productkey FROM "contosodb"."public"."fctsales"
    GROUP BY storekey, productkey 
),

final AS (
    SELECT 
    st.storename,
    p.productname
    FROM sales s
    JOIN products p
    ON s.productkey = p.productkey
    JOIN stores st
    ON s.storekey = st.storekey
)

SELECT * FROM final
  );
[0m20:54:40.766929 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "sales" does not exist
LINE 24:     FROM sales s
                  ^

[0m20:54:40.767992 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: ROLLBACK
[0m20:54:40.769611 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (execute): 20:54:40.673772 => 20:54:40.769100
[0m20:54:40.770587 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: Close
[0m20:54:40.774409 [debug] [Thread-1 (]: Database Error in model int_contoso__stores_products (models/intermediate/int_contoso__stores_products.sql)
  relation "sales" does not exist
  LINE 24:     FROM sales s
                    ^
  compiled Code at target/run/postgres_dbt/models/intermediate/int_contoso__stores_products.sql
[0m20:54:40.775536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed8477e-3398-4bd4-a2d7-182ac19fd7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224b8b0>]}
[0m20:54:40.776819 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.int_contoso__stores_products ... [[31mERROR[0m in 0.12s]
[0m20:54:40.778469 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores_products
[0m20:54:40.780676 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:40.781638 [debug] [MainThread]: On master: BEGIN
[0m20:54:40.782523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:40.792740 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:54:40.794082 [debug] [MainThread]: On master: COMMIT
[0m20:54:40.795003 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:40.795906 [debug] [MainThread]: On master: COMMIT
[0m20:54:40.797017 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:54:40.797976 [debug] [MainThread]: On master: Close
[0m20:54:40.799884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:40.803022 [debug] [MainThread]: Connection 'model.postgres_dbt.int_contoso__stores_products' was properly closed.
[0m20:54:40.804613 [info ] [MainThread]: 
[0m20:54:40.805930 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:54:40.807565 [debug] [MainThread]: Command end result
[0m20:54:40.826736 [info ] [MainThread]: 
[0m20:54:40.828221 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:54:40.829403 [info ] [MainThread]: 
[0m20:54:40.830553 [error] [MainThread]:   Database Error in model int_contoso__stores_products (models/intermediate/int_contoso__stores_products.sql)
  relation "sales" does not exist
  LINE 24:     FROM sales s
                    ^
  compiled Code at target/run/postgres_dbt/models/intermediate/int_contoso__stores_products.sql
[0m20:54:40.831705 [info ] [MainThread]: 
[0m20:54:40.834167 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:54:40.839550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3926293, "process_user_time": 3.828294, "process_kernel_time": 0.299143, "process_mem_max_rss": "110911488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:54:40.841656 [debug] [MainThread]: Command `dbt run` failed at 20:54:40.841091 after 1.39 seconds
[0m20:54:40.843649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f101660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112222920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112220b80>]}
[0m20:54:40.844847 [debug] [MainThread]: Flushing usage events
[0m20:55:14.492909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be69660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ae8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ae560>]}


============================== 20:55:14.498567 | ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a ==============================
[0m20:55:14.498567 [info ] [MainThread]: Running with dbt=1.7.6
[0m20:55:14.499765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m int_contoso__stores_products.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:14.787301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ae7d0>]}
[0m20:55:14.915405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8ceb60>]}
[0m20:55:14.916794 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m20:55:14.937806 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m20:55:14.996453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:14.998578 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/intermediate/int_contoso__stores_products.sql
[0m20:55:15.210029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m20:55:15.217729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a0a30>]}
[0m20:55:15.235031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef41c90>]}
[0m20:55:15.236125 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:55:15.237492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef41c00>]}
[0m20:55:15.242938 [info ] [MainThread]: 
[0m20:55:15.244490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:15.247232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m20:55:15.266889 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m20:55:15.267844 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m20:55:15.269886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:15.321006 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:55:15.325515 [debug] [ThreadPool]: On list_contosodb: Close
[0m20:55:15.330429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m20:55:15.344970 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m20:55:15.346111 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m20:55:15.347188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:15.354129 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:15.355028 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m20:55:15.355901 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m20:55:15.362344 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:55:15.364897 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m20:55:15.366017 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m20:55:15.427650 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:15.428610 [debug] [MainThread]: On master: BEGIN
[0m20:55:15.429455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:15.436538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:15.437460 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:15.438436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:15.482035 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:55:15.485521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef6fd30>]}
[0m20:55:15.486643 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:15.487730 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:15.488626 [debug] [MainThread]: On master: BEGIN
[0m20:55:15.489870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:15.490768 [debug] [MainThread]: On master: COMMIT
[0m20:55:15.491608 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:15.492413 [debug] [MainThread]: On master: COMMIT
[0m20:55:15.493381 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:15.494243 [debug] [MainThread]: On master: Close
[0m20:55:15.495495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:15.496358 [info ] [MainThread]: 
[0m20:55:15.500366 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores_products
[0m20:55:15.501492 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_contoso__stores_products ............ [RUN]
[0m20:55:15.502850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores_products)
[0m20:55:15.503896 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores_products
[0m20:55:15.516224 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.517750 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (compile): 20:55:15.504535 => 20:55:15.517239
[0m20:55:15.518952 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores_products
[0m20:55:15.586918 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.588443 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.589899 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: BEGIN
[0m20:55:15.590969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:15.598021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:15.599407 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.600541 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_tmp"
    
    
  as (
    WITH products AS (
    SELECT * FROM "contosodb"."public"."dimproducts"
),

stores AS (
    SELECT * FROM "contosodb"."public"."dimstores"
),

stores_products AS (
    SELECT storekey, productkey FROM "contosodb"."public"."fctsales"
    GROUP BY storekey, productkey 
),

final AS (
    SELECT 
    st.storename,
    p.productname
    FROM stores_products s
    JOIN products p
    ON s.productkey = p.productkey
    JOIN stores st
    ON s.storekey = st.storekey
)

SELECT * FROM final
  );
[0m20:55:15.610171 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:55:15.621731 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.622739 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_tmp" rename to "int_contoso__stores_products"
[0m20:55:15.625539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:55:15.647448 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: COMMIT
[0m20:55:15.648500 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.649453 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: COMMIT
[0m20:55:15.651631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:55:15.663346 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_backup"
[0m20:55:15.671878 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m20:55:15.673011 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_backup" cascade
[0m20:55:15.674387 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:55:15.676993 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (execute): 20:55:15.520278 => 20:55:15.676537
[0m20:55:15.678015 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: Close
[0m20:55:15.679816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd2fb7d-3bb4-4ae8-a5c5-7a50c727399a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef425c0>]}
[0m20:55:15.681223 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_contoso__stores_products ....... [[32mCREATE VIEW[0m in 0.18s]
[0m20:55:15.682642 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores_products
[0m20:55:15.685026 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:15.686023 [debug] [MainThread]: On master: BEGIN
[0m20:55:15.687478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:15.699571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:15.700634 [debug] [MainThread]: On master: COMMIT
[0m20:55:15.702232 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:15.703449 [debug] [MainThread]: On master: COMMIT
[0m20:55:15.704907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:15.705854 [debug] [MainThread]: On master: Close
[0m20:55:15.708833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:15.710729 [debug] [MainThread]: Connection 'model.postgres_dbt.int_contoso__stores_products' was properly closed.
[0m20:55:15.711821 [info ] [MainThread]: 
[0m20:55:15.713223 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m20:55:15.715686 [debug] [MainThread]: Command end result
[0m20:55:15.731770 [info ] [MainThread]: 
[0m20:55:15.734742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:15.736459 [info ] [MainThread]: 
[0m20:55:15.738043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:55:15.741038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3252095, "process_user_time": 3.744953, "process_kernel_time": 0.290104, "process_mem_max_rss": "110542848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:55:15.742379 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:15.741941 after 1.33 seconds
[0m20:55:15.744242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be69660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9073a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef41cf0>]}
[0m20:55:15.746326 [debug] [MainThread]: Flushing usage events
[0m21:18:58.539907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0d6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0d65c0>]}


============================== 21:18:58.558872 | ded0d69f-724a-4209-bda2-0628d937e9cf ==============================
[0m21:18:58.558872 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:18:58.560667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m int_contoso__stores_products.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:59.241973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ded0d69f-724a-4209-bda2-0628d937e9cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0d6830>]}
[0m21:18:59.362867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ded0d69f-724a-4209-bda2-0628d937e9cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d04a470>]}
[0m21:18:59.367603 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:18:59.398010 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:18:59.538734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:18:59.540192 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/schema.yml
[0m21:18:59.541090 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/intermediate/int_contoso__stores_products.sql
[0m21:18:59.885510 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.postgres_dbt.int_contoso__stores_products' (models/intermediate/int_contoso__stores_products.sql) depends on a source named 'contosodb.products' which was not found
[0m21:18:59.890349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4578369, "process_user_time": 4.089132, "process_kernel_time": 0.689728, "process_mem_max_rss": "105312256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:18:59.892275 [debug] [MainThread]: Command `dbt run` failed at 21:18:59.891697 after 1.46 seconds
[0m21:18:59.893544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca01f0>]}
[0m21:18:59.894664 [debug] [MainThread]: Flushing usage events
[0m21:19:49.079599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b6530>]}


============================== 21:19:49.084910 | d627f0c7-64c5-44a1-89cf-fcc549877829 ==============================
[0m21:19:49.084910 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:19:49.086107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m int_contoso__stores_products.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:19:49.350734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b67a0>]}
[0m21:19:49.471533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11022b3d0>]}
[0m21:19:49.473011 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:19:49.501338 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:19:49.566844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:49.567784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:49.569334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:19:49.578970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e840d0>]}
[0m21:19:49.600364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e51cc0>]}
[0m21:19:49.601430 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:19:49.602486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e51c30>]}
[0m21:19:49.606084 [info ] [MainThread]: 
[0m21:19:49.608368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:49.610472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m21:19:49.626163 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m21:19:49.627238 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m21:19:49.629562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:49.694543 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:19:49.696900 [debug] [ThreadPool]: On list_contosodb: Close
[0m21:19:49.699936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m21:19:49.708252 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:19:49.709155 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:19:49.709965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:49.717794 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:19:49.718927 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:19:49.719939 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:19:49.726315 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:19:49.728529 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:19:49.729557 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:19:49.739619 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.740522 [debug] [MainThread]: On master: BEGIN
[0m21:19:49.741330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:49.747536 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:49.748435 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.749336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:49.789902 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:19:49.792823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec7a60>]}
[0m21:19:49.793788 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:49.794751 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.795591 [debug] [MainThread]: On master: BEGIN
[0m21:19:49.796644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:49.797491 [debug] [MainThread]: On master: COMMIT
[0m21:19:49.798375 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.799216 [debug] [MainThread]: On master: COMMIT
[0m21:19:49.800168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:19:49.801042 [debug] [MainThread]: On master: Close
[0m21:19:49.802380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:49.803582 [info ] [MainThread]: 
[0m21:19:49.808752 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores_products
[0m21:19:49.810239 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_contoso__stores_products ............ [RUN]
[0m21:19:49.812202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores_products)
[0m21:19:49.813583 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores_products
[0m21:19:49.832072 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.833948 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (compile): 21:19:49.814410 => 21:19:49.833368
[0m21:19:49.834928 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores_products
[0m21:19:49.887318 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.889386 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.890420 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: BEGIN
[0m21:19:49.891347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:49.897875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:19:49.899090 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.900200 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */

  create view "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_tmp"
    
    
  as (
    WITH products AS (
    SELECT * FROM "contosodb"."public"."dimproducts"
),

stores AS (
    SELECT * FROM "contosodb"."public"."dimstores"
),

stores_products AS (
    SELECT storekey, productkey FROM "contosodb"."public"."fctsales"
    GROUP BY storekey, productkey 
),

final AS (
    SELECT 
    st.storename,
    p.productname
    FROM stores_products s
    JOIN products p
    ON s.productkey = p.productkey
    JOIN stores st
    ON s.storekey = st.storekey
)

SELECT * FROM final
  );
[0m21:19:49.910618 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:19:49.920467 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.921473 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores_products" rename to "int_contoso__stores_products__dbt_backup"
[0m21:19:49.923121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:49.928170 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.929130 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */
alter table "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_tmp" rename to "int_contoso__stores_products"
[0m21:19:49.930670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:19:49.954241 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: COMMIT
[0m21:19:49.955335 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.956251 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: COMMIT
[0m21:19:49.959249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:19:49.969779 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_backup"
[0m21:19:49.976862 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_contoso__stores_products"
[0m21:19:49.977895 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_contoso__stores_products"} */
drop view if exists "contosodb"."dbt_schema"."int_contoso__stores_products__dbt_backup" cascade
[0m21:19:49.985403 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:19:49.988468 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (execute): 21:19:49.835539 => 21:19:49.987952
[0m21:19:49.989646 [debug] [Thread-1 (]: On model.postgres_dbt.int_contoso__stores_products: Close
[0m21:19:49.991406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd627f0c7-64c5-44a1-89cf-fcc549877829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec56c0>]}
[0m21:19:49.992805 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_contoso__stores_products ....... [[32mCREATE VIEW[0m in 0.18s]
[0m21:19:49.994234 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores_products
[0m21:19:49.996330 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.997226 [debug] [MainThread]: On master: BEGIN
[0m21:19:49.998049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:50.007968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:19:50.011222 [debug] [MainThread]: On master: COMMIT
[0m21:19:50.012481 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:50.013471 [debug] [MainThread]: On master: COMMIT
[0m21:19:50.014506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:19:50.015371 [debug] [MainThread]: On master: Close
[0m21:19:50.016692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:50.017640 [debug] [MainThread]: Connection 'model.postgres_dbt.int_contoso__stores_products' was properly closed.
[0m21:19:50.018510 [info ] [MainThread]: 
[0m21:19:50.019517 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:19:50.020962 [debug] [MainThread]: Command end result
[0m21:19:50.035702 [info ] [MainThread]: 
[0m21:19:50.036741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:50.037682 [info ] [MainThread]: 
[0m21:19:50.038662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:19:50.041707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0350187, "process_user_time": 3.377636, "process_kernel_time": 0.275351, "process_mem_max_rss": "107905024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:19:50.043995 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:50.042972 after 1.04 seconds
[0m21:19:50.046337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f36080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f375b0>]}
[0m21:19:50.048257 [debug] [MainThread]: Flushing usage events
[0m21:26:41.126782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32500>]}


============================== 21:26:41.132613 | 0971adc4-742c-4a8d-8aee-67211672cd03 ==============================
[0m21:26:41.132613 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:26:41.133824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:26:41.407627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0971adc4-742c-4a8d-8aee-67211672cd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32770>]}
[0m21:26:41.531853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0971adc4-742c-4a8d-8aee-67211672cd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107089060>]}
[0m21:26:41.533314 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:26:41.559849 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:26:41.618034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:26:41.619185 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:26:41.756292 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.postgres_dbt.sales_small_amount_check' (tests/sales_small_amount_check.sql) depends on a node named 'stg_contoso_sales' in package '' which was not found
[0m21:26:41.767042 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:26:41.778620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0971adc4-742c-4a8d-8aee-67211672cd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a6fe0>]}
[0m21:26:41.795726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0971adc4-742c-4a8d-8aee-67211672cd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a35e0>]}
[0m21:26:41.797090 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:26:41.798441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0971adc4-742c-4a8d-8aee-67211672cd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a3850>]}
[0m21:26:41.801896 [info ] [MainThread]: 
[0m21:26:41.802958 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:26:41.804448 [debug] [MainThread]: Command end result
[0m21:26:41.817668 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7667711, "process_user_time": 3.371767, "process_kernel_time": 0.279456, "process_mem_max_rss": "105689088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:41.819583 [debug] [MainThread]: Command `dbt test` succeeded at 21:26:41.819222 after 0.77 seconds
[0m21:26:41.820908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104799b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106344a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ee470>]}
[0m21:26:41.822250 [debug] [MainThread]: Flushing usage events
[0m21:27:25.145895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf6500>]}


============================== 21:27:25.151439 | c0e4f957-53af-4c81-9610-dc7455eb814b ==============================
[0m21:27:25.151439 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:27:25.152699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:25.422575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e4f957-53af-4c81-9610-dc7455eb814b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf6770>]}
[0m21:27:25.549261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e4f957-53af-4c81-9610-dc7455eb814b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de5060>]}
[0m21:27:25.550830 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:27:25.575065 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:27:25.632454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:25.633699 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:27:25.777263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:27:25.786080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e4f957-53af-4c81-9610-dc7455eb814b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997b1c0>]}
[0m21:27:25.808913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e4f957-53af-4c81-9610-dc7455eb814b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988a260>]}
[0m21:27:25.810360 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:27:25.812058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e4f957-53af-4c81-9610-dc7455eb814b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988a1d0>]}
[0m21:27:25.816023 [info ] [MainThread]: 
[0m21:27:25.818099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:25.822396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:27:25.844376 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:27:25.845499 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:27:25.846381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:25.886371 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:27:25.887345 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:27:25.888202 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:27:25.894872 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:27:25.897589 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:27:25.898927 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:27:25.909787 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:25.910687 [debug] [MainThread]: On master: BEGIN
[0m21:27:25.911499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:25.917700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:25.918588 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:25.919495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:25.960609 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:27:25.963618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e4f957-53af-4c81-9610-dc7455eb814b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098891b0>]}
[0m21:27:25.964606 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:25.965612 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:25.966460 [debug] [MainThread]: On master: BEGIN
[0m21:27:25.967543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:25.968479 [debug] [MainThread]: On master: COMMIT
[0m21:27:25.969341 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:25.970166 [debug] [MainThread]: On master: COMMIT
[0m21:27:25.971181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:27:25.972027 [debug] [MainThread]: On master: Close
[0m21:27:25.973321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:25.974368 [info ] [MainThread]: 
[0m21:27:25.977132 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_small_amount_check
[0m21:27:25.978119 [info ] [Thread-1 (]: 1 of 1 START test sales_small_amount_check ..................................... [RUN]
[0m21:27:25.979620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_small_amount_check)
[0m21:27:25.980612 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_small_amount_check
[0m21:27:26.052888 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_small_amount_check"
[0m21:27:26.054792 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (compile): 21:27:25.981196 => 21:27:26.054237
[0m21:27:26.055855 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_small_amount_check
[0m21:27:26.079680 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_small_amount_check"
[0m21:27:26.081260 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:27:26.082295 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: BEGIN
[0m21:27:26.083257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:26.090027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:26.091005 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:27:26.091997 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_small_amount_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE salesamount < 5
      
    ) dbt_internal_test
[0m21:27:26.685523 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:27:26.688982 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (execute): 21:27:26.056610 => 21:27:26.688489
[0m21:27:26.689941 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: ROLLBACK
[0m21:27:26.691142 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: Close
[0m21:27:26.692653 [error] [Thread-1 (]: 1 of 1 FAIL 617 sales_small_amount_check ....................................... [[31mFAIL 617[0m in 0.71s]
[0m21:27:26.694098 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_small_amount_check
[0m21:27:26.696131 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.697010 [debug] [MainThread]: On master: BEGIN
[0m21:27:26.697837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:26.705722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:26.706708 [debug] [MainThread]: On master: COMMIT
[0m21:27:26.707727 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.708681 [debug] [MainThread]: On master: COMMIT
[0m21:27:26.709899 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:27:26.711407 [debug] [MainThread]: On master: Close
[0m21:27:26.713501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:26.715061 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_small_amount_check' was properly closed.
[0m21:27:26.716054 [info ] [MainThread]: 
[0m21:27:26.717537 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m21:27:26.720036 [debug] [MainThread]: Command end result
[0m21:27:26.732665 [info ] [MainThread]: 
[0m21:27:26.734201 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:27:26.736012 [info ] [MainThread]: 
[0m21:27:26.737461 [error] [MainThread]: [31mFailure in test sales_small_amount_check (tests/sales_small_amount_check.sql)[0m
[0m21:27:26.738769 [error] [MainThread]:   Got 617 results, configured to fail if != 0
[0m21:27:26.740409 [info ] [MainThread]: 
[0m21:27:26.742340 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_small_amount_check.sql
[0m21:27:26.743913 [info ] [MainThread]: 
[0m21:27:26.745340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:27:26.748061 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.6772801, "process_user_time": 3.566642, "process_kernel_time": 0.284864, "process_mem_max_rss": "109654016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:26.751191 [debug] [MainThread]: Command `dbt test` failed at 21:27:26.749383 after 1.68 seconds
[0m21:27:26.752933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924dd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099f90f0>]}
[0m21:27:26.754474 [debug] [MainThread]: Flushing usage events
[0m21:30:53.277491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5a560>]}


============================== 21:30:53.283100 | e38557a3-d511-4594-9dd1-91ce646a08a3 ==============================
[0m21:30:53.283100 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:30:53.284449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:30:53.551704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e38557a3-d511-4594-9dd1-91ce646a08a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5a7d0>]}
[0m21:30:53.672313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e38557a3-d511-4594-9dd1-91ce646a08a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111422b60>]}
[0m21:30:53.673797 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:30:53.696820 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:30:53.755792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:53.757085 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:30:53.896233 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:30:53.904294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e38557a3-d511-4594-9dd1-91ce646a08a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116df250>]}
[0m21:30:53.922550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e38557a3-d511-4594-9dd1-91ce646a08a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ee2c0>]}
[0m21:30:53.923859 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:30:53.925451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e38557a3-d511-4594-9dd1-91ce646a08a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ee230>]}
[0m21:30:53.928588 [info ] [MainThread]: 
[0m21:30:53.930236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:53.932952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:30:53.950158 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:30:53.951151 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:30:53.951982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:53.989558 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:53.990525 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:30:53.991423 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:30:53.998566 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:30:54.001078 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:30:54.002160 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:30:54.013951 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:54.014841 [debug] [MainThread]: On master: BEGIN
[0m21:30:54.015648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:54.022119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:54.023008 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:54.023905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:54.064089 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:30:54.067041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e38557a3-d511-4594-9dd1-91ce646a08a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ed210>]}
[0m21:30:54.067999 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:54.068978 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:54.069797 [debug] [MainThread]: On master: BEGIN
[0m21:30:54.070859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:54.071696 [debug] [MainThread]: On master: COMMIT
[0m21:30:54.072580 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:54.073387 [debug] [MainThread]: On master: COMMIT
[0m21:30:54.074309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:54.075139 [debug] [MainThread]: On master: Close
[0m21:30:54.076430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:54.077515 [info ] [MainThread]: 
[0m21:30:54.080254 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_small_amount_check
[0m21:30:54.081266 [info ] [Thread-1 (]: 1 of 1 START test sales_small_amount_check ..................................... [RUN]
[0m21:30:54.082746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_small_amount_check)
[0m21:30:54.083825 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_small_amount_check
[0m21:30:54.150846 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_small_amount_check"
[0m21:30:54.152612 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (compile): 21:30:54.084487 => 21:30:54.152080
[0m21:30:54.153621 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_small_amount_check
[0m21:30:54.176118 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_small_amount_check"
[0m21:30:54.177488 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:30:54.178408 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: BEGIN
[0m21:30:54.179273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:54.185846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:54.186806 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:30:54.187710 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_small_amount_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey,
salesamount
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE salesamount < 0
      
    ) dbt_internal_test
[0m21:30:54.777348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:30:54.780377 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (execute): 21:30:54.154250 => 21:30:54.779917
[0m21:30:54.781297 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: ROLLBACK
[0m21:30:54.782437 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: Close
[0m21:30:54.783935 [info ] [Thread-1 (]: 1 of 1 PASS sales_small_amount_check ........................................... [[32mPASS[0m in 0.70s]
[0m21:30:54.785286 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_small_amount_check
[0m21:30:54.787291 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:54.788144 [debug] [MainThread]: On master: BEGIN
[0m21:30:54.788986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:54.796250 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:54.797236 [debug] [MainThread]: On master: COMMIT
[0m21:30:54.798126 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:54.798973 [debug] [MainThread]: On master: COMMIT
[0m21:30:54.812761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:54.816922 [debug] [MainThread]: On master: Close
[0m21:30:54.818664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:54.819992 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_small_amount_check' was properly closed.
[0m21:30:54.820878 [info ] [MainThread]: 
[0m21:30:54.821866 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m21:30:54.824079 [debug] [MainThread]: Command end result
[0m21:30:54.868762 [info ] [MainThread]: 
[0m21:30:54.870048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:54.871151 [info ] [MainThread]: 
[0m21:30:54.872391 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:30:54.875477 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6721349, "process_user_time": 3.517719, "process_kernel_time": 0.282467, "process_mem_max_rss": "109637632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:54.877089 [debug] [MainThread]: Command `dbt test` succeeded at 21:30:54.876746 after 1.67 seconds
[0m21:30:54.879416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111604cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111458940>]}
[0m21:30:54.885388 [debug] [MainThread]: Flushing usage events
[0m21:33:46.887877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976a4a0>]}


============================== 21:33:46.893105 | 85fd7b96-e3b9-40b9-92fd-1a26958b7e2b ==============================
[0m21:33:46.893105 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:33:46.894282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:47.156040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85fd7b96-e3b9-40b9-92fd-1a26958b7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976a710>]}
[0m21:33:47.278296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85fd7b96-e3b9-40b9-92fd-1a26958b7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097318a0>]}
[0m21:33:47.280029 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:33:47.312987 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:33:47.367580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:47.368809 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:33:47.511710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:33:47.520575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85fd7b96-e3b9-40b9-92fd-1a26958b7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ef100>]}
[0m21:33:47.537064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85fd7b96-e3b9-40b9-92fd-1a26958b7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fe2f0>]}
[0m21:33:47.538174 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:33:47.539121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85fd7b96-e3b9-40b9-92fd-1a26958b7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fe230>]}
[0m21:33:47.541621 [info ] [MainThread]: 
[0m21:33:47.543529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:47.547163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:33:47.563003 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:33:47.563998 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:33:47.565093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:47.606454 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:33:47.607419 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:33:47.608286 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:33:47.615013 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:33:47.617559 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:33:47.619010 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:33:47.630512 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:47.631416 [debug] [MainThread]: On master: BEGIN
[0m21:33:47.632221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:47.638567 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:47.639458 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:47.640360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:47.681038 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:33:47.684214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85fd7b96-e3b9-40b9-92fd-1a26958b7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fd180>]}
[0m21:33:47.685204 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:47.686234 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:47.687078 [debug] [MainThread]: On master: BEGIN
[0m21:33:47.688146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:47.689011 [debug] [MainThread]: On master: COMMIT
[0m21:33:47.689847 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:47.690722 [debug] [MainThread]: On master: COMMIT
[0m21:33:47.691662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:47.692506 [debug] [MainThread]: On master: Close
[0m21:33:47.693844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:33:47.694884 [info ] [MainThread]: 
[0m21:33:47.697784 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_small_amount_check
[0m21:33:47.698780 [info ] [Thread-1 (]: 1 of 1 START test sales_small_amount_check ..................................... [RUN]
[0m21:33:47.700238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_small_amount_check)
[0m21:33:47.701297 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_small_amount_check
[0m21:33:47.766756 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_small_amount_check"
[0m21:33:47.768550 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (compile): 21:33:47.701936 => 21:33:47.768011
[0m21:33:47.769571 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_small_amount_check
[0m21:33:47.791883 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_small_amount_check"
[0m21:33:47.793239 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:33:47.794148 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: BEGIN
[0m21:33:47.795024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:47.801541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:33:47.802495 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:33:47.803404 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_small_amount_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- SELECT 
-- saleskey,
-- salesamount
-- FROM "contosodb"."dbt_schema"."stg_contoso__sales"
-- WHERE salesamount < 0

SELECT 
saleskey
from public.fctsales f 
where ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m21:33:48.442823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:33:48.445895 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (execute): 21:33:47.770198 => 21:33:48.445422
[0m21:33:48.446834 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: ROLLBACK
[0m21:33:48.447902 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: Close
[0m21:33:48.449438 [error] [Thread-1 (]: 1 of 1 FAIL 81 sales_small_amount_check ........................................ [[31mFAIL 81[0m in 0.75s]
[0m21:33:48.450886 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_small_amount_check
[0m21:33:48.452875 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:48.453723 [debug] [MainThread]: On master: BEGIN
[0m21:33:48.454521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:48.471385 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:33:48.472322 [debug] [MainThread]: On master: COMMIT
[0m21:33:48.473148 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:48.474227 [debug] [MainThread]: On master: COMMIT
[0m21:33:48.477035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:33:48.478326 [debug] [MainThread]: On master: Close
[0m21:33:48.479765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:48.481030 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_small_amount_check' was properly closed.
[0m21:33:48.481963 [info ] [MainThread]: 
[0m21:33:48.482921 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m21:33:48.484240 [debug] [MainThread]: Command end result
[0m21:33:48.495757 [info ] [MainThread]: 
[0m21:33:48.497217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:33:48.498990 [info ] [MainThread]: 
[0m21:33:48.500417 [error] [MainThread]: [31mFailure in test sales_small_amount_check (tests/sales_small_amount_check.sql)[0m
[0m21:33:48.501352 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m21:33:48.502247 [info ] [MainThread]: 
[0m21:33:48.503429 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_small_amount_check.sql
[0m21:33:48.504731 [info ] [MainThread]: 
[0m21:33:48.506139 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:33:48.508909 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.6950895, "process_user_time": 3.470815, "process_kernel_time": 0.277349, "process_mem_max_rss": "109150208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:48.510162 [debug] [MainThread]: Command `dbt test` failed at 21:33:48.509824 after 1.70 seconds
[0m21:33:48.511277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a165ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a471090>]}
[0m21:33:48.512894 [debug] [MainThread]: Flushing usage events
[0m21:34:07.611252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb49b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ea860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ea500>]}


============================== 21:34:07.616787 | ca33bec8-ad11-4239-85ef-bca0b6f7acbb ==============================
[0m21:34:07.616787 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:34:07.618017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:34:07.876963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca33bec8-ad11-4239-85ef-bca0b6f7acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ea770>]}
[0m21:34:07.996875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca33bec8-ad11-4239-85ef-bca0b6f7acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112441060>]}
[0m21:34:07.998348 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:34:08.021549 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:34:08.080932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:08.082201 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:34:08.223403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:34:08.230965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca33bec8-ad11-4239-85ef-bca0b6f7acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6f400>]}
[0m21:34:08.252328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca33bec8-ad11-4239-85ef-bca0b6f7acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7e260>]}
[0m21:34:08.253495 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:34:08.254531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca33bec8-ad11-4239-85ef-bca0b6f7acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7e1d0>]}
[0m21:34:08.257182 [info ] [MainThread]: 
[0m21:34:08.258677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:08.261309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:34:08.279280 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:34:08.280296 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:34:08.281486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:08.318629 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:34:08.319753 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:34:08.321373 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:34:08.327891 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:34:08.330428 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:34:08.331564 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:34:08.342214 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:08.343106 [debug] [MainThread]: On master: BEGIN
[0m21:34:08.343908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:08.349999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:08.350889 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:08.351852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:08.392007 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:34:08.394946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca33bec8-ad11-4239-85ef-bca0b6f7acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7d1b0>]}
[0m21:34:08.395916 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:08.396902 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:08.397733 [debug] [MainThread]: On master: BEGIN
[0m21:34:08.398784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:08.399636 [debug] [MainThread]: On master: COMMIT
[0m21:34:08.400635 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:08.401464 [debug] [MainThread]: On master: COMMIT
[0m21:34:08.402432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:08.403306 [debug] [MainThread]: On master: Close
[0m21:34:08.404980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:34:08.406248 [info ] [MainThread]: 
[0m21:34:08.409442 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_small_amount_check
[0m21:34:08.410454 [info ] [Thread-1 (]: 1 of 1 START test sales_small_amount_check ..................................... [RUN]
[0m21:34:08.411797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_small_amount_check)
[0m21:34:08.412731 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_small_amount_check
[0m21:34:08.481823 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_small_amount_check"
[0m21:34:08.483489 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (compile): 21:34:08.413334 => 21:34:08.482944
[0m21:34:08.484819 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_small_amount_check
[0m21:34:08.507247 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_small_amount_check"
[0m21:34:08.509026 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:34:08.510009 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: BEGIN
[0m21:34:08.510894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:08.517550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:08.518530 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:34:08.519521 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_small_amount_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- SELECT 
-- saleskey,
-- salesamount
-- FROM "contosodb"."dbt_schema"."stg_contoso__sales"
-- WHERE salesamount < 0

SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m21:34:09.200349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:34:09.203465 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (execute): 21:34:08.485649 => 21:34:09.202972
[0m21:34:09.204414 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: ROLLBACK
[0m21:34:09.205537 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: Close
[0m21:34:09.207003 [error] [Thread-1 (]: 1 of 1 FAIL 81 sales_small_amount_check ........................................ [[31mFAIL 81[0m in 0.80s]
[0m21:34:09.208442 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_small_amount_check
[0m21:34:09.210398 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:09.211258 [debug] [MainThread]: On master: BEGIN
[0m21:34:09.212065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:09.219653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:09.220905 [debug] [MainThread]: On master: COMMIT
[0m21:34:09.221998 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:09.223239 [debug] [MainThread]: On master: COMMIT
[0m21:34:09.224289 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:09.225157 [debug] [MainThread]: On master: Close
[0m21:34:09.226393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:09.227322 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_small_amount_check' was properly closed.
[0m21:34:09.228188 [info ] [MainThread]: 
[0m21:34:09.229138 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m21:34:09.230847 [debug] [MainThread]: Command end result
[0m21:34:09.241460 [info ] [MainThread]: 
[0m21:34:09.242660 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:34:09.243693 [info ] [MainThread]: 
[0m21:34:09.244924 [error] [MainThread]: [31mFailure in test sales_small_amount_check (tests/sales_small_amount_check.sql)[0m
[0m21:34:09.245886 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m21:34:09.247077 [info ] [MainThread]: 
[0m21:34:09.248306 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_small_amount_check.sql
[0m21:34:09.249441 [info ] [MainThread]: 
[0m21:34:09.250956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:34:09.254979 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7173527, "process_user_time": 3.543566, "process_kernel_time": 0.260973, "process_mem_max_rss": "109711360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:34:09.256695 [debug] [MainThread]: Command `dbt test` failed at 21:34:09.256120 after 1.72 seconds
[0m21:34:09.258312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb49b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c95450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ab1fc0>]}
[0m21:34:09.259971 [debug] [MainThread]: Flushing usage events
[0m21:34:19.967862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65e830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65e4d0>]}


============================== 21:34:19.973115 | bc52af90-cbe1-42dd-ba15-3a9e3303a9f6 ==============================
[0m21:34:19.973115 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:34:19.974291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m21:34:20.243900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc52af90-cbe1-42dd-ba15-3a9e3303a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65e740>]}
[0m21:34:20.365374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc52af90-cbe1-42dd-ba15-3a9e3303a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6221a0>]}
[0m21:34:20.366869 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:34:20.393882 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:34:20.450953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:20.452188 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:34:20.591095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:34:20.598846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc52af90-cbe1-42dd-ba15-3a9e3303a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e33d0>]}
[0m21:34:20.618570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc52af90-cbe1-42dd-ba15-3a9e3303a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ee290>]}
[0m21:34:20.620436 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:34:20.621864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc52af90-cbe1-42dd-ba15-3a9e3303a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ee200>]}
[0m21:34:20.625629 [info ] [MainThread]: 
[0m21:34:20.627157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:20.629827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:34:20.647551 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:34:20.648507 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:34:20.649331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:20.671595 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:34:20.672770 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:34:20.673718 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:34:20.680103 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:34:20.682566 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:34:20.683552 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:34:20.694203 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:20.695118 [debug] [MainThread]: On master: BEGIN
[0m21:34:20.695917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:20.702386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:20.703280 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:20.704185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:34:20.744130 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:34:20.747062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc52af90-cbe1-42dd-ba15-3a9e3303a9f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ed1e0>]}
[0m21:34:20.748022 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:20.748994 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:20.749824 [debug] [MainThread]: On master: BEGIN
[0m21:34:20.750903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:20.751759 [debug] [MainThread]: On master: COMMIT
[0m21:34:20.752605 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:20.753429 [debug] [MainThread]: On master: COMMIT
[0m21:34:20.754352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:20.755207 [debug] [MainThread]: On master: Close
[0m21:34:20.756523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:34:20.757607 [info ] [MainThread]: 
[0m21:34:20.760385 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_small_amount_check
[0m21:34:20.761384 [info ] [Thread-1 (]: 1 of 1 START test sales_small_amount_check ..................................... [RUN]
[0m21:34:20.762667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_small_amount_check)
[0m21:34:20.763730 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_small_amount_check
[0m21:34:20.828210 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_small_amount_check"
[0m21:34:20.829843 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (compile): 21:34:20.764459 => 21:34:20.829319
[0m21:34:20.830881 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_small_amount_check
[0m21:34:20.852969 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_small_amount_check"
[0m21:34:20.854297 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:34:20.855246 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: BEGIN
[0m21:34:20.856123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:20.862672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:34:20.863627 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_small_amount_check"
[0m21:34:20.864644 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_small_amount_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- SELECT 
-- saleskey,
-- salesamount
-- FROM "contosodb"."dbt_schema"."stg_contoso__sales"
-- WHERE salesamount < 0

SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.1
      
    ) dbt_internal_test
[0m21:34:21.537170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:34:21.540213 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_small_amount_check (execute): 21:34:20.831521 => 21:34:21.539747
[0m21:34:21.541139 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: ROLLBACK
[0m21:34:21.542255 [debug] [Thread-1 (]: On test.postgres_dbt.sales_small_amount_check: Close
[0m21:34:21.543704 [info ] [Thread-1 (]: 1 of 1 PASS sales_small_amount_check ........................................... [[32mPASS[0m in 0.78s]
[0m21:34:21.545152 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_small_amount_check
[0m21:34:21.547208 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:21.548072 [debug] [MainThread]: On master: BEGIN
[0m21:34:21.548885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:21.556392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:34:21.557614 [debug] [MainThread]: On master: COMMIT
[0m21:34:21.558824 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:21.560045 [debug] [MainThread]: On master: COMMIT
[0m21:34:21.561090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:34:21.561954 [debug] [MainThread]: On master: Close
[0m21:34:21.563231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:21.564126 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_small_amount_check' was properly closed.
[0m21:34:21.564974 [info ] [MainThread]: 
[0m21:34:21.565953 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m21:34:21.567297 [debug] [MainThread]: Command end result
[0m21:34:21.580285 [info ] [MainThread]: 
[0m21:34:21.581647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:21.582838 [info ] [MainThread]: 
[0m21:34:21.583960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:34:21.586788 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.691969, "process_user_time": 3.452811, "process_kernel_time": 0.259783, "process_mem_max_rss": "109355008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:34:21.588395 [debug] [MainThread]: Command `dbt test` succeeded at 21:34:21.587857 after 1.69 seconds
[0m21:34:21.589588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b208880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0266e0>]}
[0m21:34:21.590548 [debug] [MainThread]: Flushing usage events
[0m21:35:12.411522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9eb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef82830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef824d0>]}


============================== 21:35:12.416788 | c93d369f-3b7c-424f-a3d0-8c352f16e36a ==============================
[0m21:35:12.416788 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:35:12.417981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:12.681617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c93d369f-3b7c-424f-a3d0-8c352f16e36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef82740>]}
[0m21:35:12.802847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c93d369f-3b7c-424f-a3d0-8c352f16e36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef421a0>]}
[0m21:35:12.804350 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:35:12.827054 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:35:12.888847 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:35:12.890024 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://tests/sales_low_profit_check.sql
[0m21:35:12.890867 [debug] [MainThread]: Partial parsing: deleted file: postgres_dbt://tests/sales_small_amount_check.sql
[0m21:35:13.034442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:35:13.041953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c93d369f-3b7c-424f-a3d0-8c352f16e36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbf7160>]}
[0m21:35:13.057246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c93d369f-3b7c-424f-a3d0-8c352f16e36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb06290>]}
[0m21:35:13.058575 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:35:13.059901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c93d369f-3b7c-424f-a3d0-8c352f16e36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb06200>]}
[0m21:35:13.062425 [info ] [MainThread]: 
[0m21:35:13.063966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:13.067057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:35:13.083256 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:35:13.084211 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:35:13.085133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:13.117859 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:35:13.118892 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:35:13.120160 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:35:13.127692 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:35:13.130181 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:35:13.131334 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:35:13.142233 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:13.143117 [debug] [MainThread]: On master: BEGIN
[0m21:35:13.143918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:13.150039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:13.150922 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:13.151824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:13.191804 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:35:13.194707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c93d369f-3b7c-424f-a3d0-8c352f16e36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb051e0>]}
[0m21:35:13.195674 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:13.196668 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:13.197497 [debug] [MainThread]: On master: BEGIN
[0m21:35:13.198566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:13.199436 [debug] [MainThread]: On master: COMMIT
[0m21:35:13.200265 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:13.201089 [debug] [MainThread]: On master: COMMIT
[0m21:35:13.202011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:13.202845 [debug] [MainThread]: On master: Close
[0m21:35:13.204165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:13.205143 [info ] [MainThread]: 
[0m21:35:13.207892 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m21:35:13.208901 [info ] [Thread-1 (]: 1 of 1 START test sales_low_profit_check ....................................... [RUN]
[0m21:35:13.210364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_low_profit_check)
[0m21:35:13.211555 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m21:35:13.274489 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m21:35:13.276145 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 21:35:13.212415 => 21:35:13.275641
[0m21:35:13.277265 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m21:35:13.299235 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m21:35:13.300622 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m21:35:13.301524 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m21:35:13.302384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:13.308848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:35:13.309801 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m21:35:13.310687 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.1
      
    ) dbt_internal_test
[0m21:35:13.975046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:35:13.978073 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 21:35:13.277902 => 21:35:13.977612
[0m21:35:13.978994 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m21:35:13.980091 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m21:35:13.981597 [info ] [Thread-1 (]: 1 of 1 PASS sales_low_profit_check ............................................. [[32mPASS[0m in 0.77s]
[0m21:35:13.983004 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m21:35:13.985008 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:13.985871 [debug] [MainThread]: On master: BEGIN
[0m21:35:13.986677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:13.994166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:13.995289 [debug] [MainThread]: On master: COMMIT
[0m21:35:13.996618 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:13.997857 [debug] [MainThread]: On master: COMMIT
[0m21:35:13.998932 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:13.999805 [debug] [MainThread]: On master: Close
[0m21:35:14.001062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:14.001945 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_low_profit_check' was properly closed.
[0m21:35:14.002774 [info ] [MainThread]: 
[0m21:35:14.003821 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m21:35:14.005161 [debug] [MainThread]: Command end result
[0m21:35:14.019789 [info ] [MainThread]: 
[0m21:35:14.021021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:14.022094 [info ] [MainThread]: 
[0m21:35:14.023800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:35:14.026976 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.688771, "process_user_time": 3.444198, "process_kernel_time": 0.267548, "process_mem_max_rss": "109981696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:14.029549 [debug] [MainThread]: Command `dbt test` succeeded at 21:35:14.029167 after 1.69 seconds
[0m21:35:14.031220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9eb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb1ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9748e0>]}
[0m21:35:14.033299 [debug] [MainThread]: Flushing usage events
[0m21:35:26.987138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106119660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b2530>]}


============================== 21:35:26.993093 | 4f29eaa0-4095-4727-a485-7fb1c6fe61e1 ==============================
[0m21:35:26.993093 [info ] [MainThread]: Running with dbt=1.7.6
[0m21:35:26.994285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:35:27.260632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f29eaa0-4095-4727-a485-7fb1c6fe61e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b27a0>]}
[0m21:35:27.383470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f29eaa0-4095-4727-a485-7fb1c6fe61e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086273d0>]}
[0m21:35:27.384940 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m21:35:27.409737 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m21:35:27.469326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:27.470547 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_low_profit_check.sql
[0m21:35:27.609656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m21:35:27.617535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f29eaa0-4095-4727-a485-7fb1c6fe61e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109327220>]}
[0m21:35:27.635460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f29eaa0-4095-4727-a485-7fb1c6fe61e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923a290>]}
[0m21:35:27.636529 [info ] [MainThread]: Found 8 models, 1 seed, 1 test, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:35:27.637536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f29eaa0-4095-4727-a485-7fb1c6fe61e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923a200>]}
[0m21:35:27.640022 [info ] [MainThread]: 
[0m21:35:27.641903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:27.645785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m21:35:27.665658 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:35:27.667597 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m21:35:27.668883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:27.689294 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:35:27.690222 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m21:35:27.691153 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m21:35:27.699525 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:35:27.702301 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m21:35:27.703367 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m21:35:27.714491 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:27.715434 [debug] [MainThread]: On master: BEGIN
[0m21:35:27.716250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:27.722591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:27.723490 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:27.724395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:27.765302 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m21:35:27.768335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f29eaa0-4095-4727-a485-7fb1c6fe61e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092391e0>]}
[0m21:35:27.769321 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:27.770342 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:27.771181 [debug] [MainThread]: On master: BEGIN
[0m21:35:27.772282 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:27.773235 [debug] [MainThread]: On master: COMMIT
[0m21:35:27.774140 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:27.774956 [debug] [MainThread]: On master: COMMIT
[0m21:35:27.775930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:27.776784 [debug] [MainThread]: On master: Close
[0m21:35:27.778297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:27.779415 [info ] [MainThread]: 
[0m21:35:27.782315 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m21:35:27.783315 [info ] [Thread-1 (]: 1 of 1 START test sales_low_profit_check ....................................... [RUN]
[0m21:35:27.784768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.sales_low_profit_check)
[0m21:35:27.786221 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m21:35:27.854705 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m21:35:27.856341 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 21:35:27.786928 => 21:35:27.855813
[0m21:35:27.857475 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m21:35:27.879675 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m21:35:27.881028 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m21:35:27.881996 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m21:35:27.882876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:27.889528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:35:27.890517 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m21:35:27.891432 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m21:35:28.626152 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m21:35:28.629193 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 21:35:27.858168 => 21:35:28.628729
[0m21:35:28.630200 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m21:35:28.631292 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m21:35:28.632869 [error] [Thread-1 (]: 1 of 1 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.85s]
[0m21:35:28.634277 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m21:35:28.636243 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:28.637144 [debug] [MainThread]: On master: BEGIN
[0m21:35:28.638017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:28.646142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:35:28.647881 [debug] [MainThread]: On master: COMMIT
[0m21:35:28.649216 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:28.650433 [debug] [MainThread]: On master: COMMIT
[0m21:35:28.651448 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:35:28.652299 [debug] [MainThread]: On master: Close
[0m21:35:28.653649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:28.654522 [debug] [MainThread]: Connection 'test.postgres_dbt.sales_low_profit_check' was properly closed.
[0m21:35:28.655369 [info ] [MainThread]: 
[0m21:35:28.656387 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m21:35:28.657703 [debug] [MainThread]: Command end result
[0m21:35:28.670946 [info ] [MainThread]: 
[0m21:35:28.672099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:35:28.673036 [info ] [MainThread]: 
[0m21:35:28.673971 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m21:35:28.674872 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m21:35:28.675753 [info ] [MainThread]: 
[0m21:35:28.676986 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m21:35:28.678142 [info ] [MainThread]: 
[0m21:35:28.679141 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:35:28.681277 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7751461, "process_user_time": 3.579676, "process_kernel_time": 0.286553, "process_mem_max_rss": "109903872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:28.683001 [debug] [MainThread]: Command `dbt test` failed at 21:35:28.682633 after 1.78 seconds
[0m21:35:28.684758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106119660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924d4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5e980>]}
[0m21:35:28.686033 [debug] [MainThread]: Flushing usage events
[0m11:28:19.152977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa4e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa4e500>]}


============================== 11:28:19.160937 | ed6899d7-54cf-47ef-adfa-64ddf026855f ==============================
[0m11:28:19.160937 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:28:19.162147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:19.849700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed6899d7-54cf-47ef-adfa-64ddf026855f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa4e770>]}
[0m11:28:19.970412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed6899d7-54cf-47ef-adfa-64ddf026855f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ada5060>]}
[0m11:28:19.973849 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:28:20.022887 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:28:20.166392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:28:20.167824 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://tests/generic/string_not_empty.sql
[0m11:28:20.168972 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/test_config.yml
[0m11:28:20.395272 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/test_config.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Store', 'Online', 'Catalog'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m11:28:20.427382 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3824118, "process_user_time": 4.019633, "process_kernel_time": 0.816231, "process_mem_max_rss": "105103360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:28:20.429528 [debug] [MainThread]: Command `dbt test` failed at 11:28:20.428909 after 1.38 seconds
[0m11:28:20.431271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b687940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b76bbe0>]}
[0m11:28:20.432522 [debug] [MainThread]: Flushing usage events
[0m11:29:05.536048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8a500>]}


============================== 11:29:05.541323 | 0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c ==============================
[0m11:29:05.541323 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:29:05.542543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:05.798986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8a770>]}
[0m11:29:05.920969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfe1060>]}
[0m11:29:05.922395 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:29:05.942654 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:29:05.993668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:29:05.994970 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/test_config.yml
[0m11:29:05.995869 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://tests/generic/string_not_empty.sql
[0m11:29:06.295814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:29:06.304971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d89e260>]}
[0m11:29:06.321487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80bd60>]}
[0m11:29:06.322704 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:29:06.323801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80bcd0>]}
[0m11:29:06.327147 [info ] [MainThread]: 
[0m11:29:06.328904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:29:06.331592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:29:06.345811 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:29:06.346802 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:29:06.348094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:06.426282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:29:06.427263 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:29:06.428151 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:29:06.440266 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:29:06.442704 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:29:06.443776 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:29:06.454628 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:06.455682 [debug] [MainThread]: On master: BEGIN
[0m11:29:06.456498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:06.462836 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:06.463785 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:06.464706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:29:06.513514 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:29:06.516599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0963ebc9-4a45-42fa-b3dd-7e6dfdb9588c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80b970>]}
[0m11:29:06.517702 [debug] [MainThread]: On master: ROLLBACK
[0m11:29:06.518781 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:06.519642 [debug] [MainThread]: On master: BEGIN
[0m11:29:06.520722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:06.521588 [debug] [MainThread]: On master: COMMIT
[0m11:29:06.522417 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:06.523235 [debug] [MainThread]: On master: COMMIT
[0m11:29:06.524168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:29:06.525019 [debug] [MainThread]: On master: Close
[0m11:29:06.526319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:06.527341 [info ] [MainThread]: 
[0m11:29:06.531424 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:06.532657 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog  [RUN]
[0m11:29:06.534424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3)
[0m11:29:06.535503 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:06.548915 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:06.550738 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3 (compile): 11:29:06.536318 => 11:29:06.550216
[0m11:29:06.551681 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:06.573549 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:06.575105 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:06.576048 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: BEGIN
[0m11:29:06.576967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:06.583722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:06.584764 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:06.585762 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog'
)



      
    ) dbt_internal_test
[0m11:29:06.592559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:06.596008 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3 (execute): 11:29:06.552263 => 11:29:06.595451
[0m11:29:06.597044 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: ROLLBACK
[0m11:29:06.598096 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: Close
[0m11:29:06.599677 [error] [Thread-1 (]: 1 of 6 FAIL 1 accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog  [[31mFAIL 1[0m in 0.07s]
[0m11:29:06.601375 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:06.602571 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:06.603508 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m11:29:06.604915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:29:06.605862 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:06.615093 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:06.616625 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:29:06.606448 => 11:29:06.616131
[0m11:29:06.617653 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:06.621414 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:06.622805 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:06.623725 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m11:29:06.624604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:06.631344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:06.632404 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:06.633328 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m11:29:06.638058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:06.640470 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:29:06.618284 => 11:29:06.639997
[0m11:29:06.641407 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m11:29:06.642452 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m11:29:06.644039 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.04s]
[0m11:29:06.645508 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:06.646525 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:29:06.647449 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m11:29:06.648835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m11:29:06.649891 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:29:06.654162 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:29:06.655659 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:29:06.650623 => 11:29:06.655203
[0m11:29:06.656560 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:29:06.660111 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m11:29:06.661423 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:29:06.662364 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m11:29:06.663253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:06.670278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:06.671262 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:29:06.672164 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m11:29:15.191531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 9.0 seconds
[0m11:29:15.194674 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:29:06.657147 => 11:29:15.194044
[0m11:29:15.195774 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m11:29:15.197103 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m11:29:15.198817 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 8.55s]
[0m11:29:15.200359 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:29:15.201492 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:15.203029 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m11:29:15.204529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:29:15.205579 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:15.213817 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:15.215357 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:29:15.207479 => 11:29:15.214892
[0m11:29:15.216268 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:15.223197 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:15.228092 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:15.229338 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m11:29:15.230236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:15.241730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:15.243515 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:15.244690 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m11:29:15.249297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:15.251900 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:29:15.216842 => 11:29:15.251321
[0m11:29:15.252972 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m11:29:15.254241 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m11:29:15.256957 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.05s]
[0m11:29:15.258743 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:15.259954 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:15.260982 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_prodcutname ........... [RUN]
[0m11:29:15.262455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64)
[0m11:29:15.263532 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:15.269145 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:29:15.271530 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64 (compile): 11:29:15.264256 => 11:29:15.270965
[0m11:29:15.272503 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:15.277173 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:29:15.279535 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:29:15.281121 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: BEGIN
[0m11:29:15.282107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:15.292444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:15.295830 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:29:15.297051 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT prodcutname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(prodcutname) = ''

      
    ) dbt_internal_test
[0m11:29:15.299368 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "prodcutname" does not exist
LINE 8:     SELECT prodcutname
                   ^
HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".

[0m11:29:15.300413 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: ROLLBACK
[0m11:29:15.301855 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64 (execute): 11:29:15.273178 => 11:29:15.301390
[0m11:29:15.303074 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: Close
[0m11:29:15.322629 [debug] [Thread-1 (]: Database Error in test string_not_empty_stg_contoso__products_prodcutname (models/test_config.yml)
  column "prodcutname" does not exist
  LINE 8:     SELECT prodcutname
                     ^
  HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".
  compiled Code at target/run/postgres_dbt/models/test_config.yml/string_not_empty_stg_contoso__products_prodcutname.sql
[0m11:29:15.324224 [error] [Thread-1 (]: 5 of 6 ERROR string_not_empty_stg_contoso__products_prodcutname ................ [[31mERROR[0m in 0.06s]
[0m11:29:15.325789 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:15.327495 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:29:15.328484 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m11:29:15.330144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:29:15.331133 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:29:15.341311 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:29:15.343303 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:29:15.331732 => 11:29:15.342394
[0m11:29:15.344532 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:29:15.349426 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:29:15.351238 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:29:15.352257 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m11:29:15.353400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:15.362940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:15.364014 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:29:15.364920 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m11:29:15.369920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:15.372588 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:29:15.345451 => 11:29:15.372085
[0m11:29:15.373547 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m11:29:15.374691 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m11:29:15.377404 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.05s]
[0m11:29:15.378888 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:29:15.380936 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:15.381800 [debug] [MainThread]: On master: BEGIN
[0m11:29:15.382603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:29:15.389620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:15.391180 [debug] [MainThread]: On master: COMMIT
[0m11:29:15.392193 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:15.393583 [debug] [MainThread]: On master: COMMIT
[0m11:29:15.395209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:29:15.396663 [debug] [MainThread]: On master: Close
[0m11:29:15.398548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:15.399481 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m11:29:15.400353 [info ] [MainThread]: 
[0m11:29:15.401275 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m11:29:15.403822 [debug] [MainThread]: Command end result
[0m11:29:15.416501 [info ] [MainThread]: 
[0m11:29:15.417535 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:29:15.418421 [info ] [MainThread]: 
[0m11:29:15.419475 [error] [MainThread]: [31mFailure in test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog (models/test_config.yml)[0m
[0m11:29:15.420400 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:29:15.421720 [info ] [MainThread]: 
[0m11:29:15.422656 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/models/test_config.yml/accepted_values_stg_contoso__c_37f90127a6ee6a441a03cae763d99325.sql
[0m11:29:15.423862 [info ] [MainThread]: 
[0m11:29:15.425392 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m11:29:15.426628 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m11:29:15.427791 [info ] [MainThread]: 
[0m11:29:15.428984 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m11:29:15.430785 [info ] [MainThread]: 
[0m11:29:15.432280 [error] [MainThread]:   Database Error in test string_not_empty_stg_contoso__products_prodcutname (models/test_config.yml)
  column "prodcutname" does not exist
  LINE 8:     SELECT prodcutname
                     ^
  HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".
  compiled Code at target/run/postgres_dbt/models/test_config.yml/string_not_empty_stg_contoso__products_prodcutname.sql
[0m11:29:15.433352 [info ] [MainThread]: 
[0m11:29:15.434693 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m11:29:15.437395 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.975712, "process_user_time": 3.904993, "process_kernel_time": 0.315557, "process_mem_max_rss": "112095232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:29:15.439137 [debug] [MainThread]: Command `dbt test` failed at 11:29:15.438779 after 9.98 seconds
[0m11:29:15.440209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da33070>]}
[0m11:29:15.441174 [debug] [MainThread]: Flushing usage events
[0m11:29:58.090310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd2800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd24a0>]}


============================== 11:29:58.095658 | 70a91d69-6360-4a8a-b764-39853d83a421 ==============================
[0m11:29:58.095658 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:29:58.097074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:58.357114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70a91d69-6360-4a8a-b764-39853d83a421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd2710>]}
[0m11:29:58.478170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70a91d69-6360-4a8a-b764-39853d83a421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c92470>]}
[0m11:29:58.479646 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:29:58.502183 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:29:58.562772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:29:58.564063 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_low_profit_check.sql
[0m11:29:58.699825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:29:58.707659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a91d69-6360-4a8a-b764-39853d83a421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e00d0>]}
[0m11:29:58.726738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a91d69-6360-4a8a-b764-39853d83a421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113870190>]}
[0m11:29:58.727828 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:29:58.728819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a91d69-6360-4a8a-b764-39853d83a421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138735e0>]}
[0m11:29:58.733502 [info ] [MainThread]: 
[0m11:29:58.735399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:29:58.738011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:29:58.754436 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:29:58.755371 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:29:58.756200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:58.791695 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:29:58.793271 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:29:58.794543 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:29:58.801332 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:29:58.804429 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:29:58.805541 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:29:58.864651 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:58.865690 [debug] [MainThread]: On master: BEGIN
[0m11:29:58.866603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:58.873195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:58.874091 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:58.875001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:29:58.914916 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:29:58.917884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70a91d69-6360-4a8a-b764-39853d83a421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11395cc10>]}
[0m11:29:58.918856 [debug] [MainThread]: On master: ROLLBACK
[0m11:29:58.919844 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:58.920679 [debug] [MainThread]: On master: BEGIN
[0m11:29:58.921745 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:58.922598 [debug] [MainThread]: On master: COMMIT
[0m11:29:58.923436 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:58.924250 [debug] [MainThread]: On master: COMMIT
[0m11:29:58.925170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:29:58.926020 [debug] [MainThread]: On master: Close
[0m11:29:58.927313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:58.928360 [info ] [MainThread]: 
[0m11:29:58.931204 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:58.932208 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog  [RUN]
[0m11:29:58.933777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3)
[0m11:29:58.934847 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:58.960832 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:58.962506 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3 (compile): 11:29:58.935494 => 11:29:58.962018
[0m11:29:58.963519 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:58.987708 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:58.989329 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:58.990517 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: BEGIN
[0m11:29:58.991516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:59.000016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:59.001448 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"
[0m11:29:59.002626 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog'
)



      
    ) dbt_internal_test
[0m11:29:59.006714 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:59.009803 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3 (execute): 11:29:58.964171 => 11:29:59.009308
[0m11:29:59.010811 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: ROLLBACK
[0m11:29:59.011989 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3: Close
[0m11:29:59.014210 [error] [Thread-1 (]: 1 of 6 FAIL 1 accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog  [[31mFAIL 1[0m in 0.08s]
[0m11:29:59.015550 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3
[0m11:29:59.016551 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:59.017494 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m11:29:59.018778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog.2ff34343c3, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:29:59.019750 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:59.029996 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:59.031844 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:29:59.020539 => 11:29:59.031030
[0m11:29:59.033233 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:59.039466 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:59.041198 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:59.044436 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m11:29:59.047626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:59.068177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:59.069809 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:29:59.071055 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m11:29:59.074588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:59.077608 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:29:59.034358 => 11:29:59.076995
[0m11:29:59.078645 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m11:29:59.081152 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m11:29:59.083343 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.06s]
[0m11:29:59.085021 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:29:59.086145 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:29:59.087309 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m11:29:59.088811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m11:29:59.089824 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:29:59.102775 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:29:59.108170 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:29:59.094793 => 11:29:59.105994
[0m11:29:59.110773 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:29:59.117274 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m11:29:59.120239 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:29:59.122154 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m11:29:59.124347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:59.138321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:59.139435 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:29:59.140545 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.1
      
    ) dbt_internal_test
[0m11:29:59.872442 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m11:29:59.874859 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:29:59.112343 => 11:29:59.874402
[0m11:29:59.875786 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m11:29:59.876867 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m11:29:59.878428 [info ] [Thread-1 (]: 3 of 6 PASS sales_low_profit_check ............................................. [[32mPASS[0m in 0.79s]
[0m11:29:59.879812 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:29:59.880867 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:59.881795 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m11:29:59.883096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:29:59.884012 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:59.890843 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:59.892635 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:29:59.884611 => 11:29:59.892130
[0m11:29:59.893625 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:59.897481 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:59.898970 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:59.901597 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m11:29:59.903733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:59.922448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:29:59.925008 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:29:59.926854 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m11:29:59.933042 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:29:59.942282 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:29:59.894229 => 11:29:59.941260
[0m11:29:59.944004 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m11:29:59.952782 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m11:29:59.956945 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.07s]
[0m11:29:59.959368 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:29:59.961170 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:59.962893 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_prodcutname ........... [RUN]
[0m11:29:59.966073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64)
[0m11:29:59.967820 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:59.985435 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:29:59.989078 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64 (compile): 11:29:59.968906 => 11:29:59.988222
[0m11:29:59.991730 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:29:59.999569 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:00.002896 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:00.004607 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: BEGIN
[0m11:30:00.006373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:00.016551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:00.018173 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:00.019800 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT prodcutname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(prodcutname) = ''

      
    ) dbt_internal_test
[0m11:30:00.022308 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "prodcutname" does not exist
LINE 8:     SELECT prodcutname
                   ^
HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".

[0m11:30:00.024282 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: ROLLBACK
[0m11:30:00.026871 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64 (execute): 11:29:59.992880 => 11:30:00.026042
[0m11:30:00.028670 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: Close
[0m11:30:00.034386 [debug] [Thread-1 (]: Database Error in test string_not_empty_stg_contoso__products_prodcutname (models/test_config.yml)
  column "prodcutname" does not exist
  LINE 8:     SELECT prodcutname
                     ^
  HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".
  compiled Code at target/run/postgres_dbt/models/test_config.yml/string_not_empty_stg_contoso__products_prodcutname.sql
[0m11:30:00.036335 [error] [Thread-1 (]: 5 of 6 ERROR string_not_empty_stg_contoso__products_prodcutname ................ [[31mERROR[0m in 0.07s]
[0m11:30:00.038800 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:30:00.040376 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:00.042183 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m11:30:00.044234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:30:00.045190 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:00.058782 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:00.060291 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:30:00.045780 => 11:30:00.059814
[0m11:30:00.061211 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:00.065139 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:00.066617 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:00.068560 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m11:30:00.070141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:00.077135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:00.078102 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:00.080056 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m11:30:00.085875 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:30:00.088636 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:30:00.061801 => 11:30:00.088127
[0m11:30:00.089601 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m11:30:00.090870 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m11:30:00.092992 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.05s]
[0m11:30:00.094472 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:00.096650 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:00.097922 [debug] [MainThread]: On master: BEGIN
[0m11:30:00.099300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:00.105785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:00.106707 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.107980 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:00.109641 [debug] [MainThread]: On master: COMMIT
[0m11:30:00.110819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:30:00.111718 [debug] [MainThread]: On master: Close
[0m11:30:00.113000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:00.114068 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m11:30:00.115822 [info ] [MainThread]: 
[0m11:30:00.116831 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m11:30:00.120704 [debug] [MainThread]: Command end result
[0m11:30:00.137523 [info ] [MainThread]: 
[0m11:30:00.140303 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:30:00.141539 [info ] [MainThread]: 
[0m11:30:00.142962 [error] [MainThread]: [31mFailure in test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog (models/test_config.yml)[0m
[0m11:30:00.145131 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:30:00.146481 [info ] [MainThread]: 
[0m11:30:00.147748 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/models/test_config.yml/accepted_values_stg_contoso__c_37f90127a6ee6a441a03cae763d99325.sql
[0m11:30:00.148947 [info ] [MainThread]: 
[0m11:30:00.150273 [error] [MainThread]:   Database Error in test string_not_empty_stg_contoso__products_prodcutname (models/test_config.yml)
  column "prodcutname" does not exist
  LINE 8:     SELECT prodcutname
                     ^
  HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".
  compiled Code at target/run/postgres_dbt/models/test_config.yml/string_not_empty_stg_contoso__products_prodcutname.sql
[0m11:30:00.154118 [info ] [MainThread]: 
[0m11:30:00.157827 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m11:30:00.161970 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.1454964, "process_user_time": 3.78901, "process_kernel_time": 0.291529, "process_mem_max_rss": "109932544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:00.163245 [debug] [MainThread]: Command `dbt test` failed at 11:30:00.162890 after 2.15 seconds
[0m11:30:00.164440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ade440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adf850>]}
[0m11:30:00.165488 [debug] [MainThread]: Flushing usage events
[0m11:30:49.268154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b066b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609e560>]}


============================== 11:30:49.273648 | 51c1211f-c959-45e1-9220-9cb273ea9202 ==============================
[0m11:30:49.273648 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:30:49.274844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:30:49.547636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c1211f-c959-45e1-9220-9cb273ea9202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609e7d0>]}
[0m11:30:49.704760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c1211f-c959-45e1-9220-9cb273ea9202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bab60>]}
[0m11:30:49.706247 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:30:49.727065 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:30:49.789638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:30:49.791067 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/test_config.yml
[0m11:30:49.792036 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_low_profit_check.sql
[0m11:30:50.328455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:30:50.336750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c1211f-c959-45e1-9220-9cb273ea9202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701cfa0>]}
[0m11:30:50.355449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c1211f-c959-45e1-9220-9cb273ea9202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f820>]}
[0m11:30:50.356512 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:30:50.357459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c1211f-c959-45e1-9220-9cb273ea9202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f760>]}
[0m11:30:50.360337 [info ] [MainThread]: 
[0m11:30:50.362187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:30:50.364788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:30:50.386605 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:30:50.387561 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:30:50.388372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:50.422576 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:30:50.423681 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:30:50.424594 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:30:50.431460 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:30:50.434141 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:30:50.435296 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:30:50.446000 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:50.446880 [debug] [MainThread]: On master: BEGIN
[0m11:30:50.447678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:50.453915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:50.454923 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:50.455818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:30:50.496487 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:30:50.499488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c1211f-c959-45e1-9220-9cb273ea9202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3dab0>]}
[0m11:30:50.500441 [debug] [MainThread]: On master: ROLLBACK
[0m11:30:50.501449 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:50.502274 [debug] [MainThread]: On master: BEGIN
[0m11:30:50.503483 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:50.504343 [debug] [MainThread]: On master: COMMIT
[0m11:30:50.505347 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:50.506173 [debug] [MainThread]: On master: COMMIT
[0m11:30:50.507108 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:30:50.507949 [debug] [MainThread]: On master: Close
[0m11:30:50.509245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:50.510290 [info ] [MainThread]: 
[0m11:30:50.512873 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:30:50.513998 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m11:30:50.515547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m11:30:50.516647 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:30:50.531786 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:30:50.533587 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 11:30:50.517307 => 11:30:50.532889
[0m11:30:50.534627 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:30:50.561948 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:30:50.563480 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:30:50.564406 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m11:30:50.565284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:50.573028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:50.574342 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:30:50.575424 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m11:30:50.579286 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:30:50.582454 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 11:30:50.535542 => 11:30:50.581959
[0m11:30:50.583422 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m11:30:50.584599 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m11:30:50.586141 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.07s]
[0m11:30:50.587617 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:30:50.588609 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:30:50.589623 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m11:30:50.590954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:30:50.591992 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:30:50.605204 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:30:50.607042 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:30:50.593004 => 11:30:50.606470
[0m11:30:50.608282 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:30:50.612100 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:30:50.613401 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:30:50.614302 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m11:30:50.615165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:50.623684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:50.625134 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:30:50.626069 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m11:30:50.628932 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:30:50.631449 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:30:50.609013 => 11:30:50.630983
[0m11:30:50.632563 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m11:30:50.633931 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m11:30:50.635424 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.04s]
[0m11:30:50.636825 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:30:50.637814 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:30:50.638718 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m11:30:50.640481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m11:30:50.641753 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:30:50.646502 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:30:50.648732 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:30:50.642367 => 11:30:50.647801
[0m11:30:50.649959 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:30:50.655392 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m11:30:50.657194 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:30:50.658399 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m11:30:50.659301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:50.668211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:50.669237 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:30:50.670304 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m11:30:51.432993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m11:30:51.435396 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:30:50.651433 => 11:30:51.434938
[0m11:30:51.436363 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m11:30:51.437500 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m11:30:51.438970 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.80s]
[0m11:30:51.440395 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:30:51.441412 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:30:51.442342 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m11:30:51.443785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:30:51.444962 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:30:51.450372 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:30:51.452223 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:30:51.445682 => 11:30:51.451339
[0m11:30:51.453314 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:30:51.459412 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:30:51.461183 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:30:51.462841 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m11:30:51.464401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:51.479895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:51.481896 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:30:51.482909 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m11:30:51.489380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:30:51.494117 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:30:51.453950 => 11:30:51.493225
[0m11:30:51.496134 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m11:30:51.499043 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m11:30:51.501978 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.06s]
[0m11:30:51.504339 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:30:51.506101 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:30:51.508331 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_prodcutname ........... [RUN]
[0m11:30:51.510966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64)
[0m11:30:51.512741 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:30:51.524963 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:51.528637 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64 (compile): 11:30:51.513994 => 11:30:51.527395
[0m11:30:51.530399 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:30:51.535682 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:51.538411 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:51.540320 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: BEGIN
[0m11:30:51.541299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:51.558756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:51.560499 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"
[0m11:30:51.562470 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT prodcutname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(prodcutname) = ''

      
    ) dbt_internal_test
[0m11:30:51.567027 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "prodcutname" does not exist
LINE 8:     SELECT prodcutname
                   ^
HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".

[0m11:30:51.568775 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: ROLLBACK
[0m11:30:51.574231 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64 (execute): 11:30:51.531521 => 11:30:51.573372
[0m11:30:51.575954 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64: Close
[0m11:30:51.581953 [debug] [Thread-1 (]: Database Error in test string_not_empty_stg_contoso__products_prodcutname (models/test_config.yml)
  column "prodcutname" does not exist
  LINE 8:     SELECT prodcutname
                     ^
  HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".
  compiled Code at target/run/postgres_dbt/models/test_config.yml/string_not_empty_stg_contoso__products_prodcutname.sql
[0m11:30:51.586853 [error] [Thread-1 (]: 5 of 6 ERROR string_not_empty_stg_contoso__products_prodcutname ................ [[31mERROR[0m in 0.07s]
[0m11:30:51.589194 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64
[0m11:30:51.590923 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:51.596449 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m11:30:51.599007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_prodcutname.0a5466bd64, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:30:51.601032 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:51.620047 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:51.623267 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:30:51.603204 => 11:30:51.622358
[0m11:30:51.625326 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:51.634215 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:51.636592 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:51.638297 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m11:30:51.639990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:51.649157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:51.651025 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:30:51.652710 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m11:30:51.659835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:30:51.663830 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:30:51.626577 => 11:30:51.663082
[0m11:30:51.665679 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m11:30:51.669391 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m11:30:51.672161 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.07s]
[0m11:30:51.674434 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:30:51.677459 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:51.679036 [debug] [MainThread]: On master: BEGIN
[0m11:30:51.680663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:51.689732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:51.691219 [debug] [MainThread]: On master: COMMIT
[0m11:30:51.692957 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:51.694684 [debug] [MainThread]: On master: COMMIT
[0m11:30:51.696488 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:30:51.698194 [debug] [MainThread]: On master: Close
[0m11:30:51.701783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:51.703381 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m11:30:51.704988 [info ] [MainThread]: 
[0m11:30:51.706886 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m11:30:51.710158 [debug] [MainThread]: Command end result
[0m11:30:51.726950 [info ] [MainThread]: 
[0m11:30:51.728111 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:30:51.729147 [info ] [MainThread]: 
[0m11:30:51.730237 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m11:30:51.731341 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m11:30:51.732690 [info ] [MainThread]: 
[0m11:30:51.735603 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m11:30:51.737382 [info ] [MainThread]: 
[0m11:30:51.739704 [error] [MainThread]:   Database Error in test string_not_empty_stg_contoso__products_prodcutname (models/test_config.yml)
  column "prodcutname" does not exist
  LINE 8:     SELECT prodcutname
                     ^
  HINT:  Perhaps you meant to reference the column "stg_contoso__products.productname".
  compiled Code at target/run/postgres_dbt/models/test_config.yml/string_not_empty_stg_contoso__products_prodcutname.sql
[0m11:30:51.740891 [info ] [MainThread]: 
[0m11:30:51.742100 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m11:30:51.744663 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.5500808, "process_user_time": 4.121349, "process_kernel_time": 0.29958, "process_mem_max_rss": "115572736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:51.746120 [debug] [MainThread]: Command `dbt test` failed at 11:30:51.745598 after 2.55 seconds
[0m11:30:51.747177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b066b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016290>]}
[0m11:30:51.748242 [debug] [MainThread]: Flushing usage events
[0m11:31:15.116072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6e830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6e4d0>]}


============================== 11:31:15.121563 | 06ea4b9d-ac13-403d-8bb1-fdd07736c696 ==============================
[0m11:31:15.121563 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:31:15.122781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:31:15.386394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ea4b9d-ac13-403d-8bb1-fdd07736c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6e740>]}
[0m11:31:15.506213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ea4b9d-ac13-403d-8bb1-fdd07736c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd361a0>]}
[0m11:31:15.507691 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:31:15.530192 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:31:15.596213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:15.597665 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/test_config.yml
[0m11:31:16.078366 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:31:16.086281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ea4b9d-ac13-403d-8bb1-fdd07736c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc09fc0>]}
[0m11:31:16.106969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ea4b9d-ac13-403d-8bb1-fdd07736c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d91b790>]}
[0m11:31:16.108496 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:31:16.109668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ea4b9d-ac13-403d-8bb1-fdd07736c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d91b6d0>]}
[0m11:31:16.112825 [info ] [MainThread]: 
[0m11:31:16.115080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:31:16.117493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:31:16.135533 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:31:16.136993 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:31:16.137857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:16.174725 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:31:16.176614 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:31:16.177982 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:31:16.185611 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:31:16.188007 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:31:16.189242 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:31:16.201271 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:16.202184 [debug] [MainThread]: On master: BEGIN
[0m11:31:16.203001 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:16.210288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:31:16.211206 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:16.212144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:31:16.253054 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:31:16.256026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ea4b9d-ac13-403d-8bb1-fdd07736c696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbdd9f0>]}
[0m11:31:16.256992 [debug] [MainThread]: On master: ROLLBACK
[0m11:31:16.257995 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:16.258886 [debug] [MainThread]: On master: BEGIN
[0m11:31:16.259969 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:31:16.260830 [debug] [MainThread]: On master: COMMIT
[0m11:31:16.261674 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:16.262496 [debug] [MainThread]: On master: COMMIT
[0m11:31:16.263431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:31:16.264277 [debug] [MainThread]: On master: Close
[0m11:31:16.265927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:16.266998 [info ] [MainThread]: 
[0m11:31:16.269557 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:16.270532 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m11:31:16.272210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m11:31:16.273276 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:16.295217 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:16.297220 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 11:31:16.273931 => 11:31:16.296586
[0m11:31:16.298559 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:16.321887 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:16.323380 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:16.325488 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m11:31:16.326615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:16.333563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:16.334631 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:16.335576 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m11:31:16.339903 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:16.342948 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 11:31:16.299172 => 11:31:16.342467
[0m11:31:16.344067 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m11:31:16.345168 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m11:31:16.347448 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.08s]
[0m11:31:16.349281 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:16.350398 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:16.351476 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m11:31:16.353182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:31:16.363396 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:16.378054 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:16.379589 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:31:16.364204 => 11:31:16.379101
[0m11:31:16.380796 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:16.386707 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:16.391025 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:16.392075 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m11:31:16.393391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:16.401088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:16.402697 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:16.404456 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m11:31:16.408472 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:16.411948 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:31:16.381554 => 11:31:16.410895
[0m11:31:16.413100 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m11:31:16.414301 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m11:31:16.415907 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.06s]
[0m11:31:16.417343 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:16.418331 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:31:16.419680 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m11:31:16.421427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m11:31:16.423132 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:31:16.429894 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:31:16.431429 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:31:16.423791 => 11:31:16.430922
[0m11:31:16.432341 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:31:16.435736 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m11:31:16.437181 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:31:16.438301 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m11:31:16.440566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:16.449423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:16.450463 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:31:16.451382 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m11:31:17.100992 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m11:31:17.103401 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:31:16.432919 => 11:31:17.102944
[0m11:31:17.104315 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m11:31:17.105388 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m11:31:17.106903 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.69s]
[0m11:31:17.108322 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:31:17.109306 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:17.110222 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m11:31:17.111509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:31:17.112427 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:17.118467 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:17.119932 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:31:17.113212 => 11:31:17.119464
[0m11:31:17.121033 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:17.125495 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:17.126859 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:17.127791 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m11:31:17.128673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:17.139341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:17.140348 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:17.141335 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m11:31:17.144454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:17.147301 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:31:17.121649 => 11:31:17.146774
[0m11:31:17.148876 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m11:31:17.150616 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m11:31:17.153869 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.04s]
[0m11:31:17.155534 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:17.157613 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:17.159591 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m11:31:17.161991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m11:31:17.163747 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:17.172936 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:17.175044 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 11:31:17.164840 => 11:31:17.174420
[0m11:31:17.176063 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:17.181681 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:17.183930 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:17.185680 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m11:31:17.187334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:17.198185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:17.199832 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:17.201025 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m11:31:17.205266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:17.209069 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 11:31:17.176693 => 11:31:17.208138
[0m11:31:17.210686 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m11:31:17.212048 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m11:31:17.213739 [info ] [Thread-1 (]: 5 of 6 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.05s]
[0m11:31:17.215310 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:17.216313 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:17.217248 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m11:31:17.219032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:31:17.220281 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:17.230798 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:17.232321 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:31:17.220967 => 11:31:17.231849
[0m11:31:17.233254 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:17.237256 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:17.238621 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:17.239526 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m11:31:17.240395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:17.249379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:17.250420 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:17.251337 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:17.255955 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:17.259382 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:31:17.233981 => 11:31:17.258862
[0m11:31:17.260356 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m11:31:17.261409 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m11:31:17.263352 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.04s]
[0m11:31:17.265028 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:17.267221 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:17.268097 [debug] [MainThread]: On master: BEGIN
[0m11:31:17.268920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:17.277305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:31:17.278246 [debug] [MainThread]: On master: COMMIT
[0m11:31:17.279187 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:17.280112 [debug] [MainThread]: On master: COMMIT
[0m11:31:17.281337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:31:17.282281 [debug] [MainThread]: On master: Close
[0m11:31:17.283571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:17.284461 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m11:31:17.285336 [info ] [MainThread]: 
[0m11:31:17.286462 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m11:31:17.288810 [debug] [MainThread]: Command end result
[0m11:31:17.303743 [info ] [MainThread]: 
[0m11:31:17.304797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:31:17.305999 [info ] [MainThread]: 
[0m11:31:17.307062 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m11:31:17.308019 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m11:31:17.308885 [info ] [MainThread]: 
[0m11:31:17.309762 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m11:31:17.311643 [info ] [MainThread]: 
[0m11:31:17.313385 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:31:17.316170 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.2740893, "process_user_time": 3.972153, "process_kernel_time": 0.298658, "process_mem_max_rss": "114094080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:17.317331 [debug] [MainThread]: Command `dbt test` failed at 11:31:17.317025 after 2.28 seconds
[0m11:31:17.318631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd025f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd03520>]}
[0m11:31:17.319692 [debug] [MainThread]: Flushing usage events
[0m11:31:36.039329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b65b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fe860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fe500>]}


============================== 11:31:36.046292 | 5d88ee04-c2f3-4321-9001-c37f06c7d9b6 ==============================
[0m11:31:36.046292 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:31:36.047835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:31:36.368553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d88ee04-c2f3-4321-9001-c37f06c7d9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fe770>]}
[0m11:31:36.487885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d88ee04-c2f3-4321-9001-c37f06c7d9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109455060>]}
[0m11:31:36.489555 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:31:36.512508 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:31:36.573269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:36.574555 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_low_profit_check.sql
[0m11:31:36.712417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:31:36.721023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d88ee04-c2f3-4321-9001-c37f06c7d9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e000d0>]}
[0m11:31:36.741914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d88ee04-c2f3-4321-9001-c37f06c7d9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9f7c0>]}
[0m11:31:36.742998 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:31:36.744063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d88ee04-c2f3-4321-9001-c37f06c7d9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9f700>]}
[0m11:31:36.749786 [info ] [MainThread]: 
[0m11:31:36.751599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:31:36.753925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:31:36.771262 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:31:36.772537 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:31:36.773765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:36.807458 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:31:36.808404 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:31:36.809256 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:31:36.815383 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:31:36.818683 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:31:36.819752 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:31:36.877682 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:36.878817 [debug] [MainThread]: On master: BEGIN
[0m11:31:36.879816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:36.886548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:31:36.887439 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:36.888339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:31:36.928310 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:31:36.931264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d88ee04-c2f3-4321-9001-c37f06c7d9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e16fb0>]}
[0m11:31:36.932212 [debug] [MainThread]: On master: ROLLBACK
[0m11:31:36.933190 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:36.934021 [debug] [MainThread]: On master: BEGIN
[0m11:31:36.935089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:31:36.935942 [debug] [MainThread]: On master: COMMIT
[0m11:31:36.936772 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:36.937583 [debug] [MainThread]: On master: COMMIT
[0m11:31:36.938511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:31:36.939345 [debug] [MainThread]: On master: Close
[0m11:31:36.940645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:36.941668 [info ] [MainThread]: 
[0m11:31:36.944422 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:36.945417 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m11:31:36.946872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m11:31:36.947938 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:36.973375 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:36.974893 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 11:31:36.948578 => 11:31:36.974415
[0m11:31:36.975820 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:36.998843 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:37.000288 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:37.001212 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m11:31:37.002096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.008491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.009461 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:31:37.010415 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m11:31:37.014551 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:37.017532 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 11:31:36.976730 => 11:31:37.017058
[0m11:31:37.018499 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m11:31:37.019549 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m11:31:37.021019 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.07s]
[0m11:31:37.022448 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:31:37.023453 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:37.024376 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m11:31:37.025686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:31:37.026608 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:37.037860 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:37.039371 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:31:37.027194 => 11:31:37.038898
[0m11:31:37.040294 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:37.043753 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:37.045196 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:37.046131 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m11:31:37.047000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.056241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.057882 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:31:37.059370 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m11:31:37.063533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:37.067068 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:31:37.040885 => 11:31:37.066258
[0m11:31:37.068101 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m11:31:37.074027 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m11:31:37.076899 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.05s]
[0m11:31:37.078514 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:31:37.079507 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:31:37.080416 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m11:31:37.081714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m11:31:37.083118 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:31:37.089526 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:31:37.091841 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:31:37.083878 => 11:31:37.091276
[0m11:31:37.092768 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:31:37.096188 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m11:31:37.097750 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:31:37.099015 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m11:31:37.100369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.106713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.107704 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:31:37.108739 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.1
      
    ) dbt_internal_test
[0m11:31:37.777649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m11:31:37.780053 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:31:37.093351 => 11:31:37.779598
[0m11:31:37.780969 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m11:31:37.782066 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m11:31:37.783498 [info ] [Thread-1 (]: 3 of 6 PASS sales_low_profit_check ............................................. [[32mPASS[0m in 0.70s]
[0m11:31:37.784888 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:31:37.785892 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:37.786819 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m11:31:37.788115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:31:37.789030 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:37.800238 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:37.801901 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:31:37.789618 => 11:31:37.801413
[0m11:31:37.802879 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:37.806441 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:37.807971 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:37.809118 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m11:31:37.810147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.820334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.822043 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:31:37.823844 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m11:31:37.828203 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:37.832762 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:31:37.803464 => 11:31:37.831973
[0m11:31:37.834449 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m11:31:37.836275 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m11:31:37.838797 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.05s]
[0m11:31:37.841091 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:31:37.842885 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:37.844865 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m11:31:37.847731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m11:31:37.849534 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:37.859085 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:37.860719 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 11:31:37.854196 => 11:31:37.860240
[0m11:31:37.861759 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:37.867044 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:37.868695 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:37.869979 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m11:31:37.871112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.877730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.878767 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:31:37.879880 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m11:31:37.884668 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:37.888301 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 11:31:37.862432 => 11:31:37.887535
[0m11:31:37.889278 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m11:31:37.890368 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m11:31:37.891965 [info ] [Thread-1 (]: 5 of 6 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.05s]
[0m11:31:37.894018 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:31:37.895152 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:37.898319 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m11:31:37.899842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:31:37.900782 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:37.910042 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:37.911768 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:31:37.901359 => 11:31:37.911138
[0m11:31:37.913162 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:37.916807 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:37.918868 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:37.920980 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m11:31:37.922057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.928441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.929602 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:31:37.930549 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:37.936001 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:31:37.938971 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:31:37.913792 => 11:31:37.938484
[0m11:31:37.939917 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m11:31:37.940960 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m11:31:37.942424 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.04s]
[0m11:31:37.943921 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:31:37.946459 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:37.947471 [debug] [MainThread]: On master: BEGIN
[0m11:31:37.948727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:37.955912 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:31:37.956858 [debug] [MainThread]: On master: COMMIT
[0m11:31:37.957701 [debug] [MainThread]: Using postgres connection "master"
[0m11:31:37.958520 [debug] [MainThread]: On master: COMMIT
[0m11:31:37.959471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:31:37.960301 [debug] [MainThread]: On master: Close
[0m11:31:37.961984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:37.963292 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m11:31:37.964262 [info ] [MainThread]: 
[0m11:31:37.965221 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m11:31:37.967871 [debug] [MainThread]: Command end result
[0m11:31:37.981681 [info ] [MainThread]: 
[0m11:31:37.982717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:37.983612 [info ] [MainThread]: 
[0m11:31:37.985397 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:31:37.988577 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0543034, "process_user_time": 3.800039, "process_kernel_time": 0.292664, "process_mem_max_rss": "109854720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:37.989808 [debug] [MainThread]: Command `dbt test` succeeded at 11:31:37.989480 after 2.06 seconds
[0m11:31:37.990870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b65b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea0d00>]}
[0m11:31:37.991862 [debug] [MainThread]: Flushing usage events
[0m11:32:05.502698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a56830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a564d0>]}


============================== 11:32:05.508014 | b7becdeb-eb84-4010-aedf-480f91dab625 ==============================
[0m11:32:05.508014 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:32:05.509209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:05.767221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7becdeb-eb84-4010-aedf-480f91dab625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a56740>]}
[0m11:32:05.887594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7becdeb-eb84-4010-aedf-480f91dab625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a1a1a0>]}
[0m11:32:05.889078 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:32:05.915874 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:32:05.974677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:05.975951 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://tests/sales_low_profit_check.sql
[0m11:32:06.112756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:32:06.120692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7becdeb-eb84-4010-aedf-480f91dab625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11571c0d0>]}
[0m11:32:06.139575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7becdeb-eb84-4010-aedf-480f91dab625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115603790>]}
[0m11:32:06.140749 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:32:06.141702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7becdeb-eb84-4010-aedf-480f91dab625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156036d0>]}
[0m11:32:06.145248 [info ] [MainThread]: 
[0m11:32:06.147782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:32:06.151487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:32:06.175453 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:32:06.176510 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:32:06.177350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:06.220439 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:32:06.221439 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:32:06.222862 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:32:06.229626 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:32:06.232274 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:32:06.233357 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:32:06.293721 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:06.294670 [debug] [MainThread]: On master: BEGIN
[0m11:32:06.295512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:06.301977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:06.302874 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:06.303785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:32:06.343672 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:32:06.346641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7becdeb-eb84-4010-aedf-480f91dab625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115752f80>]}
[0m11:32:06.347602 [debug] [MainThread]: On master: ROLLBACK
[0m11:32:06.348585 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:06.349419 [debug] [MainThread]: On master: BEGIN
[0m11:32:06.350441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:06.351269 [debug] [MainThread]: On master: COMMIT
[0m11:32:06.352097 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:06.352911 [debug] [MainThread]: On master: COMMIT
[0m11:32:06.353856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:06.354704 [debug] [MainThread]: On master: Close
[0m11:32:06.356018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:32:06.357061 [info ] [MainThread]: 
[0m11:32:06.359783 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:32:06.360773 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m11:32:06.362256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m11:32:06.363328 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:32:06.389829 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:32:06.391374 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 11:32:06.363985 => 11:32:06.390893
[0m11:32:06.392880 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:32:06.417821 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:32:06.419547 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:32:06.420824 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m11:32:06.421747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:06.428223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:06.429217 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:32:06.430277 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m11:32:06.434016 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:06.437095 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 11:32:06.394004 => 11:32:06.436612
[0m11:32:06.438051 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m11:32:06.439099 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m11:32:06.440633 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.08s]
[0m11:32:06.442001 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:32:06.443035 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:32:06.443987 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m11:32:06.445351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:32:06.446292 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:32:06.455704 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:32:06.457316 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:32:06.446885 => 11:32:06.456696
[0m11:32:06.458464 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:32:06.461950 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:32:06.463382 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:32:06.464461 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m11:32:06.465399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:06.473500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:06.474519 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:32:06.475427 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m11:32:06.478221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:06.481365 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:32:06.459082 => 11:32:06.480605
[0m11:32:06.482518 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m11:32:06.483590 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m11:32:06.485180 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.04s]
[0m11:32:06.486550 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:32:06.487860 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:32:06.488979 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m11:32:06.490358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m11:32:06.491544 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:32:06.498096 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:32:06.499899 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:32:06.492142 => 11:32:06.499367
[0m11:32:06.500884 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:32:06.504727 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m11:32:06.506131 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:32:06.507167 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m11:32:06.508072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:06.516796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:06.518841 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m11:32:06.520365 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m11:32:07.163246 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m11:32:07.165649 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:32:06.501518 => 11:32:07.165200
[0m11:32:07.166568 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m11:32:07.167680 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m11:32:07.169136 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.68s]
[0m11:32:07.170543 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:32:07.171537 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:32:07.172454 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m11:32:07.173751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:32:07.174895 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:32:07.183192 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:32:07.185265 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:32:07.175621 => 11:32:07.184507
[0m11:32:07.186269 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:32:07.189780 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:32:07.191286 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:32:07.192459 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m11:32:07.193434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:07.202752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:07.204512 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:32:07.206238 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m11:32:07.211018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:07.215512 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:32:07.186872 => 11:32:07.214347
[0m11:32:07.217290 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m11:32:07.219117 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m11:32:07.221601 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.05s]
[0m11:32:07.223767 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:32:07.225514 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:32:07.227259 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m11:32:07.229771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m11:32:07.230804 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:32:07.238645 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:32:07.240518 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 11:32:07.231446 => 11:32:07.239706
[0m11:32:07.242127 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:32:07.247431 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:32:07.249159 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:32:07.250618 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m11:32:07.251595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:07.258882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:07.259844 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:32:07.261166 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m11:32:07.266677 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:07.269017 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 11:32:07.242860 => 11:32:07.268564
[0m11:32:07.269944 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m11:32:07.270965 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m11:32:07.273305 [info ] [Thread-1 (]: 5 of 6 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.04s]
[0m11:32:07.274800 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:32:07.275792 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:32:07.276723 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m11:32:07.278648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:32:07.280270 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:32:07.289574 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:32:07.291040 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:32:07.281158 => 11:32:07.290571
[0m11:32:07.291963 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:32:07.296586 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:32:07.298182 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:32:07.299420 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m11:32:07.300329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:07.307748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:07.308724 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:32:07.309693 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m11:32:07.316025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:07.318436 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:32:07.292554 => 11:32:07.317970
[0m11:32:07.319377 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m11:32:07.320413 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m11:32:07.322501 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.04s]
[0m11:32:07.323836 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:32:07.325849 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:07.326734 [debug] [MainThread]: On master: BEGIN
[0m11:32:07.327818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:07.336039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:07.337057 [debug] [MainThread]: On master: COMMIT
[0m11:32:07.338000 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:07.338855 [debug] [MainThread]: On master: COMMIT
[0m11:32:07.339847 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:07.340700 [debug] [MainThread]: On master: Close
[0m11:32:07.341985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:07.342908 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m11:32:07.343918 [info ] [MainThread]: 
[0m11:32:07.345563 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m11:32:07.348674 [debug] [MainThread]: Command end result
[0m11:32:07.366152 [info ] [MainThread]: 
[0m11:32:07.367278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:07.368552 [info ] [MainThread]: 
[0m11:32:07.369735 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m11:32:07.370938 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m11:32:07.372721 [info ] [MainThread]: 
[0m11:32:07.374512 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m11:32:07.375593 [info ] [MainThread]: 
[0m11:32:07.376568 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:32:07.379650 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.950374, "process_user_time": 3.645815, "process_kernel_time": 0.268381, "process_mem_max_rss": "109592576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:07.381486 [debug] [MainThread]: Command `dbt test` failed at 11:32:07.381109 after 1.95 seconds
[0m11:32:07.382696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115813190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115810610>]}
[0m11:32:07.383811 [debug] [MainThread]: Flushing usage events
[0m11:48:58.705968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5eb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb8e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb8e560>]}


============================== 11:48:58.711232 | 0778eb60-52af-4e78-94a2-44a9b535b7cc ==============================
[0m11:48:58.711232 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:48:58.712465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:58.991062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0778eb60-52af-4e78-94a2-44a9b535b7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb8e7d0>]}
[0m11:48:59.117208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0778eb60-52af-4e78-94a2-44a9b535b7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110556b60>]}
[0m11:48:59.118780 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m11:48:59.143616 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:48:59.210574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:48:59.211782 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/doc_blocks.md
[0m11:48:59.212960 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/schema.yml
[0m11:48:59.214127 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/test_config.yml
[0m11:48:59.777769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m11:48:59.787831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0778eb60-52af-4e78-94a2-44a9b535b7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110751ed0>]}
[0m11:48:59.794346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0778eb60-52af-4e78-94a2-44a9b535b7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107383d0>]}
[0m11:48:59.795991 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m11:48:59.797807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0778eb60-52af-4e78-94a2-44a9b535b7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073b760>]}
[0m11:48:59.801734 [info ] [MainThread]: 
[0m11:48:59.804010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:48:59.807344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m11:48:59.825052 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:48:59.826768 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m11:48:59.827899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:59.861804 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:48:59.863138 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m11:48:59.864262 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m11:48:59.872012 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:48:59.875525 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m11:48:59.877534 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m11:48:59.893529 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:59.894458 [debug] [MainThread]: On master: BEGIN
[0m11:48:59.895296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:59.902377 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:48:59.903688 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:59.904796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:59.961414 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m11:48:59.964429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0778eb60-52af-4e78-94a2-44a9b535b7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073b040>]}
[0m11:48:59.965397 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:59.966366 [debug] [MainThread]: On master: Close
[0m11:48:59.967712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:59.968772 [info ] [MainThread]: 
[0m11:48:59.971648 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores
[0m11:48:59.972918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_contoso__stores)
[0m11:48:59.973861 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores
[0m11:48:59.984979 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores"
[0m11:48:59.987165 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (compile): 11:48:59.974456 => 11:48:59.986203
[0m11:48:59.988982 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores
[0m11:48:59.990348 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores (execute): 11:48:59.989860 => 11:48:59.989887
[0m11:48:59.991956 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores
[0m11:48:59.992937 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_contoso__stores_products
[0m11:48:59.994102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores, now model.postgres_dbt.int_contoso__stores_products)
[0m11:48:59.995013 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_contoso__stores_products
[0m11:49:00.000208 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_contoso__stores_products"
[0m11:49:00.003770 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (compile): 11:48:59.995593 => 11:49:00.002914
[0m11:49:00.005356 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_contoso__stores_products
[0m11:49:00.008026 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_contoso__stores_products (execute): 11:49:00.006993 => 11:49:00.007013
[0m11:49:00.010266 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_contoso__stores_products
[0m11:49:00.011322 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m11:49:00.013011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.int_contoso__stores_products, now model.postgres_dbt.stg_contoso__channels)
[0m11:49:00.014013 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m11:49:00.016935 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m11:49:00.018316 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 11:49:00.014611 => 11:49:00.017868
[0m11:49:00.019377 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m11:49:00.020590 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 11:49:00.020062 => 11:49:00.020073
[0m11:49:00.022631 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m11:49:00.023861 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__products
[0m11:49:00.025247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__channels, now model.postgres_dbt.stg_contoso__products)
[0m11:49:00.026335 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__products
[0m11:49:00.029346 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__products"
[0m11:49:00.030823 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (compile): 11:49:00.027039 => 11:49:00.030340
[0m11:49:00.031739 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__products
[0m11:49:00.032769 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__products (execute): 11:49:00.032322 => 11:49:00.032332
[0m11:49:00.034293 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__products
[0m11:49:00.035243 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m11:49:00.036616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__products, now model.postgres_dbt.stg_contoso__sales)
[0m11:49:00.037545 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m11:49:00.041679 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m11:49:00.043378 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 11:49:00.038132 => 11:49:00.042855
[0m11:49:00.044300 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m11:49:00.045310 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 11:49:00.044881 => 11:49:00.044890
[0m11:49:00.046942 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m11:49:00.047917 [debug] [Thread-1 (]: Began running node seed.postgres_dbt.salestarget
[0m11:49:00.049116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.stg_contoso__sales, now seed.postgres_dbt.salestarget)
[0m11:49:00.050044 [debug] [Thread-1 (]: Began compiling node seed.postgres_dbt.salestarget
[0m11:49:00.052850 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (compile): 11:49:00.050630 => 11:49:00.052372
[0m11:49:00.053806 [debug] [Thread-1 (]: Began executing node seed.postgres_dbt.salestarget
[0m11:49:00.054958 [debug] [Thread-1 (]: Timing info for seed.postgres_dbt.salestarget (execute): 11:49:00.054500 => 11:49:00.054510
[0m11:49:00.056501 [debug] [Thread-1 (]: Finished running node seed.postgres_dbt.salestarget
[0m11:49:00.057478 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:49:00.058666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.postgres_dbt.salestarget, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m11:49:00.059578 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:49:00.065253 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m11:49:00.066963 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 11:49:00.060166 => 11:49:00.066473
[0m11:49:00.067889 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:49:00.068954 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 11:49:00.068503 => 11:49:00.068513
[0m11:49:00.070466 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m11:49:00.071427 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:49:00.072628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m11:49:00.073536 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:49:00.078794 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m11:49:00.080437 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 11:49:00.074116 => 11:49:00.079946
[0m11:49:00.081374 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:49:00.082410 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 11:49:00.081975 => 11:49:00.081985
[0m11:49:00.083935 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m11:49:00.084907 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:49:00.086126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m11:49:00.087029 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:49:00.098971 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m11:49:00.100400 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 11:49:00.087609 => 11:49:00.099935
[0m11:49:00.101319 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:49:00.102350 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 11:49:00.101914 => 11:49:00.101924
[0m11:49:00.103878 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m11:49:00.104847 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:49:00.106074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m11:49:00.107088 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:49:00.113270 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m11:49:00.114778 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 11:49:00.107677 => 11:49:00.114296
[0m11:49:00.115693 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:49:00.116702 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 11:49:00.116267 => 11:49:00.116277
[0m11:49:00.118310 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m11:49:00.119285 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:49:00.120527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m11:49:00.121432 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:49:00.129596 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m11:49:00.131002 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 11:49:00.122008 => 11:49:00.130540
[0m11:49:00.131908 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:49:00.132921 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 11:49:00.132484 => 11:49:00.132494
[0m11:49:00.134531 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m11:49:00.135530 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m11:49:00.136712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802, now model.postgres_dbt.sales)
[0m11:49:00.137618 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m11:49:00.144369 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m11:49:00.145817 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 11:49:00.138264 => 11:49:00.145341
[0m11:49:00.146735 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m11:49:00.147746 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 11:49:00.147318 => 11:49:00.147327
[0m11:49:00.149276 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m11:49:00.150248 [debug] [Thread-1 (]: Began running node model.postgres_dbt.store_sales
[0m11:49:00.151420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.sales, now model.postgres_dbt.store_sales)
[0m11:49:00.152331 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.store_sales
[0m11:49:00.156740 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.store_sales"
[0m11:49:00.158978 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (compile): 11:49:00.152913 => 11:49:00.158300
[0m11:49:00.160122 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.store_sales
[0m11:49:00.161147 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.store_sales (execute): 11:49:00.160705 => 11:49:00.160715
[0m11:49:00.162651 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.store_sales
[0m11:49:00.163612 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m11:49:00.164766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dbt.store_sales, now test.postgres_dbt.sales_low_profit_check)
[0m11:49:00.165682 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m11:49:00.169643 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m11:49:00.171989 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 11:49:00.166262 => 11:49:00.171318
[0m11:49:00.173143 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m11:49:00.174156 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 11:49:00.173729 => 11:49:00.173739
[0m11:49:00.175655 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m11:49:00.176625 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales_target_result
[0m11:49:00.177804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now model.postgres_dbt.sales_target_result)
[0m11:49:00.178715 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales_target_result
[0m11:49:00.182992 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales_target_result"
[0m11:49:00.184570 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (compile): 11:49:00.179295 => 11:49:00.184023
[0m11:49:00.185517 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales_target_result
[0m11:49:00.186520 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales_target_result (execute): 11:49:00.186094 => 11:49:00.186103
[0m11:49:00.188011 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales_target_result
[0m11:49:00.189615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:00.190448 [debug] [MainThread]: Connection 'model.postgres_dbt.sales_target_result' was properly closed.
[0m11:49:00.194140 [debug] [MainThread]: Command end result
[0m11:49:00.209170 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:49:00.210378 [info ] [MainThread]: Building catalog
[0m11:49:00.215609 [debug] [ThreadPool]: Acquiring new postgres connection 'contosodb.information_schema'
[0m11:49:00.233542 [debug] [ThreadPool]: Using postgres connection "contosodb.information_schema"
[0m11:49:00.234955 [debug] [ThreadPool]: On contosodb.information_schema: BEGIN
[0m11:49:00.236257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:00.245564 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:00.246501 [debug] [ThreadPool]: Using postgres connection "contosodb.information_schema"
[0m11:49:00.247489 [debug] [ThreadPool]: On contosodb.information_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "contosodb.information_schema"} */

    
    

    select
        'contosodb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fctsales')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('int_contoso__stores')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dimstores')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('store_sales')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('sales_target_result')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('stg_contoso__channels')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('int_contoso__stores_products')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('stg_contoso__sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dimproducts')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('stg_contoso__products')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('sales')) or (upper(sch.nspname) = upper('dbt_schema') and
           upper(tbl.relname) = upper('salestarget')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:49:00.258381 [debug] [ThreadPool]: SQL status: SELECT 68 in 0.0 seconds
[0m11:49:00.267803 [debug] [ThreadPool]: On contosodb.information_schema: ROLLBACK
[0m11:49:00.268960 [debug] [ThreadPool]: On contosodb.information_schema: Close
[0m11:49:00.288327 [info ] [MainThread]: Catalog written to /Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/target/catalog.json
[0m11:49:00.291054 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.6594468, "process_user_time": 4.101958, "process_kernel_time": 0.312665, "process_mem_max_rss": "114778112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:49:00.292376 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:49:00.292052 after 1.66 seconds
[0m11:49:00.293556 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:49:00.294686 [debug] [MainThread]: Connection 'contosodb.information_schema' was properly closed.
[0m11:49:00.295929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5eb430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110556b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a53070>]}
[0m11:49:00.297155 [debug] [MainThread]: Flushing usage events
[0m11:50:18.676305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a4d0>]}


============================== 11:50:18.681840 | b721d0ea-8b02-4c54-b57b-bf4fd1d54ed9 ==============================
[0m11:50:18.681840 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:50:18.683127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m11:50:18.953204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b721d0ea-8b02-4c54-b57b-bf4fd1d54ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a740>]}
[0m11:50:19.076260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b721d0ea-8b02-4c54-b57b-bf4fd1d54ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2a1a0>]}
[0m12:47:33.935913 [error] [MainThread]: Encountered an error:

[0m12:47:33.945053 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Users/mariocukovic/.pyenv/versions/3.10.0/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:47:33.949276 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 3435.1946, "process_user_time": 3.367682, "process_kernel_time": 0.464546, "process_mem_max_rss": "98955264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:47:33.953729 [debug] [MainThread]: Command `dbt docs serve` failed at 12:47:33.951033 after 3435.20 seconds
[0m12:47:33.956866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108055450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108057be0>]}
[0m12:47:33.958410 [debug] [MainThread]: Flushing usage events
[0m12:47:50.650050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f2590>]}


============================== 12:47:50.657440 | 0f37f24a-44ad-405e-850a-4c8a2674faaa ==============================
[0m12:47:50.657440 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:47:50.659646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m channel_profi.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:50.968220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f37f24a-44ad-405e-850a-4c8a2674faaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f2800>]}
[0m12:47:51.105221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f37f24a-44ad-405e-850a-4c8a2674faaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe2710>]}
[0m12:47:51.106812 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:47:51.131347 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:47:51.232402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:47:51.233589 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://macros/macro_common.sql
[0m12:47:51.245090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:47:51.258040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f37f24a-44ad-405e-850a-4c8a2674faaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2e9150>]}
[0m12:47:51.278183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f37f24a-44ad-405e-850a-4c8a2674faaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c297be0>]}
[0m12:47:51.279252 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:47:51.280171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f37f24a-44ad-405e-850a-4c8a2674faaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c297af0>]}
[0m12:47:51.282135 [warn ] [MainThread]: The selection criterion 'channel_profi.sql' does not match any nodes
[0m12:47:51.284390 [info ] [MainThread]: 
[0m12:47:51.285432 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:47:51.287685 [debug] [MainThread]: Command end result
[0m12:47:51.304805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.74574924, "process_user_time": 3.294291, "process_kernel_time": 0.290518, "process_mem_max_rss": "104169472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:47:51.306200 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:51.305846 after 0.75 seconds
[0m12:47:51.307210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c273eb0>]}
[0m12:47:51.308309 [debug] [MainThread]: Flushing usage events
[0m12:48:01.086727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afce890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afce530>]}


============================== 12:48:01.091977 | 681dd64f-3ed1-49a4-8337-6a7bde13c0a8 ==============================
[0m12:48:01.091977 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:48:01.093147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m channel_profit.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:48:01.356524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '681dd64f-3ed1-49a4-8337-6a7bde13c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afce7a0>]}
[0m12:48:01.477030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '681dd64f-3ed1-49a4-8337-6a7bde13c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af433d0>]}
[0m12:48:01.478503 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:48:01.506126 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:48:01.595213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:01.596143 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:01.597704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:48:01.607319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '681dd64f-3ed1-49a4-8337-6a7bde13c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc0fa0>]}
[0m12:48:01.625109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '681dd64f-3ed1-49a4-8337-6a7bde13c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb83cd0>]}
[0m12:48:01.626141 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:48:01.627149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681dd64f-3ed1-49a4-8337-6a7bde13c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb83c10>]}
[0m12:48:01.628796 [warn ] [MainThread]: The selection criterion 'channel_profit.sql' does not match any nodes
[0m12:48:01.630959 [info ] [MainThread]: 
[0m12:48:01.632759 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:48:01.634540 [debug] [MainThread]: Command end result
[0m12:48:01.649917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6370018, "process_user_time": 3.162332, "process_kernel_time": 0.245344, "process_mem_max_rss": "104120320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:48:01.651351 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:01.651023 after 0.64 seconds
[0m12:48:01.652328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af433d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb83880>]}
[0m12:48:01.653368 [debug] [MainThread]: Flushing usage events
[0m12:48:57.122447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a826b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801e590>]}


============================== 12:48:57.127816 | 899b803a-e126-4740-a2d0-e6839b76e754 ==============================
[0m12:48:57.127816 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:48:57.128999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m channel_profit.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:48:57.395547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '899b803a-e126-4740-a2d0-e6839b76e754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801e800>]}
[0m12:48:57.518638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '899b803a-e126-4740-a2d0-e6839b76e754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108512710>]}
[0m12:48:57.519993 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:48:57.549657 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:48:57.633046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:57.634027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:57.635742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:48:57.657508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '899b803a-e126-4740-a2d0-e6839b76e754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c15000>]}
[0m12:48:57.688072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '899b803a-e126-4740-a2d0-e6839b76e754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcfd30>]}
[0m12:48:57.689621 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:48:57.690940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '899b803a-e126-4740-a2d0-e6839b76e754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcfc70>]}
[0m12:48:57.692817 [warn ] [MainThread]: The selection criterion 'channel_profit.sql' does not match any nodes
[0m12:48:57.694802 [info ] [MainThread]: 
[0m12:48:57.696395 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:48:57.697756 [debug] [MainThread]: Command end result
[0m12:48:57.713838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6653013, "process_user_time": 3.179726, "process_kernel_time": 0.257629, "process_mem_max_rss": "104288256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:48:57.715157 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:57.714834 after 0.67 seconds
[0m12:48:57.716949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a826b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108512710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcf8e0>]}
[0m12:48:57.718661 [debug] [MainThread]: Flushing usage events
[0m12:50:33.932900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b843400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddda830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddda4d0>]}


============================== 12:50:33.938261 | 663e1d9a-64d2-4318-b889-90ef35b9bda6 ==============================
[0m12:50:33.938261 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:50:33.939441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m channel_profit.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:34.203564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663e1d9a-64d2-4318-b889-90ef35b9bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddda740>]}
[0m12:50:34.324986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663e1d9a-64d2-4318-b889-90ef35b9bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9a1a0>]}
[0m12:50:34.326590 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:50:34.349291 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:50:34.413414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:34.414734 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://macros/macro_common.sql
[0m12:50:34.424717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:50:34.433321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '663e1d9a-64d2-4318-b889-90ef35b9bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e9150>]}
[0m12:50:34.449363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '663e1d9a-64d2-4318-b889-90ef35b9bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98bc70>]}
[0m12:50:34.450418 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:50:34.451446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '663e1d9a-64d2-4318-b889-90ef35b9bda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98bbb0>]}
[0m12:50:34.453118 [warn ] [MainThread]: The selection criterion 'channel_profit.sql' does not match any nodes
[0m12:50:34.458637 [info ] [MainThread]: 
[0m12:50:34.459814 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:50:34.461046 [debug] [MainThread]: Command end result
[0m12:50:34.477045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6185778, "process_user_time": 3.140618, "process_kernel_time": 0.256587, "process_mem_max_rss": "103739392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:50:34.478355 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:34.478042 after 0.62 seconds
[0m12:50:34.479519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b843400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98b820>]}
[0m12:50:34.481148 [debug] [MainThread]: Flushing usage events
[0m12:50:59.951763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc9a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc9a530>]}


============================== 12:50:59.956967 | 9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4 ==============================
[0m12:50:59.956967 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:50:59.958240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m sales.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:00.224632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc9a7a0>]}
[0m12:51:00.346249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc0f3d0>]}
[0m12:51:00.347737 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:51:00.369962 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:51:00.436243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:00.437190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:00.438892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:51:00.448642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11088cfa0>]}
[0m12:51:00.466021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084fcd0>]}
[0m12:51:00.467080 [info ] [MainThread]: Found 8 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:51:00.468130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084fc10>]}
[0m12:51:00.470980 [info ] [MainThread]: 
[0m12:51:00.474684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:00.476681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m12:51:00.492287 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m12:51:00.493285 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m12:51:00.494159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:00.536074 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:51:00.539071 [debug] [ThreadPool]: On list_contosodb: Close
[0m12:51:00.542298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m12:51:00.550951 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m12:51:00.551848 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m12:51:00.552770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:00.559261 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:51:00.560158 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m12:51:00.561004 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m12:51:00.567000 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:51:00.569214 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m12:51:00.570196 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m12:51:00.580276 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:00.581176 [debug] [MainThread]: On master: BEGIN
[0m12:51:00.581988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:00.588115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:00.589016 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:00.589936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:00.629716 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m12:51:00.632638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cd510>]}
[0m12:51:00.633609 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:00.634594 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:00.635434 [debug] [MainThread]: On master: BEGIN
[0m12:51:00.636505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:00.637362 [debug] [MainThread]: On master: COMMIT
[0m12:51:00.638205 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:00.639036 [debug] [MainThread]: On master: COMMIT
[0m12:51:00.639973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:51:00.640823 [debug] [MainThread]: On master: Close
[0m12:51:00.642660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:00.643810 [info ] [MainThread]: 
[0m12:51:00.647317 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m12:51:00.648385 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.sales .................................. [RUN]
[0m12:51:00.649897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales)
[0m12:51:00.650939 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m12:51:00.665496 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m12:51:00.666978 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 12:51:00.651589 => 12:51:00.666508
[0m12:51:00.667889 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m12:51:00.725530 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales"
[0m12:51:00.727121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m12:51:00.728069 [debug] [Thread-1 (]: On model.postgres_dbt.sales: BEGIN
[0m12:51:00.728956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:00.735803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:51:00.736816 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m12:51:00.737875 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */

  
    

  create  table "contosodb"."dbt_schema"."sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
scp.productname,
st.storename,
scc.channelname,
s.unitcost,
s.unitprice,
s.salesquantity,
s.discountamount,
s.totalcost,
s.salesamount,
s.profit 
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
JOIN "contosodb"."dbt_schema"."stg_contoso__products" scp 
ON scp.productkey = s.productkey 
JOIN "contosodb"."dbt_schema"."stg_contoso__channels" scc 
ON s.channelkey = scc.channelkey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m12:51:24.482458 [debug] [Thread-1 (]: SQL status: SELECT 2897216 in 24.0 seconds
[0m12:51:24.494890 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m12:51:24.495885 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales" rename to "sales__dbt_backup"
[0m12:51:24.506954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:51:24.514033 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m12:51:24.515147 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
alter table "contosodb"."dbt_schema"."sales__dbt_tmp" rename to "sales"
[0m12:51:25.160497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.0 seconds
[0m12:51:25.190637 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m12:51:25.192333 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m12:51:25.194055 [debug] [Thread-1 (]: On model.postgres_dbt.sales: COMMIT
[0m12:51:25.196447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:51:25.209265 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."sales__dbt_backup"
[0m12:51:25.215611 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m12:51:25.217307 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */
drop table if exists "contosodb"."dbt_schema"."sales__dbt_backup" cascade
[0m12:51:25.277893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:51:25.281442 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 12:51:00.668474 => 12:51:25.280829
[0m12:51:25.282579 [debug] [Thread-1 (]: On model.postgres_dbt.sales: Close
[0m12:51:25.286874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9508c899-3d45-43e9-a9cb-b3d6ae8ed9c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11088c280>]}
[0m12:51:25.290310 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_schema.sales ............................. [[32mSELECT 2897216[0m in 24.64s]
[0m12:51:25.292808 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m12:51:25.297198 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:25.298195 [debug] [MainThread]: On master: BEGIN
[0m12:51:25.299160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:25.334458 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:25.337182 [debug] [MainThread]: On master: COMMIT
[0m12:51:25.340409 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:25.342116 [debug] [MainThread]: On master: COMMIT
[0m12:51:25.343690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:51:25.345403 [debug] [MainThread]: On master: Close
[0m12:51:25.348591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:25.350151 [debug] [MainThread]: Connection 'model.postgres_dbt.sales' was properly closed.
[0m12:51:25.351079 [info ] [MainThread]: 
[0m12:51:25.352665 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 24.88 seconds (24.88s).
[0m12:51:25.354217 [debug] [MainThread]: Command end result
[0m12:51:25.459765 [info ] [MainThread]: 
[0m12:51:25.461866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:25.463620 [info ] [MainThread]: 
[0m12:51:25.465068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:25.475858 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.59779, "process_user_time": 3.493028, "process_kernel_time": 0.27109, "process_mem_max_rss": "108470272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:51:25.487450 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:25.487028 after 25.61 seconds
[0m12:51:25.489250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11094c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11094d3c0>]}
[0m12:51:25.491122 [debug] [MainThread]: Flushing usage events
[0m12:51:33.219812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d761660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcfa8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcfa560>]}


============================== 12:51:33.225385 | aed57808-c7f4-46c1-88b4-75b1e0a7f45e ==============================
[0m12:51:33.225385 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:51:33.226643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m channel_profit.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:33.497875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcfa7d0>]}
[0m12:51:33.618412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c6b60>]}
[0m12:51:33.619900 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:51:33.640598 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:51:33.704988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:51:33.706435 [debug] [MainThread]: Partial parsing: added file: postgres_dbt://models/marts/channel_profit.sql
[0m12:51:33.893763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:51:33.901608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a51480>]}
[0m12:51:33.921704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110950b20>]}
[0m12:51:33.923804 [info ] [MainThread]: Found 9 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:51:33.924844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110950f70>]}
[0m12:51:33.927440 [info ] [MainThread]: 
[0m12:51:33.929005 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:33.987099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m12:51:34.002815 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m12:51:34.003863 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m12:51:34.004822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:34.023795 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:51:34.025892 [debug] [ThreadPool]: On list_contosodb: Close
[0m12:51:34.028699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m12:51:34.036665 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m12:51:34.037590 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m12:51:34.038404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:34.044596 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:51:34.045503 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m12:51:34.046346 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m12:51:34.052261 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:51:34.054322 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m12:51:34.055290 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m12:51:34.065862 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:34.066760 [debug] [MainThread]: On master: BEGIN
[0m12:51:34.067565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:34.073454 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:34.074347 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:34.075263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:34.115534 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m12:51:34.118569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f3280>]}
[0m12:51:34.119536 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:34.120512 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:34.121340 [debug] [MainThread]: On master: BEGIN
[0m12:51:34.122365 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:34.123189 [debug] [MainThread]: On master: COMMIT
[0m12:51:34.124018 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:34.124832 [debug] [MainThread]: On master: COMMIT
[0m12:51:34.125779 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:51:34.126627 [debug] [MainThread]: On master: Close
[0m12:51:34.127909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:34.128917 [info ] [MainThread]: 
[0m12:51:34.131369 [debug] [Thread-1 (]: Began running node model.postgres_dbt.channel_profit
[0m12:51:34.132419 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.channel_profit .......................... [RUN]
[0m12:51:34.133858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.channel_profit)
[0m12:51:34.134964 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.channel_profit
[0m12:51:34.147260 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.channel_profit"
[0m12:51:34.148734 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.channel_profit (compile): 12:51:34.135607 => 12:51:34.148280
[0m12:51:34.149639 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.channel_profit
[0m12:51:34.210073 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.channel_profit"
[0m12:51:34.211620 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:34.212729 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: BEGIN
[0m12:51:34.213621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:34.220372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:51:34.221376 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:34.222412 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.channel_profit"} */

  create view "contosodb"."dbt_schema"."channel_profit__dbt_tmp"
    
    
  as (
    
    SELECT
    channelkey,
    SUM(totalcost) AS totalcost,
    SUM(salesamount) AS totalsales,
    SUM(salesamount - scs.totalcost) AS profit
    FROM "contosodb"."dbt_schema"."stg_contoso__sales"
    WHERE channelkey = 2
    GROUP BY channelkey

  );
[0m12:51:34.225069 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "scs"
LINE 12:     SUM(salesamount - scs.totalcost) AS profit
                               ^

[0m12:51:34.226071 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: ROLLBACK
[0m12:51:34.227458 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.channel_profit (execute): 12:51:34.150214 => 12:51:34.226987
[0m12:51:34.228372 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: Close
[0m12:51:34.233491 [debug] [Thread-1 (]: Database Error in model channel_profit (models/marts/channel_profit.sql)
  missing FROM-clause entry for table "scs"
  LINE 12:     SUM(salesamount - scs.totalcost) AS profit
                                 ^
  compiled Code at target/run/postgres_dbt/models/marts/channel_profit.sql
[0m12:51:34.234704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aed57808-c7f4-46c1-88b4-75b1e0a7f45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc6dfc0>]}
[0m12:51:34.236036 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.channel_profit ................. [[31mERROR[0m in 0.10s]
[0m12:51:34.237370 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.channel_profit
[0m12:51:34.239442 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:34.240319 [debug] [MainThread]: On master: BEGIN
[0m12:51:34.241137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:34.247457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:34.248372 [debug] [MainThread]: On master: COMMIT
[0m12:51:34.249222 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:34.250101 [debug] [MainThread]: On master: COMMIT
[0m12:51:34.251105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:51:34.251981 [debug] [MainThread]: On master: Close
[0m12:51:34.253218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:34.254290 [debug] [MainThread]: Connection 'model.postgres_dbt.channel_profit' was properly closed.
[0m12:51:34.255222 [info ] [MainThread]: 
[0m12:51:34.256163 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m12:51:34.258372 [debug] [MainThread]: Command end result
[0m12:51:34.270140 [info ] [MainThread]: 
[0m12:51:34.271378 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:51:34.272357 [info ] [MainThread]: 
[0m12:51:34.273461 [error] [MainThread]:   Database Error in model channel_profit (models/marts/channel_profit.sql)
  missing FROM-clause entry for table "scs"
  LINE 12:     SUM(salesamount - scs.totalcost) AS profit
                                 ^
  compiled Code at target/run/postgres_dbt/models/marts/channel_profit.sql
[0m12:51:34.274641 [info ] [MainThread]: 
[0m12:51:34.275834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:51:34.278552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1378881, "process_user_time": 3.593699, "process_kernel_time": 0.288603, "process_mem_max_rss": "111349760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:51:34.280113 [debug] [MainThread]: Command `dbt run` failed at 12:51:34.279635 after 1.14 seconds
[0m12:51:34.281358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d761660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b8640>]}
[0m12:51:34.282511 [debug] [MainThread]: Flushing usage events
[0m12:51:48.140207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a768f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a76590>]}


============================== 12:51:48.145507 | 15feb5ee-14a7-4ef0-b7d7-42b540dc7813 ==============================
[0m12:51:48.145507 [info ] [MainThread]: Running with dbt=1.7.6
[0m12:51:48.146699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m channel_profit.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:51:48.414090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a76800>]}
[0m12:51:48.537081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6a710>]}
[0m12:51:48.538565 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m12:51:48.565672 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m12:51:48.628235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:51:48.629556 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://macros/macro_common.sql
[0m12:51:48.819231 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m12:51:48.827293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d9450>]}
[0m12:51:48.901960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766d480>]}
[0m12:51:48.903074 [info ] [MainThread]: Found 9 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m12:51:48.904139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766f550>]}
[0m12:51:48.906614 [info ] [MainThread]: 
[0m12:51:48.908063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:48.909882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m12:51:48.927519 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m12:51:48.928507 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m12:51:48.929391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:48.950015 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:51:48.952325 [debug] [ThreadPool]: On list_contosodb: Close
[0m12:51:48.955279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m12:51:48.963465 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m12:51:48.964369 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m12:51:48.965191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:48.971413 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:51:48.972325 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m12:51:48.973169 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m12:51:48.979186 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:51:48.981415 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m12:51:48.982391 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m12:51:48.992647 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:48.993537 [debug] [MainThread]: On master: BEGIN
[0m12:51:48.994344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:49.000323 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:49.001219 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.002141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:49.042213 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m12:51:49.045334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e304c0>]}
[0m12:51:49.046347 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:49.047426 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.048286 [debug] [MainThread]: On master: BEGIN
[0m12:51:49.049315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:49.050149 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.050985 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.051804 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.052771 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:51:49.053632 [debug] [MainThread]: On master: Close
[0m12:51:49.054939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:49.055961 [info ] [MainThread]: 
[0m12:51:49.058644 [debug] [Thread-1 (]: Began running node model.postgres_dbt.channel_profit
[0m12:51:49.059699 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.channel_profit .......................... [RUN]
[0m12:51:49.061198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.channel_profit)
[0m12:51:49.062257 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.channel_profit
[0m12:51:49.074347 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.channel_profit"
[0m12:51:49.076295 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.channel_profit (compile): 12:51:49.062920 => 12:51:49.075766
[0m12:51:49.077250 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.channel_profit
[0m12:51:49.126352 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.channel_profit"
[0m12:51:49.127793 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:49.128728 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: BEGIN
[0m12:51:49.129620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:49.135923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:51:49.136899 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:49.137819 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.channel_profit"} */

  create view "contosodb"."dbt_schema"."channel_profit__dbt_tmp"
    
    
  as (
    
    SELECT
    channelkey,
    SUM(totalcost) AS totalcost,
    SUM(salesamount) AS totalsales,
    SUM(salesamount - totalcost) AS profit
    FROM "contosodb"."dbt_schema"."stg_contoso__sales"
    WHERE channelkey = 2
    GROUP BY channelkey

  );
[0m12:51:49.147194 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:51:49.157097 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:49.158092 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.channel_profit"} */
alter table "contosodb"."dbt_schema"."channel_profit__dbt_tmp" rename to "channel_profit"
[0m12:51:49.161530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:51:49.183925 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: COMMIT
[0m12:51:49.184909 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:49.185837 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: COMMIT
[0m12:51:49.188071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:51:49.197488 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."channel_profit__dbt_backup"
[0m12:51:49.203581 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.channel_profit"
[0m12:51:49.204543 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.channel_profit"} */
drop view if exists "contosodb"."dbt_schema"."channel_profit__dbt_backup" cascade
[0m12:51:49.205735 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:51:49.208135 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.channel_profit (execute): 12:51:49.077827 => 12:51:49.207697
[0m12:51:49.209070 [debug] [Thread-1 (]: On model.postgres_dbt.channel_profit: Close
[0m12:51:49.210563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15feb5ee-14a7-4ef0-b7d7-42b540dc7813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777f8b0>]}
[0m12:51:49.211894 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.channel_profit ..................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:51:49.213190 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.channel_profit
[0m12:51:49.215189 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.216059 [debug] [MainThread]: On master: BEGIN
[0m12:51:49.216889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:49.226248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:51:49.228101 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.229935 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:49.231011 [debug] [MainThread]: On master: COMMIT
[0m12:51:49.232160 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:51:49.233085 [debug] [MainThread]: On master: Close
[0m12:51:49.234483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:49.235683 [debug] [MainThread]: Connection 'model.postgres_dbt.channel_profit' was properly closed.
[0m12:51:49.236672 [info ] [MainThread]: 
[0m12:51:49.237659 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m12:51:49.239147 [debug] [MainThread]: Command end result
[0m12:51:49.251135 [info ] [MainThread]: 
[0m12:51:49.252523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:49.253492 [info ] [MainThread]: 
[0m12:51:49.254594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:49.257027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1920992, "process_user_time": 3.658114, "process_kernel_time": 0.274108, "process_mem_max_rss": "110620672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:51:49.258721 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:49.258374 after 1.19 seconds
[0m12:51:49.260875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780d9c0>]}
[0m12:51:49.262078 [debug] [MainThread]: Flushing usage events
[0m17:29:54.466331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a227a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a22440>]}


============================== 17:29:54.476298 | 58cbd7e6-2051-4ec9-8a81-6494e17910e5 ==============================
[0m17:29:54.476298 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:29:54.477728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:54.956398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58cbd7e6-2051-4ec9-8a81-6494e17910e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a22bf0>]}
[0m17:29:54.966611 [debug] [MainThread]: Set downloads directory='/var/folders/1d/gd56k03j78b5qs_xy6hxwy5c0000gn/T/dbt-downloads-zpv6r9no'
[0m17:29:54.967861 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:29:55.250632 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:29:55.252795 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:29:55.337914 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:29:55.386185 [info ] [MainThread]: Updating lock file in file path: /Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/package-lock.yml
[0m17:29:55.393466 [debug] [MainThread]: Set downloads directory='/var/folders/1d/gd56k03j78b5qs_xy6hxwy5c0000gn/T/dbt-downloads-w6p4gir_'
[0m17:29:55.432025 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:29:56.204215 [info ] [MainThread]: Installed from version 1.1.1
[0m17:29:56.206111 [info ] [MainThread]: Up to date!
[0m17:29:56.208127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '58cbd7e6-2051-4ec9-8a81-6494e17910e5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139df6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113af37f0>]}
[0m17:29:56.265543 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.9201427, "process_user_time": 3.680448, "process_kernel_time": 0.849286, "process_mem_max_rss": "98656256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:29:56.267739 [debug] [MainThread]: Command `dbt deps` succeeded at 17:29:56.267148 after 1.93 seconds
[0m17:29:56.269403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a22d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113af1900>]}
[0m17:29:56.271038 [debug] [MainThread]: Flushing usage events
[0m17:35:12.126914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e6830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e64d0>]}


============================== 17:35:12.132403 | fb2aac00-dee6-4d5e-b91b-19101ed3f639 ==============================
[0m17:35:12.132403 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:35:12.133621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m int_unique_ordered_products.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:12.764508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e6740>]}
[0m17:35:12.887687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab3430>]}
[0m17:35:12.891234 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:35:12.954103 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:35:12.971796 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:35:12.973261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab0a30>]}
[0m17:35:15.387429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:35:15.397033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee5c30>]}
[0m17:35:15.418402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4bd00>]}
[0m17:35:15.419695 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m17:35:15.420840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f49d20>]}
[0m17:35:15.424965 [info ] [MainThread]: 
[0m17:35:15.427065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:35:15.429557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:35:15.447615 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:35:15.448586 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:35:15.449427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:15.523647 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:35:15.526155 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:35:15.530119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:35:15.539489 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:35:15.540431 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:35:15.541254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:15.547802 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:35:15.548754 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:35:15.549624 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:35:15.564905 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m17:35:15.567653 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:35:15.568906 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:35:15.581259 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:15.582238 [debug] [MainThread]: On master: BEGIN
[0m17:35:15.583064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:15.589841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:35:15.590807 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:15.591771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:35:15.637656 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:35:15.641231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db2bf0>]}
[0m17:35:15.642235 [debug] [MainThread]: On master: ROLLBACK
[0m17:35:15.643252 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:15.644096 [debug] [MainThread]: On master: BEGIN
[0m17:35:15.645165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:35:15.646017 [debug] [MainThread]: On master: COMMIT
[0m17:35:15.646891 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:15.647714 [debug] [MainThread]: On master: COMMIT
[0m17:35:15.648737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:35:15.649681 [debug] [MainThread]: On master: Close
[0m17:35:15.651077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:15.652255 [info ] [MainThread]: 
[0m17:35:15.656218 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_unique_ordered_products
[0m17:35:15.657614 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_unique_ordered_products ............. [RUN]
[0m17:35:15.659832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_unique_ordered_products)
[0m17:35:15.661144 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_unique_ordered_products
[0m17:35:15.675909 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.678593 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_unique_ordered_products (compile): 17:35:15.661934 => 17:35:15.677722
[0m17:35:15.679941 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_unique_ordered_products
[0m17:35:15.730782 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.732254 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.733195 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: BEGIN
[0m17:35:15.734092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:15.740823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:35:15.741954 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.743470 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */

  create view "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_tmp"
    
    
  as (
    select
        distinct on (productkey) *
    from "contosodb"."public"."fctsales"
    order by productkey,productkey desc
  );
[0m17:35:15.759761 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:35:15.769522 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.770606 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */
alter table "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_tmp" rename to "int_unique_ordered_products"
[0m17:35:15.772256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:35:15.791716 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: COMMIT
[0m17:35:15.792889 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.793822 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: COMMIT
[0m17:35:15.796381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:35:15.808237 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_backup"
[0m17:35:15.814563 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:35:15.815619 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */
drop view if exists "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_backup" cascade
[0m17:35:15.817451 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:35:15.820521 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_unique_ordered_products (execute): 17:35:15.680586 => 17:35:15.820064
[0m17:35:15.821552 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: Close
[0m17:35:15.823767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2aac00-dee6-4d5e-b91b-19101ed3f639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925c250>]}
[0m17:35:15.825646 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_unique_ordered_products ........ [[32mCREATE VIEW[0m in 0.16s]
[0m17:35:15.827401 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_unique_ordered_products
[0m17:35:15.829786 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:15.830773 [debug] [MainThread]: On master: BEGIN
[0m17:35:15.832071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:15.849050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:35:15.850029 [debug] [MainThread]: On master: COMMIT
[0m17:35:15.850889 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:15.851729 [debug] [MainThread]: On master: COMMIT
[0m17:35:15.853557 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:35:15.854651 [debug] [MainThread]: On master: Close
[0m17:35:15.856485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:15.857562 [debug] [MainThread]: Connection 'model.postgres_dbt.int_unique_ordered_products' was properly closed.
[0m17:35:15.858459 [info ] [MainThread]: 
[0m17:35:15.859591 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:35:15.861226 [debug] [MainThread]: Command end result
[0m17:35:15.881143 [info ] [MainThread]: 
[0m17:35:15.882950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:15.884172 [info ] [MainThread]: 
[0m17:35:15.885409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:35:15.888350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8363175, "process_user_time": 5.696427, "process_kernel_time": 0.372343, "process_mem_max_rss": "119730176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:35:15.890165 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:15.889451 after 3.84 seconds
[0m17:35:15.891740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109253880>]}
[0m17:35:15.893146 [debug] [MainThread]: Flushing usage events
[0m17:38:38.117637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4873d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1e500>]}


============================== 17:38:38.123072 | 563b0c2b-46a1-4e4f-ab25-50db5cba0b61 ==============================
[0m17:38:38.123072 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:38:38.124253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m int_unique_ordered_products.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:38.398362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1e770>]}
[0m17:38:38.522386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e9c30>]}
[0m17:38:38.523972 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:38:38.575253 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:38:38.646245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:38.647552 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/intermediate/int_unique_ordered_products.sql
[0m17:38:38.899117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:38:38.908095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d31c0>]}
[0m17:38:38.931708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264d5a0>]}
[0m17:38:38.932788 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m17:38:38.934621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264d510>]}
[0m17:38:38.938297 [info ] [MainThread]: 
[0m17:38:38.940931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:38.942835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:38:38.962649 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:38:38.963598 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:38:38.964630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:39.014046 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:38:39.018462 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:38:39.024217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:38:39.032703 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:38:39.033600 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:38:39.034408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:39.040693 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:39.041604 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:38:39.042448 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:38:39.048505 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m17:38:39.050594 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:38:39.051576 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:38:39.062871 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:39.063777 [debug] [MainThread]: On master: BEGIN
[0m17:38:39.064565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:39.070922 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:39.071880 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:39.072815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:39.115053 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:38:39.118425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127dcdf0>]}
[0m17:38:39.119402 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:39.120382 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:39.121220 [debug] [MainThread]: On master: BEGIN
[0m17:38:39.122245 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:39.123078 [debug] [MainThread]: On master: COMMIT
[0m17:38:39.123906 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:39.124719 [debug] [MainThread]: On master: COMMIT
[0m17:38:39.125733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:39.126579 [debug] [MainThread]: On master: Close
[0m17:38:39.127946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:39.129083 [info ] [MainThread]: 
[0m17:38:39.131705 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_unique_ordered_products
[0m17:38:39.132797 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_unique_ordered_products ............. [RUN]
[0m17:38:39.134174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_unique_ordered_products)
[0m17:38:39.135295 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_unique_ordered_products
[0m17:38:39.147969 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.149870 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_unique_ordered_products (compile): 17:38:39.136002 => 17:38:39.149061
[0m17:38:39.151962 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_unique_ordered_products
[0m17:38:39.201039 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.202521 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.203574 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: BEGIN
[0m17:38:39.204506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:39.210879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:38:39.211860 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.213419 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */

  create view "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_tmp"
    
    
  as (
    with unique_product as (
    select productkey,
    count(*)
    from "contosodb"."public"."fctsales"
    group by productkey
)

select
        distinct on (productkey) *
    from unique_product
    order by productkey,productkey desc
  );
[0m17:38:39.218471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:38:39.228305 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.229631 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */
alter table "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_tmp" rename to "int_unique_ordered_products"
[0m17:38:39.231104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:38:39.250651 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: COMMIT
[0m17:38:39.251644 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.252762 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: COMMIT
[0m17:38:39.254689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:38:39.264258 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_backup"
[0m17:38:39.270941 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:38:39.271930 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */
drop view if exists "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_backup" cascade
[0m17:38:39.273108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:38:39.275521 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_unique_ordered_products (execute): 17:38:39.152961 => 17:38:39.275075
[0m17:38:39.276567 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: Close
[0m17:38:39.277999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '563b0c2b-46a1-4e4f-ab25-50db5cba0b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285cb20>]}
[0m17:38:39.279296 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_unique_ordered_products ........ [[32mCREATE VIEW[0m in 0.14s]
[0m17:38:39.280576 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_unique_ordered_products
[0m17:38:39.282558 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:39.283442 [debug] [MainThread]: On master: BEGIN
[0m17:38:39.284365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:39.291872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:39.293111 [debug] [MainThread]: On master: COMMIT
[0m17:38:39.294046 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:39.294907 [debug] [MainThread]: On master: COMMIT
[0m17:38:39.296872 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:39.297845 [debug] [MainThread]: On master: Close
[0m17:38:39.299501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:39.303023 [debug] [MainThread]: Connection 'model.postgres_dbt.int_unique_ordered_products' was properly closed.
[0m17:38:39.304263 [info ] [MainThread]: 
[0m17:38:39.305430 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:38:39.307462 [debug] [MainThread]: Command end result
[0m17:38:39.324904 [info ] [MainThread]: 
[0m17:38:39.326059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:39.327061 [info ] [MainThread]: 
[0m17:38:39.328095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:38:39.331020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2863476, "process_user_time": 3.686824, "process_kernel_time": 0.304868, "process_mem_max_rss": "112148480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:39.335769 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:39.335003 after 1.29 seconds
[0m17:38:39.339495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4873d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112816500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264c640>]}
[0m17:38:39.341276 [debug] [MainThread]: Flushing usage events
[0m17:40:39.054800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e973d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742e860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742e500>]}


============================== 17:40:39.061399 | 0737ee9e-18d8-46a5-abe3-23c77ff6feb5 ==============================
[0m17:40:39.061399 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:40:39.062865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m int_unique_ordered_products.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:40:39.335524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742e770>]}
[0m17:40:39.459232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794dc30>]}
[0m17:40:39.460710 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:40:39.495535 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:40:39.564849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:39.566278 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/intermediate/int_unique_ordered_products.sql
[0m17:40:39.816028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:40:39.824954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d0820>]}
[0m17:40:39.843787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080515a0>]}
[0m17:40:39.845075 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m17:40:39.846542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108051510>]}
[0m17:40:39.849251 [info ] [MainThread]: 
[0m17:40:39.850862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:39.853261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m17:40:39.870204 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m17:40:39.871572 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m17:40:39.873122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:39.905744 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:40:39.908224 [debug] [ThreadPool]: On list_contosodb: Close
[0m17:40:39.911679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m17:40:39.920848 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:40:39.921819 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:40:39.922669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:39.929329 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:40:39.930551 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:40:39.931433 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:40:39.937873 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m17:40:39.940134 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:40:39.941159 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:40:39.952296 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:39.953271 [debug] [MainThread]: On master: BEGIN
[0m17:40:39.954077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:39.960568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:40:39.961489 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:39.962389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:40.005045 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m17:40:40.008554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d4df0>]}
[0m17:40:40.009557 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:40.010586 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:40.011652 [debug] [MainThread]: On master: BEGIN
[0m17:40:40.012797 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:40:40.013663 [debug] [MainThread]: On master: COMMIT
[0m17:40:40.014495 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:40.015306 [debug] [MainThread]: On master: COMMIT
[0m17:40:40.016240 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:40:40.017084 [debug] [MainThread]: On master: Close
[0m17:40:40.018552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:40.019875 [info ] [MainThread]: 
[0m17:40:40.022649 [debug] [Thread-1 (]: Began running node model.postgres_dbt.int_unique_ordered_products
[0m17:40:40.023751 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.int_unique_ordered_products ............. [RUN]
[0m17:40:40.025329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.int_unique_ordered_products)
[0m17:40:40.026476 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.int_unique_ordered_products
[0m17:40:40.040084 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.041701 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_unique_ordered_products (compile): 17:40:40.027676 => 17:40:40.041172
[0m17:40:40.043203 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.int_unique_ordered_products
[0m17:40:40.094508 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.095955 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.096910 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: BEGIN
[0m17:40:40.097800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:40.104293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:40:40.105299 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.106230 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */

  create view "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_tmp"
    
    
  as (
    with unique_product as (
    select productkey,
    SUM(salesquantity) as soldquantity
    from "contosodb"."public"."fctsales"
    group by productkey
)

select
        distinct on (productkey) *
    from unique_product
    order by productkey,productkey desc
  );
[0m17:40:40.112184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:40:40.122341 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.123418 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */
alter table "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_tmp" rename to "int_unique_ordered_products"
[0m17:40:40.124882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:40:40.144650 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: COMMIT
[0m17:40:40.145755 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.146982 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: COMMIT
[0m17:40:40.149534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:40:40.159416 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_backup"
[0m17:40:40.166061 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.int_unique_ordered_products"
[0m17:40:40.167099 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.int_unique_ordered_products"} */
drop view if exists "contosodb"."dbt_schema"."int_unique_ordered_products__dbt_backup" cascade
[0m17:40:40.168470 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:40:40.171163 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.int_unique_ordered_products (execute): 17:40:40.044227 => 17:40:40.170709
[0m17:40:40.172123 [debug] [Thread-1 (]: On model.postgres_dbt.int_unique_ordered_products: Close
[0m17:40:40.173620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0737ee9e-18d8-46a5-abe3-23c77ff6feb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108258b20>]}
[0m17:40:40.174943 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.int_unique_ordered_products ........ [[32mCREATE VIEW[0m in 0.15s]
[0m17:40:40.176361 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.int_unique_ordered_products
[0m17:40:40.178531 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:40.179445 [debug] [MainThread]: On master: BEGIN
[0m17:40:40.180251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:40.194644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:40:40.195599 [debug] [MainThread]: On master: COMMIT
[0m17:40:40.196425 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:40.197231 [debug] [MainThread]: On master: COMMIT
[0m17:40:40.198171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:40:40.199011 [debug] [MainThread]: On master: Close
[0m17:40:40.200357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:40.201247 [debug] [MainThread]: Connection 'model.postgres_dbt.int_unique_ordered_products' was properly closed.
[0m17:40:40.202432 [info ] [MainThread]: 
[0m17:40:40.204131 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m17:40:40.206325 [debug] [MainThread]: Command end result
[0m17:40:40.223904 [info ] [MainThread]: 
[0m17:40:40.225132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:40.226277 [info ] [MainThread]: 
[0m17:40:40.227343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:40:40.229668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2504611, "process_user_time": 3.756777, "process_kernel_time": 0.315503, "process_mem_max_rss": "113278976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:40:40.231567 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:40.231195 after 1.25 seconds
[0m17:40:40.232574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e973d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080502e0>]}
[0m17:40:40.233473 [debug] [MainThread]: Flushing usage events
[0m17:47:15.719624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e3b0>]}


============================== 17:47:15.724951 | 458dddde-5d63-4154-906e-8f13c454469b ==============================
[0m17:47:15.724951 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:47:15.726160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:15.882256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '458dddde-5d63-4154-906e-8f13c454469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0eb60>]}
[0m17:47:15.887971 [debug] [MainThread]: Set downloads directory='/var/folders/1d/gd56k03j78b5qs_xy6hxwy5c0000gn/T/dbt-downloads-9a5wniaa'
[0m17:47:15.889667 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:47:16.056449 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:47:16.057965 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:47:16.108557 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:47:16.117385 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/calogica/dbt-expectations.git ec90e2ae5a16eb71b4bb9d571ecc6fc1"
[0m17:47:18.895320 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:18.898812 [debug] [MainThread]: STDERR: "b"Cloning into 'ec90e2ae5a16eb71b4bb9d571ecc6fc1'...\n""
[0m17:47:18.900951 [debug] [MainThread]: Pulling new dependency ec90e2ae5a16eb71b4bb9d571ecc6fc1.
[0m17:47:18.902452 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:18.912801 [debug] [MainThread]: STDOUT: "b'f645ef3a3a723a28774550673abbdf684e194509\n'"
[0m17:47:18.914961 [debug] [MainThread]: STDERR: "b''"
[0m17:47:18.915991 [debug] [MainThread]: Checking out revision 0.10.1.
[0m17:47:18.917128 [debug] [MainThread]: Executing "git remote set-branches origin 0.10.1"
[0m17:47:18.927597 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:18.929228 [debug] [MainThread]: STDERR: "b''"
[0m17:47:18.930470 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.10.1"
[0m17:47:20.095227 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:20.100535 [debug] [MainThread]: STDERR: "b'From https://github.com/calogica/dbt-expectations\n * tag               0.10.1     -> FETCH_HEAD\n * [new tag]         0.1        -> 0.1\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.10.0     -> 0.10.0\n * [new tag]         0.10.1     -> 0.10.1\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.2.6      -> 0.2.6\n * [new tag]         0.2.7      -> 0.2.7\n * [new tag]         0.2.8      -> 0.2.8\n * [new tag]         0.2.9      -> 0.2.9\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.3.1      -> 0.3.1\n * [new tag]         0.3.2      -> 0.3.2\n * [new tag]         0.3.3      -> 0.3.3\n * [new tag]         0.3.4      -> 0.3.4\n * [new tag]         0.3.5      -> 0.3.5\n * [new tag]         0.3.6      -> 0.3.6\n * [new tag]         0.3.7      -> 0.3.7\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.4.2      -> 0.4.2\n * [new tag]         0.4.3      -> 0.4.3\n * [new tag]         0.4.4      -> 0.4.4\n * [new tag]         0.4.5      -> 0.4.5\n * [new tag]         0.4.6      -> 0.4.6\n * [new tag]         0.4.7      -> 0.4.7\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.5.2      -> 0.5.2\n * [new tag]         0.5.3      -> 0.5.3\n * [new tag]         0.5.4      -> 0.5.4\n * [new tag]         0.5.5      -> 0.5.5\n * [new tag]         0.5.6      -> 0.5.6\n * [new tag]         0.5.7      -> 0.5.7\n * [new tag]         0.5.8      -> 0.5.8\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.9.0      -> 0.9.0\n'"
[0m17:47:20.104094 [debug] [MainThread]: Executing "git tag --list"
[0m17:47:20.126606 [debug] [MainThread]: STDOUT: "b'0.1\n0.1.2\n0.1.3\n0.1.4\n0.10.0\n0.10.1\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.2.6\n0.2.7\n0.2.8\n0.2.9\n0.3.0\n0.3.1\n0.3.2\n0.3.3\n0.3.4\n0.3.5\n0.3.6\n0.3.7\n0.4.0\n0.4.1\n0.4.2\n0.4.3\n0.4.4\n0.4.5\n0.4.6\n0.4.7\n0.5.0\n0.5.1\n0.5.2\n0.5.3\n0.5.4\n0.5.5\n0.5.6\n0.5.7\n0.5.8\n0.6.0\n0.6.1\n0.7.0\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.9.0\n'"
[0m17:47:20.128773 [debug] [MainThread]: STDERR: "b''"
[0m17:47:20.131198 [debug] [MainThread]: Executing "git reset --hard tags/0.10.1"
[0m17:47:20.188262 [debug] [MainThread]: STDOUT: "b'HEAD is now at bc64c92 Update CHANGELOG.md\n'"
[0m17:47:20.189562 [debug] [MainThread]: STDERR: "b''"
[0m17:47:20.190469 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:20.200731 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:20.202153 [debug] [MainThread]: STDERR: "b''"
[0m17:47:20.203558 [debug] [MainThread]: Checked out at bc64c92.
[0m17:47:20.204696 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:20.213626 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:20.215047 [debug] [MainThread]: STDERR: "b''"
[0m17:47:20.221907 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m17:47:20.288374 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m17:47:20.306485 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/calogica/dbt-expectations.git ec90e2ae5a16eb71b4bb9d571ecc6fc1"
[0m17:47:20.319257 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:20.320675 [debug] [MainThread]: STDERR: "b"fatal: destination path 'ec90e2ae5a16eb71b4bb9d571ecc6fc1' already exists and is not an empty directory.\n""
[0m17:47:20.321540 [debug] [MainThread]: command return code=128
[0m17:47:20.324784 [debug] [MainThread]: Updating existing dependency ec90e2ae5a16eb71b4bb9d571ecc6fc1.
[0m17:47:20.325882 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:20.337295 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:20.338544 [debug] [MainThread]: STDERR: "b''"
[0m17:47:20.339436 [debug] [MainThread]: Checking out revision 0.10.1.
[0m17:47:20.340288 [debug] [MainThread]: Executing "git remote set-branches origin 0.10.1"
[0m17:47:20.354427 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:20.355820 [debug] [MainThread]: STDERR: "b''"
[0m17:47:20.356667 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.10.1"
[0m17:47:21.251015 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:21.252427 [debug] [MainThread]: STDERR: "b'From https://github.com/calogica/dbt-expectations\n * tag               0.10.1     -> FETCH_HEAD\n'"
[0m17:47:21.253451 [debug] [MainThread]: Executing "git tag --list"
[0m17:47:21.265973 [debug] [MainThread]: STDOUT: "b'0.1\n0.1.2\n0.1.3\n0.1.4\n0.10.0\n0.10.1\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.2.6\n0.2.7\n0.2.8\n0.2.9\n0.3.0\n0.3.1\n0.3.2\n0.3.3\n0.3.4\n0.3.5\n0.3.6\n0.3.7\n0.4.0\n0.4.1\n0.4.2\n0.4.3\n0.4.4\n0.4.5\n0.4.6\n0.4.7\n0.5.0\n0.5.1\n0.5.2\n0.5.3\n0.5.4\n0.5.5\n0.5.6\n0.5.7\n0.5.8\n0.6.0\n0.6.1\n0.7.0\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.9.0\n'"
[0m17:47:21.268020 [debug] [MainThread]: STDERR: "b''"
[0m17:47:21.269164 [debug] [MainThread]: Executing "git reset --hard tags/0.10.1"
[0m17:47:21.285938 [debug] [MainThread]: STDOUT: "b'HEAD is now at bc64c92 Update CHANGELOG.md\n'"
[0m17:47:21.287214 [debug] [MainThread]: STDERR: "b''"
[0m17:47:21.288105 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:21.296829 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:21.298217 [debug] [MainThread]: STDERR: "b''"
[0m17:47:21.299224 [debug] [MainThread]: Already at bc64c92, nothing to do.
[0m17:47:21.300272 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:21.308052 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:21.309419 [debug] [MainThread]: STDERR: "b''"
[0m17:47:21.349630 [info ] [MainThread]: Updating lock file in file path: /Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/package-lock.yml
[0m17:47:21.413966 [debug] [MainThread]: Set downloads directory='/var/folders/1d/gd56k03j78b5qs_xy6hxwy5c0000gn/T/dbt-downloads-gg881av5'
[0m17:47:21.426253 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:47:22.412044 [info ] [MainThread]: Installed from version 1.1.1
[0m17:47:22.414108 [info ] [MainThread]: Up to date!
[0m17:47:22.422499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '458dddde-5d63-4154-906e-8f13c454469b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0fac0>]}
[0m17:47:22.438191 [info ] [MainThread]: Installing https://github.com/calogica/dbt-expectations.git
[0m17:47:22.441002 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/calogica/dbt-expectations.git ec90e2ae5a16eb71b4bb9d571ecc6fc1"
[0m17:47:23.478917 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:23.480363 [debug] [MainThread]: STDERR: "b"Cloning into 'ec90e2ae5a16eb71b4bb9d571ecc6fc1'...\n""
[0m17:47:23.481323 [debug] [MainThread]: Pulling new dependency ec90e2ae5a16eb71b4bb9d571ecc6fc1.
[0m17:47:23.482163 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:23.492384 [debug] [MainThread]: STDOUT: "b'f645ef3a3a723a28774550673abbdf684e194509\n'"
[0m17:47:23.493630 [debug] [MainThread]: STDERR: "b''"
[0m17:47:23.494720 [debug] [MainThread]: Checking out revision bc64c9233894ee56981413890697adfc44d6c363.
[0m17:47:23.496280 [debug] [MainThread]: Executing "git fetch origin --depth 1 bc64c9233894ee56981413890697adfc44d6c363"
[0m17:47:24.098715 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:24.100674 [debug] [MainThread]: STDERR: "b'From https://github.com/calogica/dbt-expectations\n * branch            bc64c9233894ee56981413890697adfc44d6c363 -> FETCH_HEAD\n'"
[0m17:47:24.102474 [debug] [MainThread]: Executing "git reset --hard bc64c9233894ee56981413890697adfc44d6c363"
[0m17:47:24.148435 [debug] [MainThread]: STDOUT: "b'HEAD is now at bc64c92 Update CHANGELOG.md\n'"
[0m17:47:24.149921 [debug] [MainThread]: STDERR: "b''"
[0m17:47:24.151014 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:24.160287 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:24.162057 [debug] [MainThread]: STDERR: "b''"
[0m17:47:24.163854 [debug] [MainThread]: Checked out at bc64c92.
[0m17:47:24.165292 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:24.180886 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:24.182763 [debug] [MainThread]: STDERR: "b''"
[0m17:47:24.187737 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/calogica/dbt-expectations.git ec90e2ae5a16eb71b4bb9d571ecc6fc1"
[0m17:47:24.197313 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:24.198568 [debug] [MainThread]: STDERR: "b"fatal: destination path 'ec90e2ae5a16eb71b4bb9d571ecc6fc1' already exists and is not an empty directory.\n""
[0m17:47:24.199387 [debug] [MainThread]: command return code=128
[0m17:47:24.202251 [debug] [MainThread]: Updating existing dependency ec90e2ae5a16eb71b4bb9d571ecc6fc1.
[0m17:47:24.203712 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:24.213053 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:24.215222 [debug] [MainThread]: STDERR: "b''"
[0m17:47:24.217149 [debug] [MainThread]: Checking out revision bc64c9233894ee56981413890697adfc44d6c363.
[0m17:47:24.218374 [debug] [MainThread]: Executing "git fetch origin --depth 1 bc64c9233894ee56981413890697adfc44d6c363"
[0m17:47:25.232070 [debug] [MainThread]: STDOUT: "b''"
[0m17:47:25.233352 [debug] [MainThread]: STDERR: "b'From https://github.com/calogica/dbt-expectations\n * branch            bc64c9233894ee56981413890697adfc44d6c363 -> FETCH_HEAD\n'"
[0m17:47:25.234266 [debug] [MainThread]: Executing "git reset --hard bc64c9233894ee56981413890697adfc44d6c363"
[0m17:47:25.249554 [debug] [MainThread]: STDOUT: "b'HEAD is now at bc64c92 Update CHANGELOG.md\n'"
[0m17:47:25.251107 [debug] [MainThread]: STDERR: "b''"
[0m17:47:25.252535 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:47:25.261152 [debug] [MainThread]: STDOUT: "b'bc64c9233894ee56981413890697adfc44d6c363\n'"
[0m17:47:25.262652 [debug] [MainThread]: STDERR: "b''"
[0m17:47:25.263731 [debug] [MainThread]: Already at bc64c92, nothing to do.
[0m17:47:25.265021 [info ] [MainThread]: Installed from revision bc64c9233894ee56981413890697adfc44d6c363
[0m17:47:25.266288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '458dddde-5d63-4154-906e-8f13c454469b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca27d0>]}
[0m17:47:25.267386 [info ] [MainThread]: Installing calogica/dbt_date
[0m17:47:25.521412 [info ] [MainThread]: Installed from version 0.10.0
[0m17:47:25.523137 [info ] [MainThread]: Up to date!
[0m17:47:25.524914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '458dddde-5d63-4154-906e-8f13c454469b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdf160>]}
[0m17:47:25.529865 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.883764, "process_user_time": 3.26489, "process_kernel_time": 0.513702, "process_mem_max_rss": "98885632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:47:25.531571 [debug] [MainThread]: Command `dbt deps` succeeded at 17:47:25.531163 after 9.89 seconds
[0m17:47:25.532636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cde170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdce20>]}
[0m17:47:25.533787 [debug] [MainThread]: Flushing usage events
[0m17:51:29.751348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096533d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf24d0>]}


============================== 17:51:29.756714 | 7dff8abc-88f8-470d-ab9a-ed8822825872 ==============================
[0m17:51:29.756714 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:51:29.757932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:30.026406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf2740>]}
[0m17:51:30.149348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5bf970>]}
[0m17:51:30.151066 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:51:30.214887 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:51:30.235009 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:51:30.236484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c05e530>]}
[0m17:51:33.181222 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:51:33.190607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce703d0>]}
[0m17:51:33.221421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5bec50>]}
[0m17:51:33.222849 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m17:51:33.225061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa8e50>]}
[0m17:51:33.228921 [info ] [MainThread]: 
[0m17:51:33.230454 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:33.234777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m17:51:33.254489 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:51:33.255522 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:51:33.256340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:33.293820 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.295528 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:51:33.296539 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:51:33.303694 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:51:33.306090 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:51:33.307231 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:51:33.321203 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:33.322137 [debug] [MainThread]: On master: BEGIN
[0m17:51:33.322955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:33.329993 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.330902 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:33.331826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:33.380291 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m17:51:33.383987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dff8abc-88f8-470d-ab9a-ed8822825872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce73760>]}
[0m17:51:33.384991 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:33.386023 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:33.386861 [debug] [MainThread]: On master: BEGIN
[0m17:51:33.387881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.388721 [debug] [MainThread]: On master: COMMIT
[0m17:51:33.389794 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:33.391255 [debug] [MainThread]: On master: COMMIT
[0m17:51:33.392272 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:51:33.393126 [debug] [MainThread]: On master: Close
[0m17:51:33.394412 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:33.395454 [info ] [MainThread]: 
[0m17:51:33.398306 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:51:33.399303 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m17:51:33.400796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m17:51:33.401796 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:51:33.418002 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:51:33.419503 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 17:51:33.402388 => 17:51:33.419020
[0m17:51:33.420527 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:51:33.448324 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:51:33.449813 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:51:33.450736 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m17:51:33.451621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:33.458995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.459975 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:51:33.460993 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m17:51:33.466454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:33.470066 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 17:51:33.421137 => 17:51:33.469417
[0m17:51:33.471176 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m17:51:33.472355 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m17:51:33.474071 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.07s]
[0m17:51:33.475449 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:51:33.476452 [debug] [Thread-1 (]: Began running node test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84
[0m17:51:33.477565 [info ] [Thread-1 (]: 2 of 7 START test dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null  [RUN]
[0m17:51:33.478901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84)
[0m17:51:33.480478 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84
[0m17:51:33.491035 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84"
[0m17:51:33.493778 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84 (compile): 17:51:33.481686 => 17:51:33.492711
[0m17:51:33.494888 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84
[0m17:51:33.499217 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84"
[0m17:51:33.500654 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84"
[0m17:51:33.501675 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84: BEGIN
[0m17:51:33.502572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:33.510124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.511121 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84"
[0m17:51:33.512060 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
   is not null as expression


    from "contosodb"."dbt_schema"."sales"
    where
        saleskey is not null
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




      
    ) dbt_internal_test
[0m17:51:33.513860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "not"
LINE 17:    is not null as expression
               ^

[0m17:51:33.514950 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84: ROLLBACK
[0m17:51:33.516393 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84 (execute): 17:51:33.495495 => 17:51:33.515933
[0m17:51:33.517409 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84: Close
[0m17:51:33.531049 [debug] [Thread-1 (]: Database Error in test dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null (models/test_config.yml)
  syntax error at or near "not"
  LINE 17:    is not null as expression
                 ^
  compiled Code at target/run/postgres_dbt/models/test_config.yml/dbt_expectations_expect_column_37b43cf8e53b83539a3b172ed23a4186.sql
[0m17:51:33.532502 [error] [Thread-1 (]: 2 of 7 ERROR dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null  [[31mERROR[0m in 0.05s]
[0m17:51:33.534191 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84
[0m17:51:33.535343 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:51:33.536430 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m17:51:33.537867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null.129b767e84, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m17:51:33.538943 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:51:33.550180 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:51:33.551693 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 17:51:33.539625 => 17:51:33.551205
[0m17:51:33.552639 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:51:33.557418 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:51:33.558925 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:51:33.559884 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m17:51:33.560773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:33.569754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.570766 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:51:33.571828 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m17:51:33.580361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:33.583558 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 17:51:33.553228 => 17:51:33.582994
[0m17:51:33.584666 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m17:51:33.585742 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m17:51:33.587205 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.05s]
[0m17:51:33.589585 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:51:33.590838 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m17:51:33.591871 [info ] [Thread-1 (]: 4 of 7 START test sales_low_profit_check ....................................... [RUN]
[0m17:51:33.594109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m17:51:33.595319 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m17:51:33.601956 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m17:51:33.603525 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 17:51:33.595961 => 17:51:33.603048
[0m17:51:33.604449 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m17:51:33.609508 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m17:51:33.611947 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:51:33.613566 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m17:51:33.614547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:33.620821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:33.621799 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:51:33.622703 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m17:51:34.409203 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m17:51:34.413102 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 17:51:33.605693 => 17:51:34.412315
[0m17:51:34.414747 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m17:51:34.416870 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m17:51:34.419557 [error] [Thread-1 (]: 4 of 7 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.83s]
[0m17:51:34.421674 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m17:51:34.423495 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:51:34.425609 [info ] [Thread-1 (]: 5 of 7 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m17:51:34.427900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m17:51:34.429213 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:51:34.442071 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:51:34.444531 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 17:51:34.429967 => 17:51:34.443619
[0m17:51:34.447078 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:51:34.461392 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:51:34.464639 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:51:34.467094 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m17:51:34.468898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:34.481424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:34.483559 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:51:34.485500 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m17:51:34.490076 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:34.494802 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 17:51:34.448719 => 17:51:34.493554
[0m17:51:34.497378 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m17:51:34.499245 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m17:51:34.501876 [info ] [Thread-1 (]: 5 of 7 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.07s]
[0m17:51:34.504441 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:51:34.506400 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:51:34.508193 [info ] [Thread-1 (]: 6 of 7 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m17:51:34.511073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m17:51:34.513112 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:51:34.534678 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:51:34.537045 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 17:51:34.514270 => 17:51:34.536321
[0m17:51:34.538240 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:51:34.545626 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:51:34.547355 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:51:34.548510 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m17:51:34.549410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:34.556305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:34.558354 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:51:34.560151 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m17:51:34.564374 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:34.566786 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 17:51:34.538868 => 17:51:34.566317
[0m17:51:34.568080 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m17:51:34.569323 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m17:51:34.571118 [info ] [Thread-1 (]: 6 of 7 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.06s]
[0m17:51:34.572608 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:51:34.573653 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:51:34.574576 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m17:51:34.576377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m17:51:34.577584 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:51:34.592422 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:51:34.594284 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 17:51:34.578518 => 17:51:34.593517
[0m17:51:34.595908 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:51:34.602257 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:51:34.603760 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:51:34.605059 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m17:51:34.606097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:34.613623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:34.614723 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:51:34.616180 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m17:51:34.622027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:34.625300 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 17:51:34.597158 => 17:51:34.624786
[0m17:51:34.626344 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m17:51:34.627578 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m17:51:34.629138 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.05s]
[0m17:51:34.631114 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:51:34.633704 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:34.634638 [debug] [MainThread]: On master: BEGIN
[0m17:51:34.635524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:34.644653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:34.645953 [debug] [MainThread]: On master: COMMIT
[0m17:51:34.648593 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:34.649956 [debug] [MainThread]: On master: COMMIT
[0m17:51:34.651004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:51:34.651898 [debug] [MainThread]: On master: Close
[0m17:51:34.653740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:34.655561 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m17:51:34.657038 [info ] [MainThread]: 
[0m17:51:34.658039 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m17:51:34.661542 [debug] [MainThread]: Command end result
[0m17:51:34.757073 [info ] [MainThread]: 
[0m17:51:34.758359 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:51:34.760515 [info ] [MainThread]: 
[0m17:51:34.761605 [error] [MainThread]:   Database Error in test dbt_expectations_expect_column_values_to_not_be_null_sales_saleskey_is_not_null (models/test_config.yml)
  syntax error at or near "not"
  LINE 17:    is not null as expression
                 ^
  compiled Code at target/run/postgres_dbt/models/test_config.yml/dbt_expectations_expect_column_37b43cf8e53b83539a3b172ed23a4186.sql
[0m17:51:34.762979 [info ] [MainThread]: 
[0m17:51:34.764190 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m17:51:34.765672 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m17:51:34.767387 [info ] [MainThread]: 
[0m17:51:34.770080 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m17:51:34.771175 [info ] [MainThread]: 
[0m17:51:34.773782 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m17:51:34.778176 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.1006165, "process_user_time": 6.496785, "process_kernel_time": 0.348022, "process_mem_max_rss": "121741312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:51:34.779903 [debug] [MainThread]: Command `dbt test` failed at 17:51:34.779415 after 5.10 seconds
[0m17:51:34.782553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096533d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf44550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf445e0>]}
[0m17:51:34.784152 [debug] [MainThread]: Flushing usage events
[0m17:53:39.747411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110036800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100364a0>]}


============================== 17:53:39.752785 | 17b0cd94-6f1f-405b-9c6d-19e54cc651c2 ==============================
[0m17:53:39.752785 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:53:39.753961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariocukovic/.dbt', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:53:40.018380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b0cd94-6f1f-405b-9c6d-19e54cc651c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110036710>]}
[0m17:53:40.140354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17b0cd94-6f1f-405b-9c6d-19e54cc651c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110526920>]}
[0m17:53:40.141759 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:53:40.205842 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:53:40.330231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:40.331675 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/test_config.yml
[0m17:53:40.671032 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_contoso_sales' in the 'models' section of file 'models/test_config.yml'
[0m17:53:40.836307 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso_sales_ref_sales_.f7cee55fbf' (models/test_config.yml) depends on a node named 'stg_contoso_sales' in package '' which was not found
[0m17:53:40.849386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:53:40.861700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b0cd94-6f1f-405b-9c6d-19e54cc651c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e40d0>]}
[0m17:53:40.886543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b0cd94-6f1f-405b-9c6d-19e54cc651c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a3610>]}
[0m17:53:40.887869 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m17:53:40.888828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b0cd94-6f1f-405b-9c6d-19e54cc651c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a3670>]}
[0m17:53:40.891782 [info ] [MainThread]: 
[0m17:53:40.894078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:40.896874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m17:53:40.916007 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:53:40.917865 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:53:40.919327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:40.956595 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:53:40.957577 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:53:40.958567 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:53:40.965841 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:53:40.968402 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:53:40.969462 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:53:40.982302 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:40.983206 [debug] [MainThread]: On master: BEGIN
[0m17:53:40.984159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:40.990649 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:40.991542 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:40.992453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:41.038441 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m17:53:41.041862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b0cd94-6f1f-405b-9c6d-19e54cc651c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110c6ce0>]}
[0m17:53:41.042834 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:41.043817 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:41.044645 [debug] [MainThread]: On master: BEGIN
[0m17:53:41.045652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.046492 [debug] [MainThread]: On master: COMMIT
[0m17:53:41.047371 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:41.048185 [debug] [MainThread]: On master: COMMIT
[0m17:53:41.049101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:53:41.049938 [debug] [MainThread]: On master: Close
[0m17:53:41.051431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:41.052545 [info ] [MainThread]: 
[0m17:53:41.055434 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:53:41.056416 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m17:53:41.057882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m17:53:41.059016 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:53:41.081137 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:53:41.082623 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 17:53:41.059696 => 17:53:41.082152
[0m17:53:41.083545 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:53:41.107369 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:53:41.108922 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:53:41.109840 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m17:53:41.110710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:41.117028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.117982 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:53:41.118987 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m17:53:41.122852 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:53:41.125802 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 17:53:41.084244 => 17:53:41.125338
[0m17:53:41.126741 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m17:53:41.127772 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m17:53:41.129242 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.07s]
[0m17:53:41.130652 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:53:41.131641 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:53:41.132550 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m17:53:41.133913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m17:53:41.135006 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:53:41.148039 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:53:41.149826 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 17:53:41.135674 => 17:53:41.149097
[0m17:53:41.151148 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:53:41.155815 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:53:41.157315 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:53:41.158234 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m17:53:41.159093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:41.165633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.167263 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:53:41.168359 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m17:53:41.171393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:53:41.174012 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 17:53:41.152026 => 17:53:41.173519
[0m17:53:41.174969 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m17:53:41.176006 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m17:53:41.177471 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.04s]
[0m17:53:41.179025 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:53:41.180011 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m17:53:41.180923 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m17:53:41.182274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m17:53:41.183426 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m17:53:41.188455 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m17:53:41.191058 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 17:53:41.184009 => 17:53:41.190102
[0m17:53:41.192644 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m17:53:41.196996 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m17:53:41.198311 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:53:41.199293 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m17:53:41.200720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:41.207939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.208894 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:53:41.209794 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m17:53:41.855650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m17:53:41.858118 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 17:53:41.193305 => 17:53:41.857667
[0m17:53:41.859033 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m17:53:41.860162 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m17:53:41.861618 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.68s]
[0m17:53:41.863054 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m17:53:41.864035 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:53:41.864942 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m17:53:41.866301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m17:53:41.867234 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:53:41.874935 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:53:41.877266 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 17:53:41.867817 => 17:53:41.876691
[0m17:53:41.878708 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:53:41.884943 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:53:41.886402 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:53:41.887324 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m17:53:41.888721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:41.895641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.896610 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:53:41.897514 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m17:53:41.900572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:53:41.903448 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 17:53:41.879349 => 17:53:41.902957
[0m17:53:41.904383 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m17:53:41.905510 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m17:53:41.907475 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.04s]
[0m17:53:41.908821 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:53:41.909935 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:53:41.910940 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m17:53:41.912237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m17:53:41.913284 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:53:41.920913 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:53:41.923063 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 17:53:41.913900 => 17:53:41.922479
[0m17:53:41.924024 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:53:41.928746 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:53:41.930100 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:53:41.931000 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m17:53:41.931869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:41.939812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.940802 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:53:41.941710 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m17:53:41.946090 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:53:41.948470 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 17:53:41.924606 => 17:53:41.948017
[0m17:53:41.949376 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m17:53:41.950883 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m17:53:41.953309 [info ] [Thread-1 (]: 5 of 6 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.04s]
[0m17:53:41.954656 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:53:41.955624 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:53:41.956539 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m17:53:41.957815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m17:53:41.958935 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:53:41.968942 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:53:41.971039 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 17:53:41.959841 => 17:53:41.970411
[0m17:53:41.972212 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:53:41.977700 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:53:41.979222 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:53:41.980135 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m17:53:41.981115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:41.988874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:41.989835 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:53:41.990730 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m17:53:41.995844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:53:41.999610 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 17:53:41.973343 => 17:53:41.999127
[0m17:53:42.000728 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m17:53:42.002195 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m17:53:42.004307 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.05s]
[0m17:53:42.005728 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:53:42.007671 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:42.008517 [debug] [MainThread]: On master: BEGIN
[0m17:53:42.009401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:42.026717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:42.029272 [debug] [MainThread]: On master: COMMIT
[0m17:53:42.030797 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:42.032303 [debug] [MainThread]: On master: COMMIT
[0m17:53:42.035628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:53:42.037587 [debug] [MainThread]: On master: Close
[0m17:53:42.039576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:42.041525 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m17:53:42.043174 [info ] [MainThread]: 
[0m17:53:42.044864 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m17:53:42.048709 [debug] [MainThread]: Command end result
[0m17:53:42.078702 [info ] [MainThread]: 
[0m17:53:42.080384 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:42.081929 [info ] [MainThread]: 
[0m17:53:42.083698 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m17:53:42.085291 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m17:53:42.086845 [info ] [MainThread]: 
[0m17:53:42.097681 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m17:53:42.107289 [info ] [MainThread]: 
[0m17:53:42.109504 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:53:42.114558 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.4402797, "process_user_time": 4.063848, "process_kernel_time": 0.323264, "process_mem_max_rss": "118493184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:53:42.124569 [debug] [MainThread]: Command `dbt test` failed at 17:53:42.123642 after 2.45 seconds
[0m17:53:42.126282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111960b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111195ff0>]}
[0m17:53:42.128870 [debug] [MainThread]: Flushing usage events
[0m17:54:14.163611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112099660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11463a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11463a530>]}


============================== 17:54:14.169048 | 22a02fec-ce83-454d-bd50-5643688b7b19 ==============================
[0m17:54:14.169048 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:54:14.170240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:54:14.438463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a02fec-ce83-454d-bd50-5643688b7b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11463a7a0>]}
[0m17:54:14.562849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a02fec-ce83-454d-bd50-5643688b7b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145af3d0>]}
[0m17:54:14.564328 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:54:14.617856 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:54:14.723562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:14.724531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:14.726177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:54:14.735649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a02fec-ce83-454d-bd50-5643688b7b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153a17b0>]}
[0m17:54:14.815162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a02fec-ce83-454d-bd50-5643688b7b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115035000>]}
[0m17:54:14.816548 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m17:54:14.817809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a02fec-ce83-454d-bd50-5643688b7b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115036890>]}
[0m17:54:14.821102 [info ] [MainThread]: 
[0m17:54:14.822609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:14.825122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m17:54:14.841897 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:54:14.842824 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:54:14.843688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:14.877911 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:54:14.878871 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:54:14.879761 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:54:14.887125 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:54:14.889760 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:54:14.890978 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:54:14.903651 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:14.904562 [debug] [MainThread]: On master: BEGIN
[0m17:54:14.905371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:14.911445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:14.912334 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:14.913234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:14.958096 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m17:54:14.961588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a02fec-ce83-454d-bd50-5643688b7b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150367d0>]}
[0m17:54:14.962547 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:14.963627 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:14.964471 [debug] [MainThread]: On master: BEGIN
[0m17:54:14.965486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:14.966330 [debug] [MainThread]: On master: COMMIT
[0m17:54:14.967161 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:14.967979 [debug] [MainThread]: On master: COMMIT
[0m17:54:14.968895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:54:14.969726 [debug] [MainThread]: On master: Close
[0m17:54:14.971168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:14.972234 [info ] [MainThread]: 
[0m17:54:14.974836 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:54:14.975794 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m17:54:14.977247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m17:54:14.978296 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:54:15.007670 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:54:15.009175 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 17:54:14.979328 => 17:54:15.008699
[0m17:54:15.010101 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:54:15.037250 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:54:15.038763 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:54:15.039800 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m17:54:15.040701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.047368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:15.048995 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:54:15.050016 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m17:54:15.053884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:15.057100 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 17:54:15.010761 => 17:54:15.056594
[0m17:54:15.058274 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m17:54:15.059436 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m17:54:15.060953 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.08s]
[0m17:54:15.062372 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:54:15.063461 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:54:15.064470 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m17:54:15.065822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m17:54:15.066987 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:54:15.079737 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:54:15.081476 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 17:54:15.067589 => 17:54:15.080797
[0m17:54:15.083028 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:54:15.087742 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:54:15.089060 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:54:15.090287 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m17:54:15.091298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.098457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:15.099647 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:54:15.101052 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m17:54:15.104069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:15.106697 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 17:54:15.084091 => 17:54:15.106116
[0m17:54:15.107829 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m17:54:15.108951 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m17:54:15.110522 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.04s]
[0m17:54:15.111887 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:54:15.112867 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m17:54:15.113961 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m17:54:15.115423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m17:54:15.116502 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m17:54:15.124007 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m17:54:15.125826 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 17:54:15.117187 => 17:54:15.125341
[0m17:54:15.126729 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m17:54:15.131138 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m17:54:15.132950 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:54:15.134308 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m17:54:15.135201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.141932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:15.142914 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:54:15.143823 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m17:54:15.808533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m17:54:15.811216 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 17:54:15.127318 => 17:54:15.810723
[0m17:54:15.812230 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m17:54:15.813469 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m17:54:15.815743 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.70s]
[0m17:54:15.817150 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m17:54:15.818145 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:54:15.819305 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m17:54:15.821081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m17:54:15.822316 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:54:15.834165 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:54:15.843106 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 17:54:15.822990 => 17:54:15.842572
[0m17:54:15.844064 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:54:15.851528 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:54:15.853274 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:54:15.855203 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m17:54:15.856147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.865586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:15.866622 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:54:15.867712 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m17:54:15.870869 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:15.873277 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 17:54:15.844663 => 17:54:15.872797
[0m17:54:15.874435 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m17:54:15.875617 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m17:54:15.877370 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.06s]
[0m17:54:15.878851 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:54:15.879869 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:54:15.881056 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m17:54:15.882521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m17:54:15.883947 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:54:15.895461 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:54:15.897130 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 17:54:15.884649 => 17:54:15.896638
[0m17:54:15.898406 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:54:15.904215 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:54:15.905985 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:54:15.906942 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m17:54:15.907931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.915162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:15.916867 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:54:15.917877 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m17:54:15.922432 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:15.924780 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 17:54:15.900020 => 17:54:15.924323
[0m17:54:15.925825 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m17:54:15.926945 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m17:54:15.928962 [info ] [Thread-1 (]: 5 of 6 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.05s]
[0m17:54:15.930388 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:54:15.931366 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:54:15.932288 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m17:54:15.933795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m17:54:15.934845 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:54:15.946835 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:54:15.948533 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 17:54:15.935886 => 17:54:15.947875
[0m17:54:15.949758 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:54:15.954844 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:54:15.956165 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:54:15.957080 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m17:54:15.958005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:15.965737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:15.967037 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:54:15.968131 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m17:54:15.973447 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:15.975805 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 17:54:15.950483 => 17:54:15.975345
[0m17:54:15.976729 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m17:54:15.978408 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m17:54:15.981204 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.05s]
[0m17:54:15.983499 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:54:15.986833 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:15.988298 [debug] [MainThread]: On master: BEGIN
[0m17:54:15.989478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:16.001001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:16.002918 [debug] [MainThread]: On master: COMMIT
[0m17:54:16.004449 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:16.005985 [debug] [MainThread]: On master: COMMIT
[0m17:54:16.007705 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:54:16.009262 [debug] [MainThread]: On master: Close
[0m17:54:16.011444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:16.013062 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m17:54:16.014664 [info ] [MainThread]: 
[0m17:54:16.015731 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m17:54:16.018740 [debug] [MainThread]: Command end result
[0m17:54:16.045451 [info ] [MainThread]: 
[0m17:54:16.046670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:16.047621 [info ] [MainThread]: 
[0m17:54:16.048768 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m17:54:16.049889 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m17:54:16.051355 [info ] [MainThread]: 
[0m17:54:16.052590 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m17:54:16.053698 [info ] [MainThread]: 
[0m17:54:16.055038 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:54:16.057575 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.9686667, "process_user_time": 3.683387, "process_kernel_time": 0.318248, "process_mem_max_rss": "112123904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:54:16.058795 [debug] [MainThread]: Command `dbt test` failed at 17:54:16.058482 after 1.97 seconds
[0m17:54:16.059725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112099660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115553130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115551900>]}
[0m17:54:16.061033 [debug] [MainThread]: Flushing usage events
[0m17:54:39.937817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f35660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ce8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ce560>]}


============================== 17:54:39.943192 | 4a0daf63-9d85-4056-afce-aca8f99ffd38 ==============================
[0m17:54:39.943192 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:54:39.944356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test -s stg_contoso_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:40.210629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0daf63-9d85-4056-afce-aca8f99ffd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ce7d0>]}
[0m17:54:40.334353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0daf63-9d85-4056-afce-aca8f99ffd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784dd80>]}
[0m17:54:40.335898 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:54:40.388519 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:54:40.495027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:40.496006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:40.497649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:54:40.508921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a0daf63-9d85-4056-afce-aca8f99ffd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082397e0>]}
[0m17:54:40.588224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a0daf63-9d85-4056-afce-aca8f99ffd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec9990>]}
[0m17:54:40.589690 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m17:54:40.590686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0daf63-9d85-4056-afce-aca8f99ffd38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecbeb0>]}
[0m17:54:40.592022 [warn ] [MainThread]: The selection criterion 'stg_contoso_sales' does not match any nodes
[0m17:54:40.594014 [info ] [MainThread]: 
[0m17:54:40.595236 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:54:40.596336 [debug] [MainThread]: Command end result
[0m17:54:40.619664 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7567798, "process_user_time": 3.32751, "process_kernel_time": 0.279937, "process_mem_max_rss": "107794432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:54:40.621871 [debug] [MainThread]: Command `dbt test` succeeded at 17:54:40.621231 after 0.76 seconds
[0m17:54:40.624635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f35660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079002e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ced10>]}
[0m17:54:40.626419 [debug] [MainThread]: Flushing usage events
[0m17:56:35.491691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e146890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e146530>]}


============================== 17:56:35.496936 | 04c56fd3-579f-4900-b4cd-6540da6603ec ==============================
[0m17:56:35.496936 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:56:35.498126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:56:35.760741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04c56fd3-579f-4900-b4cd-6540da6603ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1467a0>]}
[0m17:56:35.882045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04c56fd3-579f-4900-b4cd-6540da6603ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0bb3d0>]}
[0m17:56:35.883519 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:56:35.936163 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:56:36.045566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:36.046511 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:36.048377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:56:36.058856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04c56fd3-579f-4900-b4cd-6540da6603ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eead7b0>]}
[0m17:56:36.137259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04c56fd3-579f-4900-b4cd-6540da6603ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb41000>]}
[0m17:56:36.138318 [info ] [MainThread]: Found 10 models, 6 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m17:56:36.139258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c56fd3-579f-4900-b4cd-6540da6603ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb42890>]}
[0m17:56:36.141947 [info ] [MainThread]: 
[0m17:56:36.143718 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:56:36.146491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m17:56:36.165295 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:56:36.166293 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:56:36.167185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:36.202791 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:56:36.203766 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:56:36.204627 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:56:36.211801 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:56:36.214533 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:56:36.216205 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:56:36.229678 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.230972 [debug] [MainThread]: On master: BEGIN
[0m17:56:36.232045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:36.238848 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:36.240001 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.240930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:56:36.289513 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m17:56:36.293052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04c56fd3-579f-4900-b4cd-6540da6603ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb427d0>]}
[0m17:56:36.294356 [debug] [MainThread]: On master: ROLLBACK
[0m17:56:36.295677 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.296552 [debug] [MainThread]: On master: BEGIN
[0m17:56:36.297590 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:36.298445 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.299292 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.300106 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.301123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:36.302782 [debug] [MainThread]: On master: Close
[0m17:56:36.304230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:36.305303 [info ] [MainThread]: 
[0m17:56:36.307996 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:56:36.308985 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m17:56:36.311099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m17:56:36.312199 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:56:36.344017 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:56:36.345558 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 17:56:36.312804 => 17:56:36.345075
[0m17:56:36.346675 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:56:36.371666 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:56:36.373299 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:56:36.374714 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m17:56:36.375813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:36.382480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:36.383526 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:56:36.384773 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m17:56:36.388598 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:56:36.392241 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 17:56:36.347297 => 17:56:36.391726
[0m17:56:36.393280 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m17:56:36.394376 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m17:56:36.395963 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.09s]
[0m17:56:36.397958 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:56:36.399052 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:56:36.400016 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m17:56:36.401594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m17:56:36.402705 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:56:36.413136 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:56:36.414819 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 17:56:36.403381 => 17:56:36.414331
[0m17:56:36.415767 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:56:36.419920 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:56:36.422177 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:56:36.423382 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m17:56:36.424508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:36.434696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:36.435944 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:56:36.437817 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m17:56:36.441000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:56:36.443788 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 17:56:36.416365 => 17:56:36.443276
[0m17:56:36.444804 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m17:56:36.446440 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m17:56:36.448118 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.05s]
[0m17:56:36.449465 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:56:36.451548 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m17:56:36.452852 [info ] [Thread-1 (]: 3 of 6 START test sales_low_profit_check ....................................... [RUN]
[0m17:56:36.455241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m17:56:36.456692 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m17:56:36.463531 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m17:56:36.464970 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 17:56:36.457443 => 17:56:36.464513
[0m17:56:36.465881 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m17:56:36.472161 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m17:56:36.473728 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:56:36.475141 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m17:56:36.476268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:36.487692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:36.488945 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:56:36.489873 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m17:56:37.243975 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m17:56:37.246383 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 17:56:36.466603 => 17:56:37.245931
[0m17:56:37.247312 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m17:56:37.248504 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m17:56:37.250294 [error] [Thread-1 (]: 3 of 6 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.80s]
[0m17:56:37.251885 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m17:56:37.252924 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:56:37.253872 [info ] [Thread-1 (]: 4 of 6 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m17:56:37.255275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m17:56:37.257365 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:56:37.265012 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:56:37.266464 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 17:56:37.258107 => 17:56:37.266005
[0m17:56:37.267529 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:56:37.276394 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:56:37.278435 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:56:37.279399 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m17:56:37.280492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:37.290521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:37.291507 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:56:37.292425 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m17:56:37.295475 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:56:37.297974 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 17:56:37.268945 => 17:56:37.297506
[0m17:56:37.298922 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m17:56:37.300060 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m17:56:37.304886 [info ] [Thread-1 (]: 4 of 6 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.05s]
[0m17:56:37.306427 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:56:37.307783 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:56:37.308985 [info ] [Thread-1 (]: 5 of 6 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m17:56:37.310362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m17:56:37.311636 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:56:37.322467 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:56:37.324594 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 17:56:37.312738 => 17:56:37.323908
[0m17:56:37.325993 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:56:37.331163 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:56:37.332539 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:56:37.333557 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m17:56:37.334653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:37.344924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:37.346150 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:56:37.347074 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m17:56:37.352828 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:56:37.355905 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 17:56:37.327028 => 17:56:37.355280
[0m17:56:37.356902 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m17:56:37.358427 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m17:56:37.360494 [info ] [Thread-1 (]: 5 of 6 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.05s]
[0m17:56:37.361838 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:56:37.362835 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:56:37.363757 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m17:56:37.365071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m17:56:37.365998 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:56:37.377463 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:56:37.378925 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 17:56:37.366889 => 17:56:37.378470
[0m17:56:37.379833 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:56:37.384424 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:56:37.386158 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:56:37.387154 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m17:56:37.388629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:37.405296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:37.407073 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:56:37.409050 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m17:56:37.419716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:56:37.424880 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 17:56:37.380419 => 17:56:37.423801
[0m17:56:37.426989 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m17:56:37.429129 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m17:56:37.431670 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.07s]
[0m17:56:37.437178 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:56:37.475505 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:37.477113 [debug] [MainThread]: On master: BEGIN
[0m17:56:37.478648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:37.487753 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:37.488904 [debug] [MainThread]: On master: COMMIT
[0m17:56:37.490138 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:37.491023 [debug] [MainThread]: On master: COMMIT
[0m17:56:37.492272 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:37.493992 [debug] [MainThread]: On master: Close
[0m17:56:37.496359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:37.497852 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m17:56:37.499600 [info ] [MainThread]: 
[0m17:56:37.501068 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m17:56:37.504395 [debug] [MainThread]: Command end result
[0m17:56:37.551966 [info ] [MainThread]: 
[0m17:56:37.554922 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:37.555967 [info ] [MainThread]: 
[0m17:56:37.556987 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m17:56:37.558274 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m17:56:37.560655 [info ] [MainThread]: 
[0m17:56:37.571047 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m17:56:37.572447 [info ] [MainThread]: 
[0m17:56:37.574937 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:56:37.579027 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.1676676, "process_user_time": 3.854144, "process_kernel_time": 0.350639, "process_mem_max_rss": "111747072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:56:37.580401 [debug] [MainThread]: Command `dbt test` failed at 17:56:37.579944 after 2.17 seconds
[0m17:56:37.581409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e578640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0583a0>]}
[0m17:56:37.582327 [debug] [MainThread]: Flushing usage events
[0m17:58:12.513935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108095b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a636860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a636500>]}


============================== 17:58:12.519217 | 4fc749a9-9af4-45dd-ab7b-c779ef11dd7f ==============================
[0m17:58:12.519217 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:58:12.520658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:12.789282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fc749a9-9af4-45dd-ab7b-c779ef11dd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a636770>]}
[0m17:58:12.909726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fc749a9-9af4-45dd-ab7b-c779ef11dd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9ad1e0>]}
[0m17:58:12.911214 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m17:58:12.967242 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:58:13.067470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:58:13.068872 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/test_config.yml
[0m17:58:13.366381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m17:58:13.375130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fc749a9-9af4-45dd-ab7b-c779ef11dd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c5960>]}
[0m17:58:13.401753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fc749a9-9af4-45dd-ab7b-c779ef11dd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b193850>]}
[0m17:58:13.402908 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m17:58:13.404011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc749a9-9af4-45dd-ab7b-c779ef11dd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b193910>]}
[0m17:58:13.407681 [info ] [MainThread]: 
[0m17:58:13.409411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:58:13.412566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb_dbt_schema'
[0m17:58:13.431623 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:58:13.432554 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m17:58:13.433356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:13.467196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:13.468134 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m17:58:13.469001 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m17:58:13.476156 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:13.478633 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m17:58:13.479712 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m17:58:13.491702 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:13.492721 [debug] [MainThread]: On master: BEGIN
[0m17:58:13.493539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:13.499888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:13.500780 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:13.501686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:13.546284 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:13.549780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc749a9-9af4-45dd-ab7b-c779ef11dd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1922f0>]}
[0m17:58:13.550742 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:13.551722 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:13.552539 [debug] [MainThread]: On master: BEGIN
[0m17:58:13.553577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:13.554401 [debug] [MainThread]: On master: COMMIT
[0m17:58:13.555222 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:13.556026 [debug] [MainThread]: On master: COMMIT
[0m17:58:13.556940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:13.557770 [debug] [MainThread]: On master: Close
[0m17:58:13.559052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:13.560083 [info ] [MainThread]: 
[0m17:58:13.562668 [debug] [Thread-1 (]: Began running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:58:13.563643 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [RUN]
[0m17:58:13.565123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145)
[0m17:58:13.566160 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:58:13.588767 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:58:13.590926 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (compile): 17:58:13.566808 => 17:58:13.590160
[0m17:58:13.591918 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:58:13.615906 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:58:13.617340 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:58:13.618260 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: BEGIN
[0m17:58:13.619144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:13.625849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:13.626838 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"
[0m17:58:13.627839 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        channelname as value_field,
        count(*) as n_records

    from "contosodb"."dbt_schema"."stg_contoso__channels"
    group by channelname

)

select *
from all_values
where value_field not in (
    'Store','Online','Catalog','Reseller'
)



      
    ) dbt_internal_test
[0m17:58:13.631716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:13.634704 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145 (execute): 17:58:13.592505 => 17:58:13.634233
[0m17:58:13.635648 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: ROLLBACK
[0m17:58:13.636772 [debug] [Thread-1 (]: On test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145: Close
[0m17:58:13.638317 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller  [[32mPASS[0m in 0.07s]
[0m17:58:13.639733 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145
[0m17:58:13.640818 [debug] [Thread-1 (]: Began running node test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257
[0m17:58:13.641748 [info ] [Thread-1 (]: 2 of 7 START test dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_  [RUN]
[0m17:58:13.643085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.accepted_values_stg_contoso__channels_channelname__Store__Online__Catalog__Reseller.d5e084c145, now test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257)
[0m17:58:13.644164 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257
[0m17:58:13.652657 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257"
[0m17:58:13.654118 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257 (compile): 17:58:13.644924 => 17:58:13.653654
[0m17:58:13.655153 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257
[0m17:58:13.660606 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257"
[0m17:58:13.662473 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257"
[0m17:58:13.663424 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257: BEGIN
[0m17:58:13.664300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:13.671169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:13.672417 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257"
[0m17:58:13.673775 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        "contosodb"."dbt_schema"."stg_contoso__sales"
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        "contosodb"."dbt_schema"."sales"
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m17:58:17.493266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 4.0 seconds
[0m17:58:17.496417 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257 (execute): 17:58:13.655809 => 17:58:17.495451
[0m17:58:17.497598 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257: ROLLBACK
[0m17:58:17.498868 [debug] [Thread-1 (]: On test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257: Close
[0m17:58:17.501006 [error] [Thread-1 (]: 2 of 7 FAIL 1 dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_  [[31mFAIL 1[0m in 3.86s]
[0m17:58:17.502399 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257
[0m17:58:17.503513 [debug] [Thread-1 (]: Began running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:58:17.504940 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_contoso__products_productkey .................... [RUN]
[0m17:58:17.506372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_.f1bd21e257, now test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8)
[0m17:58:17.507376 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:58:17.524333 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:58:17.525958 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (compile): 17:58:17.508169 => 17:58:17.525401
[0m17:58:17.527274 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:58:17.532468 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:58:17.533938 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:58:17.534924 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: BEGIN
[0m17:58:17.536394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:17.545417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:17.546789 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"
[0m17:58:17.547734 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is null



      
    ) dbt_internal_test
[0m17:58:17.550675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:17.553566 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8 (execute): 17:58:17.528226 => 17:58:17.553054
[0m17:58:17.554552 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: ROLLBACK
[0m17:58:17.555660 [debug] [Thread-1 (]: On test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8: Close
[0m17:58:17.557254 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_contoso__products_productkey .......................... [[32mPASS[0m in 0.05s]
[0m17:58:17.558647 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8
[0m17:58:17.559734 [debug] [Thread-1 (]: Began running node test.postgres_dbt.sales_low_profit_check
[0m17:58:17.560664 [info ] [Thread-1 (]: 4 of 7 START test sales_low_profit_check ....................................... [RUN]
[0m17:58:17.562104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.not_null_stg_contoso__products_productkey.29281a42a8, now test.postgres_dbt.sales_low_profit_check)
[0m17:58:17.563364 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.sales_low_profit_check
[0m17:58:17.572893 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.sales_low_profit_check"
[0m17:58:17.575181 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (compile): 17:58:17.564113 => 17:58:17.574338
[0m17:58:17.576181 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.sales_low_profit_check
[0m17:58:17.580529 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.sales_low_profit_check"
[0m17:58:17.582144 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:58:17.583219 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: BEGIN
[0m17:58:17.584383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:17.592762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:17.593750 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.sales_low_profit_check"
[0m17:58:17.594648 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.sales_low_profit_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT 
saleskey
FROM "contosodb"."dbt_schema"."stg_contoso__sales"
WHERE ((salesamount - totalcost) / salesamount) < 0.15
      
    ) dbt_internal_test
[0m17:58:18.260746 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.0 seconds
[0m17:58:18.263160 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.sales_low_profit_check (execute): 17:58:17.576763 => 17:58:18.262713
[0m17:58:18.264070 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: ROLLBACK
[0m17:58:18.265233 [debug] [Thread-1 (]: On test.postgres_dbt.sales_low_profit_check: Close
[0m17:58:18.266674 [error] [Thread-1 (]: 4 of 7 FAIL 81 sales_low_profit_check .......................................... [[31mFAIL 81[0m in 0.70s]
[0m17:58:18.268569 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.sales_low_profit_check
[0m17:58:18.269571 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:58:18.270502 [info ] [Thread-1 (]: 5 of 7 START test string_not_empty_stg_contoso__channels_channelname ........... [RUN]
[0m17:58:18.271899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.sales_low_profit_check, now test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf)
[0m17:58:18.272984 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:58:18.283182 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:58:18.284658 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (compile): 17:58:18.273675 => 17:58:18.284194
[0m17:58:18.285560 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:58:18.292305 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:58:18.293676 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:58:18.294584 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: BEGIN
[0m17:58:18.295558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:18.303067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:18.304050 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"
[0m17:58:18.305003 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT channelname
    FROM "contosodb"."dbt_schema"."stg_contoso__channels"
    WHERE TRIM(channelname) = ''

      
    ) dbt_internal_test
[0m17:58:18.308847 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:18.311190 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf (execute): 17:58:18.286142 => 17:58:18.310739
[0m17:58:18.312114 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: ROLLBACK
[0m17:58:18.313225 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf: Close
[0m17:58:18.315179 [info ] [Thread-1 (]: 5 of 7 PASS string_not_empty_stg_contoso__channels_channelname ................. [[32mPASS[0m in 0.04s]
[0m17:58:18.316635 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf
[0m17:58:18.317680 [debug] [Thread-1 (]: Began running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:58:18.318602 [info ] [Thread-1 (]: 6 of 7 START test string_not_empty_stg_contoso__products_productname ........... [RUN]
[0m17:58:18.319896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__channels_channelname.b4b2b54cdf, now test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed)
[0m17:58:18.321244 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:58:18.329918 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:58:18.331687 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (compile): 17:58:18.321933 => 17:58:18.330926
[0m17:58:18.332679 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:58:18.337298 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:58:18.339018 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:58:18.340155 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: BEGIN
[0m17:58:18.341250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:18.348519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:18.349479 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"
[0m17:58:18.350485 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT productname
    FROM "contosodb"."dbt_schema"."stg_contoso__products"
    WHERE TRIM(productname) = ''

      
    ) dbt_internal_test
[0m17:58:18.354966 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:18.357789 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed (execute): 17:58:18.333380 => 17:58:18.357274
[0m17:58:18.359171 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: ROLLBACK
[0m17:58:18.360324 [debug] [Thread-1 (]: On test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed: Close
[0m17:58:18.361840 [info ] [Thread-1 (]: 6 of 7 PASS string_not_empty_stg_contoso__products_productname ................. [[32mPASS[0m in 0.04s]
[0m17:58:18.363381 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed
[0m17:58:18.364369 [debug] [Thread-1 (]: Began running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:58:18.365279 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_contoso__products_productkey ...................... [RUN]
[0m17:58:18.366908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dbt.string_not_empty_stg_contoso__products_productname.6de171b7ed, now test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802)
[0m17:58:18.367997 [debug] [Thread-1 (]: Began compiling node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:58:18.380657 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:58:18.382141 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (compile): 17:58:18.369071 => 17:58:18.381675
[0m17:58:18.383121 [debug] [Thread-1 (]: Began executing node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:58:18.389946 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:58:18.391337 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:58:18.392249 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: BEGIN
[0m17:58:18.393276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:18.404608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:18.406375 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"
[0m17:58:18.407350 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from "contosodb"."dbt_schema"."stg_contoso__products"
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m17:58:18.413014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:18.415485 [debug] [Thread-1 (]: Timing info for test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802 (execute): 17:58:18.383780 => 17:58:18.414998
[0m17:58:18.416646 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: ROLLBACK
[0m17:58:18.418622 [debug] [Thread-1 (]: On test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802: Close
[0m17:58:18.421119 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_contoso__products_productkey ............................ [[32mPASS[0m in 0.05s]
[0m17:58:18.422642 [debug] [Thread-1 (]: Finished running node test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802
[0m17:58:18.425013 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:18.426082 [debug] [MainThread]: On master: BEGIN
[0m17:58:18.427015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:18.441228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:18.442563 [debug] [MainThread]: On master: COMMIT
[0m17:58:18.443639 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:18.444829 [debug] [MainThread]: On master: COMMIT
[0m17:58:18.445923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:18.446828 [debug] [MainThread]: On master: Close
[0m17:58:18.448425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:18.449301 [debug] [MainThread]: Connection 'test.postgres_dbt.unique_stg_contoso__products_productkey.82fb952802' was properly closed.
[0m17:58:18.450435 [info ] [MainThread]: 
[0m17:58:18.452157 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m17:58:18.455602 [debug] [MainThread]: Command end result
[0m17:58:18.478668 [info ] [MainThread]: 
[0m17:58:18.479677 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:58:18.481418 [info ] [MainThread]: 
[0m17:58:18.483181 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_table_row_count_to_equal_other_table_stg_contoso__sales_ref_sales_ (models/test_config.yml)[0m
[0m17:58:18.484227 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:58:18.485690 [info ] [MainThread]: 
[0m17:58:18.487052 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/models/test_config.yml/dbt_expectations_expect_table__d98012d63a78662094a3e1478dcb446c.sql
[0m17:58:18.488592 [info ] [MainThread]: 
[0m17:58:18.489656 [error] [MainThread]: [31mFailure in test sales_low_profit_check (tests/sales_low_profit_check.sql)[0m
[0m17:58:18.490858 [error] [MainThread]:   Got 81 results, configured to fail if != 0
[0m17:58:18.492370 [info ] [MainThread]: 
[0m17:58:18.493470 [info ] [MainThread]:   compiled Code at target/compiled/postgres_dbt/tests/sales_low_profit_check.sql
[0m17:58:18.495200 [info ] [MainThread]: 
[0m17:58:18.496891 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m17:58:18.500871 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.062543, "process_user_time": 3.932865, "process_kernel_time": 0.293941, "process_mem_max_rss": "115499008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:58:18.503592 [debug] [MainThread]: Command `dbt test` failed at 17:58:18.502861 after 6.07 seconds
[0m17:58:18.504918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108095b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b619060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b618e80>]}
[0m17:58:18.506466 [debug] [MainThread]: Flushing usage events
[0m19:27:05.471135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9628f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d962590>]}


============================== 19:27:05.480368 | 098ae845-f08f-4d33-8771-9fbef58f0142 ==============================
[0m19:27:05.480368 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:27:05.482174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m sales.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:06.279655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d962800>]}
[0m19:27:06.403564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d7640>]}
[0m19:27:06.407159 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:27:06.470120 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:27:06.814334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:06.815647 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/marts/sales.sql
[0m19:27:07.064684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:27:07.074770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7d13c0>]}
[0m19:27:07.104157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4b38e0>]}
[0m19:27:07.105385 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m19:27:07.106506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4b39a0>]}
[0m19:27:07.111197 [info ] [MainThread]: 
[0m19:27:07.113104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:07.115274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:27:07.132800 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:27:07.133772 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:27:07.134604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:07.199427 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:27:07.201641 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:27:07.205053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:27:07.213999 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:27:07.214995 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:27:07.215812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:07.223905 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:07.225072 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:27:07.226066 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:27:07.235644 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m19:27:07.238133 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:27:07.239262 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:27:07.251866 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.252839 [debug] [MainThread]: On master: BEGIN
[0m19:27:07.253658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:07.259946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:07.260863 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.261789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:07.313751 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:27:07.317219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e83fb80>]}
[0m19:27:07.318181 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:07.319172 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.319998 [debug] [MainThread]: On master: BEGIN
[0m19:27:07.321046 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:07.321880 [debug] [MainThread]: On master: COMMIT
[0m19:27:07.322707 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.323515 [debug] [MainThread]: On master: COMMIT
[0m19:27:07.324466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:07.325302 [debug] [MainThread]: On master: Close
[0m19:27:07.326647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:07.327757 [info ] [MainThread]: 
[0m19:27:07.331611 [debug] [Thread-1 (]: Began running node model.postgres_dbt.sales
[0m19:27:07.332862 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_schema.sales .................................. [RUN]
[0m19:27:07.334584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.sales)
[0m19:27:07.335688 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.sales
[0m19:27:07.353783 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.sales"
[0m19:27:07.356395 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (compile): 19:27:07.336386 => 19:27:07.355652
[0m19:27:07.357601 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.sales
[0m19:27:07.420836 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.sales"
[0m19:27:07.422336 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m19:27:07.423278 [debug] [Thread-1 (]: On model.postgres_dbt.sales: BEGIN
[0m19:27:07.424150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:07.430732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:07.431735 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.sales"
[0m19:27:07.432653 [debug] [Thread-1 (]: On model.postgres_dbt.sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.sales"} */

  
    

  create  table "contosodb"."dbt_schema"."sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
scp.productname,
st.storename,
scc.channelname,
s.unitcost,
s.unitprice,
s.salesquantity,
s.discountamount,
s.totalcost,
s.salesamount,
s.profit,
s.datekey
FROM "contosodb"."dbt_schema"."stg_contoso__sales" s
JOIN "contosodb"."dbt_schema"."int_contoso__stores" st
ON s.storekey = st.storekey 
JOIN "contosodb"."dbt_schema"."stg_contoso__products" scp 
ON scp.productkey = s.productkey 
JOIN "contosodb"."dbt_schema"."stg_contoso__channels" scc 
ON s.channelkey = scc.channelkey 
WHERE st.storestatus = 'Active'
ORDER BY s.salesamount DESC
  );
  
[0m19:27:07.436772 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.datekey does not exist
LINE 25: s.datekey
         ^
HINT:  Perhaps you meant to reference the column "s.saleskey".

[0m19:27:07.437870 [debug] [Thread-1 (]: On model.postgres_dbt.sales: ROLLBACK
[0m19:27:07.439407 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.sales (execute): 19:27:07.358431 => 19:27:07.438901
[0m19:27:07.440355 [debug] [Thread-1 (]: On model.postgres_dbt.sales: Close
[0m19:27:07.488085 [debug] [Thread-1 (]: Database Error in model sales (models/marts/sales.sql)
  column s.datekey does not exist
  LINE 25: s.datekey
           ^
  HINT:  Perhaps you meant to reference the column "s.saleskey".
  compiled Code at target/run/postgres_dbt/models/marts/sales.sql
[0m19:27:07.489917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '098ae845-f08f-4d33-8771-9fbef58f0142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e83d090>]}
[0m19:27:07.491587 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_schema.sales ......................... [[31mERROR[0m in 0.16s]
[0m19:27:07.493389 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.sales
[0m19:27:07.496372 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.497474 [debug] [MainThread]: On master: BEGIN
[0m19:27:07.498414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:07.506023 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:07.507017 [debug] [MainThread]: On master: COMMIT
[0m19:27:07.508023 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:07.508886 [debug] [MainThread]: On master: COMMIT
[0m19:27:07.510307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:07.511322 [debug] [MainThread]: On master: Close
[0m19:27:07.514345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:07.516118 [debug] [MainThread]: Connection 'model.postgres_dbt.sales' was properly closed.
[0m19:27:07.518113 [info ] [MainThread]: 
[0m19:27:07.519264 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m19:27:07.521145 [debug] [MainThread]: Command end result
[0m19:27:07.542371 [info ] [MainThread]: 
[0m19:27:07.543543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:27:07.544738 [info ] [MainThread]: 
[0m19:27:07.549011 [error] [MainThread]:   Database Error in model sales (models/marts/sales.sql)
  column s.datekey does not exist
  LINE 25: s.datekey
           ^
  HINT:  Perhaps you meant to reference the column "s.saleskey".
  compiled Code at target/run/postgres_dbt/models/marts/sales.sql
[0m19:27:07.551250 [info ] [MainThread]: 
[0m19:27:07.552290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:27:07.556667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2067113, "process_user_time": 4.395736, "process_kernel_time": 0.779984, "process_mem_max_rss": "115404800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:27:07.558602 [debug] [MainThread]: Command `dbt run` failed at 19:27:07.558205 after 2.21 seconds
[0m19:27:07.560123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e861c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e863400>]}
[0m19:27:07.561193 [debug] [MainThread]: Flushing usage events
[0m19:27:55.903903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c459660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99a500>]}


============================== 19:27:55.909130 | 51e7091d-d6b4-46e2-9f4b-f07adccf2e58 ==============================
[0m19:27:55.909130 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:27:55.910328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_contoso__sales.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:56.173325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99a770>]}
[0m19:27:56.293887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed191e0>]}
[0m19:27:56.295290 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:27:56.343771 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:27:56.450583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:56.451936 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m19:27:56.911163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:27:56.922373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa800d0>]}
[0m19:27:56.949465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa278b0>]}
[0m19:27:56.950527 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m19:27:56.951465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa27820>]}
[0m19:27:56.953950 [info ] [MainThread]: 
[0m19:27:56.955611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:56.957376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:27:56.973018 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:27:56.974153 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:27:56.975100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:57.016809 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:27:57.019200 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:27:57.022882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:27:57.032888 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:27:57.034063 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:27:57.035085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:57.041741 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.042657 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:27:57.043510 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:27:57.049486 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m19:27:57.051644 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:27:57.052651 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:27:57.064292 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.065212 [debug] [MainThread]: On master: BEGIN
[0m19:27:57.066030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:57.072338 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.073279 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.074328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:57.116615 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:27:57.120162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f766740>]}
[0m19:27:57.121163 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:57.122198 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.123035 [debug] [MainThread]: On master: BEGIN
[0m19:27:57.124120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.124975 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.125939 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.126778 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.127731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:57.128587 [debug] [MainThread]: On master: Close
[0m19:27:57.130108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:57.131359 [info ] [MainThread]: 
[0m19:27:57.133942 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m19:27:57.135037 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m19:27:57.136360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.stg_contoso__sales)
[0m19:27:57.137422 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m19:27:57.151577 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m19:27:57.155086 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 19:27:57.138262 => 19:27:57.154325
[0m19:27:57.156302 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m19:27:57.210239 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m19:27:57.211697 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:27:57.212623 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m19:27:57.213502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:57.220042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.221042 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:27:57.221954 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) as PROFIT,
SALESKEY
FROM PUBLIC.FCTSALES
  );
[0m19:27:57.225560 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saleskey" specified more than once

[0m19:27:57.226787 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: ROLLBACK
[0m19:27:57.228496 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 19:27:57.157349 => 19:27:57.227967
[0m19:27:57.229547 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m19:27:57.233132 [debug] [Thread-1 (]: Database Error in model stg_contoso__sales (models/staging/stg_contoso__sales.sql)
  column "saleskey" specified more than once
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__sales.sql
[0m19:27:57.234224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7091d-d6b4-46e2-9f4b-f07adccf2e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa647f0>]}
[0m19:27:57.235390 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_schema.stg_contoso__sales ............. [[31mERROR[0m in 0.10s]
[0m19:27:57.236703 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m19:27:57.238796 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.239685 [debug] [MainThread]: On master: BEGIN
[0m19:27:57.240498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:57.249810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:57.252620 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.253544 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:57.254381 [debug] [MainThread]: On master: COMMIT
[0m19:27:57.255419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:57.256555 [debug] [MainThread]: On master: Close
[0m19:27:57.259163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:57.260123 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m19:27:57.260992 [info ] [MainThread]: 
[0m19:27:57.261992 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m19:27:57.263332 [debug] [MainThread]: Command end result
[0m19:27:57.285263 [info ] [MainThread]: 
[0m19:27:57.286386 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:27:57.287318 [info ] [MainThread]: 
[0m19:27:57.288340 [error] [MainThread]:   Database Error in model stg_contoso__sales (models/staging/stg_contoso__sales.sql)
  column "saleskey" specified more than once
  compiled Code at target/run/postgres_dbt/models/staging/stg_contoso__sales.sql
[0m19:27:57.289837 [info ] [MainThread]: 
[0m19:27:57.291505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:27:57.294267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4629971, "process_user_time": 3.842659, "process_kernel_time": 0.286697, "process_mem_max_rss": "118800384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:27:57.296303 [debug] [MainThread]: Command `dbt run` failed at 19:27:57.295767 after 1.46 seconds
[0m19:27:57.298497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c459660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa64130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa64a30>]}
[0m19:27:57.299819 [debug] [MainThread]: Flushing usage events
[0m19:28:45.132286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105021b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562530>]}


============================== 19:28:45.137558 | 1aeaae1a-e1b7-419b-9464-9df87920e7f1 ==============================
[0m19:28:45.137558 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:28:45.138760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_contoso__sales.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:45.403332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075627a0>]}
[0m19:28:45.527018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074db3d0>]}
[0m19:28:45.528627 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:28:45.579617 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:28:45.682957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:45.684311 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m19:28:46.143661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:28:46.153739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086540d0>]}
[0m19:28:46.180856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085eb910>]}
[0m19:28:46.181913 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m19:28:46.182968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085eb8e0>]}
[0m19:28:46.185646 [info ] [MainThread]: 
[0m19:28:46.187255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:46.189458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:28:46.205157 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:28:46.206155 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:28:46.207598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:46.249110 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:28:46.251507 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:28:46.255093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:28:46.264950 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:28:46.265902 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:28:46.266738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:46.273150 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:28:46.274106 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:28:46.274982 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:28:46.280941 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:46.283131 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:28:46.284133 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:28:46.295997 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.296940 [debug] [MainThread]: On master: BEGIN
[0m19:28:46.297761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:46.304124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:46.305067 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.305998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:46.349112 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m19:28:46.352969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108511600>]}
[0m19:28:46.354029 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:46.355089 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.355943 [debug] [MainThread]: On master: BEGIN
[0m19:28:46.357033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:46.357896 [debug] [MainThread]: On master: COMMIT
[0m19:28:46.358787 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.359630 [debug] [MainThread]: On master: COMMIT
[0m19:28:46.360579 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:46.361440 [debug] [MainThread]: On master: Close
[0m19:28:46.362803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:46.364033 [info ] [MainThread]: 
[0m19:28:46.366710 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m19:28:46.367805 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m19:28:46.369368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.stg_contoso__sales)
[0m19:28:46.370505 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m19:28:46.385343 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.386836 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 19:28:46.371200 => 19:28:46.386353
[0m19:28:46.387780 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m19:28:46.452237 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.453945 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.454937 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m19:28:46.456098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:46.462938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:46.463951 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.465067 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) AS PROFIT
FROM PUBLIC.FCTSALES
  );
[0m19:28:46.478153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:46.488815 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.489858 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m19:28:46.493665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:46.500702 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.501820 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m19:28:46.504817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:46.527354 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m19:28:46.528396 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.529310 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m19:28:46.531570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:46.541341 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m19:28:46.547720 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:28:46.548756 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m19:28:46.552158 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:46.555064 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 19:28:46.388373 => 19:28:46.554601
[0m19:28:46.556030 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m19:28:46.557449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeaae1a-e1b7-419b-9464-9df87920e7f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d0430>]}
[0m19:28:46.558810 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.19s]
[0m19:28:46.560246 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m19:28:46.562320 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.563223 [debug] [MainThread]: On master: BEGIN
[0m19:28:46.564051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:46.573944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:46.577229 [debug] [MainThread]: On master: COMMIT
[0m19:28:46.579503 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.580385 [debug] [MainThread]: On master: COMMIT
[0m19:28:46.581414 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:46.582276 [debug] [MainThread]: On master: Close
[0m19:28:46.583838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:46.585059 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m19:28:46.586119 [info ] [MainThread]: 
[0m19:28:46.587270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:28:46.589084 [debug] [MainThread]: Command end result
[0m19:28:46.612023 [info ] [MainThread]: 
[0m19:28:46.613204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:46.614161 [info ] [MainThread]: 
[0m19:28:46.615127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:46.617264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5580124, "process_user_time": 3.910253, "process_kernel_time": 0.276027, "process_mem_max_rss": "119209984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:28:46.618679 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:46.618270 after 1.56 seconds
[0m19:28:46.619951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105021b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a9360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a9330>]}
[0m19:28:46.621059 [debug] [MainThread]: Flushing usage events
[0m19:29:27.106300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11245a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11245a500>]}


============================== 19:29:27.111571 | 8569efe8-4f8d-4fbe-b838-8af1e2501537 ==============================
[0m19:29:27.111571 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:29:27.112752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_contoso__sales.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:29:27.376790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11245a770>]}
[0m19:29:27.501177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d91e0>]}
[0m19:29:27.502663 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:29:27.555291 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:29:27.660092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:27.661448 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m19:29:28.126769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:29:28.136953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134fc0d0>]}
[0m19:29:28.162172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e78b0>]}
[0m19:29:28.163591 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m19:29:28.164961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e7820>]}
[0m19:29:28.168209 [info ] [MainThread]: 
[0m19:29:28.170048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:28.174518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:29:28.196837 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:29:28.197808 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:29:28.198669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:28.249199 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:29:28.251567 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:29:28.256279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:29:28.267250 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:29:28.268196 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:29:28.269001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:28.275731 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:29:28.276658 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:29:28.277503 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:29:28.283672 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:29:28.285817 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:29:28.286864 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:29:28.298004 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:28.299001 [debug] [MainThread]: On master: BEGIN
[0m19:29:28.299816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:28.306364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:29:28.307291 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:28.308213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:28.346553 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m19:29:28.349660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113411ff0>]}
[0m19:29:28.350697 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:28.351723 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:28.352555 [debug] [MainThread]: On master: BEGIN
[0m19:29:28.353698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:29:28.354545 [debug] [MainThread]: On master: COMMIT
[0m19:29:28.355382 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:28.356201 [debug] [MainThread]: On master: COMMIT
[0m19:29:28.357146 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:29:28.358001 [debug] [MainThread]: On master: Close
[0m19:29:28.359395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:28.360551 [info ] [MainThread]: 
[0m19:29:28.363142 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m19:29:28.364232 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_contoso__sales ...................... [RUN]
[0m19:29:28.365813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.stg_contoso__sales)
[0m19:29:28.366991 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m19:29:28.382745 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.384297 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 19:29:28.367692 => 19:29:28.383809
[0m19:29:28.385213 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m19:29:28.445626 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.447074 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.447999 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m19:29:28.448877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:28.456165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:29:28.457192 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.458331 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

  create view "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
    
    
  as (
    SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) AS PROFIT,
DATEKEY
FROM PUBLIC.FCTSALES
  );
[0m19:29:28.463489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:29:28.472984 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.474035 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m19:29:28.475499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:29:28.494700 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m19:29:28.495723 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.496604 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m19:29:28.498755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:29:28.508716 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m19:29:28.514839 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:29:28.515865 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m19:29:28.517084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:29:28.519573 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 19:29:28.385792 => 19:29:28.519131
[0m19:29:28.520518 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m19:29:28.521946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8569efe8-4f8d-4fbe-b838-8af1e2501537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b5810>]}
[0m19:29:28.523223 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_contoso__sales ................. [[32mCREATE VIEW[0m in 0.16s]
[0m19:29:28.524568 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m19:29:28.527418 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:28.528335 [debug] [MainThread]: On master: BEGIN
[0m19:29:28.529154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:28.537651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:29:28.539614 [debug] [MainThread]: On master: COMMIT
[0m19:29:28.541682 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:28.543304 [debug] [MainThread]: On master: COMMIT
[0m19:29:28.544757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:29:28.545716 [debug] [MainThread]: On master: Close
[0m19:29:28.547046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:28.547962 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m19:29:28.548823 [info ] [MainThread]: 
[0m19:29:28.549817 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:29:28.551459 [debug] [MainThread]: Command end result
[0m19:29:28.571309 [info ] [MainThread]: 
[0m19:29:28.572461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:28.573362 [info ] [MainThread]: 
[0m19:29:28.574429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:29:28.577478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5481966, "process_user_time": 3.987844, "process_kernel_time": 0.302496, "process_mem_max_rss": "118312960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:29:28.579444 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:28.578938 after 1.55 seconds
[0m19:29:28.580553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b6140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b6740>]}
[0m19:29:28.581476 [debug] [MainThread]: Flushing usage events
[0m19:35:12.925919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff22b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ba920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ba5c0>]}


============================== 19:35:12.931253 | c2244dc3-7bf2-4e1a-89e5-8a061b17f68e ==============================
[0m19:35:12.931253 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:35:12.932436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering/dbt/dbt_example/postgres_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_contoso__sales.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:13.208240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ba830>]}
[0m19:35:13.331185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11242e470>]}
[0m19:35:13.332663 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:35:13.385220 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:35:13.493010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:13.494315 [debug] [MainThread]: Partial parsing: updated file: postgres_dbt://models/staging/stg_contoso__sales.sql
[0m19:35:13.959317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:35:13.968362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113567eb0>]}
[0m19:35:13.994516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fff7f0>]}
[0m19:35:13.995612 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m19:35:13.996614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ffce20>]}
[0m19:35:13.999091 [info ] [MainThread]: 
[0m19:35:14.000934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:14.003643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:35:14.021421 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:35:14.023358 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:35:14.025500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:14.063752 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:35:14.066770 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:35:14.070749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:35:14.080297 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:35:14.081244 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:35:14.082489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:14.089281 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:14.090216 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:35:14.091066 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:35:14.097163 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:35:14.099310 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:35:14.100297 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:35:14.111763 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:14.112694 [debug] [MainThread]: On master: BEGIN
[0m19:35:14.113509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:14.119754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:14.120677 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:14.121570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:14.162580 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m19:35:14.165663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135d7ee0>]}
[0m19:35:14.166667 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:14.167679 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:14.168513 [debug] [MainThread]: On master: BEGIN
[0m19:35:14.169549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:14.170383 [debug] [MainThread]: On master: COMMIT
[0m19:35:14.171206 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:14.172018 [debug] [MainThread]: On master: COMMIT
[0m19:35:14.172974 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:14.173818 [debug] [MainThread]: On master: Close
[0m19:35:14.175188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:14.176304 [info ] [MainThread]: 
[0m19:35:14.178850 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__sales
[0m19:35:14.179989 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_schema.stg_contoso__sales ............... [RUN]
[0m19:35:14.181548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.stg_contoso__sales)
[0m19:35:14.182817 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__sales
[0m19:35:14.199577 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__sales"
[0m19:35:14.201229 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (compile): 19:35:14.183531 => 19:35:14.200668
[0m19:35:14.202285 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__sales
[0m19:35:14.295149 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__sales"
[0m19:35:14.297263 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:35:14.298482 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: BEGIN
[0m19:35:14.299670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:14.307730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:14.308883 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:35:14.309823 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */

      
  
    

  create  table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp"
  
  
    as
  
  (
    
SELECT 
SALESKEY, 
CHANNELKEY, 
STOREKEY, 
PRODUCTKEY, 
UNITCOST, 
UNITPRICE, 
SALESQUANTITY, 
DISCOUNTQUANTITY, 
DISCOUNTAMOUNT, 
TOTALCOST, 
SALESAMOUNT, 
(SALESAMOUNT - TOTALCOST) AS PROFIT,
DATEKEY
FROM PUBLIC.FCTSALES


  );
  
  
[0m19:35:35.138010 [debug] [Thread-1 (]: SQL status: SELECT 3406089 in 21.0 seconds
[0m19:35:35.147072 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:35:35.148112 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales" rename to "stg_contoso__sales__dbt_backup"
[0m19:35:35.149800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:35.155314 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:35:35.156287 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
alter table "contosodb"."dbt_schema"."stg_contoso__sales__dbt_tmp" rename to "stg_contoso__sales"
[0m19:35:35.185774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:35.212153 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m19:35:35.213240 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:35:35.214162 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: COMMIT
[0m19:35:35.218828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:35.229719 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup"
[0m19:35:35.235763 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__sales"
[0m19:35:35.236762 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__sales"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__sales__dbt_backup" cascade
[0m19:35:35.239770 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:35.243934 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__sales (execute): 19:35:14.203058 => 19:35:35.243301
[0m19:35:35.245296 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__sales: Close
[0m19:35:35.247471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2244dc3-7bf2-4e1a-89e5-8a061b17f68e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113605c60>]}
[0m19:35:35.249460 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_schema.stg_contoso__sales .......... [[32mSELECT 3406089[0m in 21.07s]
[0m19:35:35.251024 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__sales
[0m19:35:35.253343 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:35.254360 [debug] [MainThread]: On master: BEGIN
[0m19:35:35.255332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:35.287264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:35.288555 [debug] [MainThread]: On master: COMMIT
[0m19:35:35.289463 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:35.290306 [debug] [MainThread]: On master: COMMIT
[0m19:35:35.291737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:35.293064 [debug] [MainThread]: On master: Close
[0m19:35:35.294948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:35.295914 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__sales' was properly closed.
[0m19:35:35.297102 [info ] [MainThread]: 
[0m19:35:35.298744 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 21.30 seconds (21.30s).
[0m19:35:35.301077 [debug] [MainThread]: Command end result
[0m19:35:35.326317 [info ] [MainThread]: 
[0m19:35:35.327448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:35.328379 [info ] [MainThread]: 
[0m19:35:35.329503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:35:35.331923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.482044, "process_user_time": 4.062061, "process_kernel_time": 0.300523, "process_mem_max_rss": "119087104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:35:35.333307 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:35.332947 after 22.48 seconds
[0m19:35:35.334739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff22b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113592e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136070a0>]}
[0m19:35:35.335766 [debug] [MainThread]: Flushing usage events
[0m19:46:16.580018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5566b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aee890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aee530>]}


============================== 19:46:16.601832 | 18ed50a4-3d46-4371-89f9-b33c3ceb6530 ==============================
[0m19:46:16.601832 [info ] [MainThread]: Running with dbt=1.7.6
[0m19:46:16.604145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariocukovic/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariocukovic/Desktop/Podaci/Data Engineering-Portfolio/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_contoso__channels.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:16.861983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aee7a0>]}
[0m19:46:16.992155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a63400>]}
[0m19:46:16.993629 [info ] [MainThread]: Registered adapter: postgres=1.7.6
[0m19:46:17.040149 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m19:46:17.138760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:17.139714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:17.141375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dbt.example
[0m19:46:17.150872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118457b0>]}
[0m19:46:17.232548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e2a40>]}
[0m19:46:17.233753 [info ] [MainThread]: Found 10 models, 7 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 777 macros, 0 groups, 0 semantic models
[0m19:46:17.235083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aedb70>]}
[0m19:46:17.238512 [info ] [MainThread]: 
[0m19:46:17.240327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:17.243773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contosodb'
[0m19:46:17.263501 [debug] [ThreadPool]: Using postgres connection "list_contosodb"
[0m19:46:17.264749 [debug] [ThreadPool]: On list_contosodb: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb"} */

    select distinct nspname from pg_namespace
  
[0m19:46:17.265840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:17.301373 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:46:17.303555 [debug] [ThreadPool]: On list_contosodb: Close
[0m19:46:17.307362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contosodb, now list_contosodb_dbt_schema)
[0m19:46:17.316583 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:46:17.317523 [debug] [ThreadPool]: On list_contosodb_dbt_schema: BEGIN
[0m19:46:17.318532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:17.324818 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:17.325737 [debug] [ThreadPool]: Using postgres connection "list_contosodb_dbt_schema"
[0m19:46:17.326593 [debug] [ThreadPool]: On list_contosodb_dbt_schema: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "list_contosodb_dbt_schema"} */
select
      'contosodb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_schema'
    union all
    select
      'contosodb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_schema'
  
[0m19:46:17.332594 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:46:17.334752 [debug] [ThreadPool]: On list_contosodb_dbt_schema: ROLLBACK
[0m19:46:17.335784 [debug] [ThreadPool]: On list_contosodb_dbt_schema: Close
[0m19:46:17.347904 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:17.348835 [debug] [MainThread]: On master: BEGIN
[0m19:46:17.349638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:17.356018 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:17.356968 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:17.357872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:46:17.398984 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m19:46:17.402055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11187b820>]}
[0m19:46:17.403089 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:17.404171 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:17.405031 [debug] [MainThread]: On master: BEGIN
[0m19:46:17.406066 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:17.406918 [debug] [MainThread]: On master: COMMIT
[0m19:46:17.407772 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:17.408626 [debug] [MainThread]: On master: COMMIT
[0m19:46:17.409604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:46:17.410452 [debug] [MainThread]: On master: Close
[0m19:46:17.411783 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:46:17.412889 [info ] [MainThread]: 
[0m19:46:17.415645 [debug] [Thread-1 (]: Began running node model.postgres_dbt.stg_contoso__channels
[0m19:46:17.416706 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_schema.stg_contoso__channels ................... [RUN]
[0m19:46:17.417997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contosodb_dbt_schema, now model.postgres_dbt.stg_contoso__channels)
[0m19:46:17.419368 [debug] [Thread-1 (]: Began compiling node model.postgres_dbt.stg_contoso__channels
[0m19:46:17.431100 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.432640 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (compile): 19:46:17.420192 => 19:46:17.432170
[0m19:46:17.433592 [debug] [Thread-1 (]: Began executing node model.postgres_dbt.stg_contoso__channels
[0m19:46:17.491205 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.492734 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.493666 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: BEGIN
[0m19:46:17.494537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:17.501287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:17.502283 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.503367 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */

  create view "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp"
    
    
  as (
    SELECT
CHANNELKEY,
CHANNELNAME
FROM PUBLIC.DIMCHANNEL
  );
[0m19:46:17.507183 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:46:17.516627 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.517640 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels" rename to "stg_contoso__channels__dbt_backup"
[0m19:46:17.519120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:17.525625 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.526599 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
alter table "contosodb"."dbt_schema"."stg_contoso__channels__dbt_tmp" rename to "stg_contoso__channels"
[0m19:46:17.527964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:46:17.549702 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m19:46:17.550774 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.551665 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: COMMIT
[0m19:46:17.554111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:46:17.564500 [debug] [Thread-1 (]: Applying DROP to: "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup"
[0m19:46:17.570828 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dbt.stg_contoso__channels"
[0m19:46:17.572001 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "postgres_dbt", "target_name": "dev", "node_id": "model.postgres_dbt.stg_contoso__channels"} */
drop view if exists "contosodb"."dbt_schema"."stg_contoso__channels__dbt_backup" cascade
[0m19:46:17.575438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:46:17.578505 [debug] [Thread-1 (]: Timing info for model.postgres_dbt.stg_contoso__channels (execute): 19:46:17.434372 => 19:46:17.577954
[0m19:46:17.579514 [debug] [Thread-1 (]: On model.postgres_dbt.stg_contoso__channels: Close
[0m19:46:17.580923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18ed50a4-3d46-4371-89f9-b33c3ceb6530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119de110>]}
[0m19:46:17.582210 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_schema.stg_contoso__channels .............. [[32mCREATE VIEW[0m in 0.16s]
[0m19:46:17.583581 [debug] [Thread-1 (]: Finished running node model.postgres_dbt.stg_contoso__channels
[0m19:46:17.585603 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:17.586488 [debug] [MainThread]: On master: BEGIN
[0m19:46:17.587304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:17.596937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:17.598558 [debug] [MainThread]: On master: COMMIT
[0m19:46:17.601184 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:17.602375 [debug] [MainThread]: On master: COMMIT
[0m19:46:17.603592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:46:17.604770 [debug] [MainThread]: On master: Close
[0m19:46:17.606832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:17.607776 [debug] [MainThread]: Connection 'model.postgres_dbt.stg_contoso__channels' was properly closed.
[0m19:46:17.608634 [info ] [MainThread]: 
[0m19:46:17.609631 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m19:46:17.610984 [debug] [MainThread]: Command end result
[0m19:46:17.631901 [info ] [MainThread]: 
[0m19:46:17.633394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:17.634297 [info ] [MainThread]: 
[0m19:46:17.635187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:46:17.638869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1313845, "process_user_time": 3.488527, "process_kernel_time": 0.260471, "process_mem_max_rss": "112222208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:17.642575 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:17.641750 after 1.14 seconds
[0m19:46:17.644808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5566b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119de2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ef8e0>]}
[0m19:46:17.646263 [debug] [MainThread]: Flushing usage events
